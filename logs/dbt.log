2021-03-31 06:00:46.281425 (MainThread): Running with dbt=0.19.0
2021-03-31 06:00:46.875952 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 06:00:46.877515 (MainThread): Tracking: tracking
2021-03-31 06:00:46.877990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150f278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150f198>]}
2021-03-31 06:00:46.905656 (MainThread): Partial parsing not enabled
2021-03-31 06:00:46.907366 (MainThread): Parsing macros/catalog.sql
2021-03-31 06:00:46.910494 (MainThread): Parsing macros/adapters.sql
2021-03-31 06:00:46.948951 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 06:00:46.951710 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 06:00:46.953697 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 06:00:46.959235 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 06:00:46.973433 (MainThread): Parsing macros/core.sql
2021-03-31 06:00:46.979664 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 06:00:46.991657 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 06:00:46.994380 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 06:00:47.018653 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 06:00:47.056577 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 06:00:47.079416 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 06:00:47.081664 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 06:00:47.088517 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 06:00:47.103868 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 06:00:47.111767 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 06:00:47.119284 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 06:00:47.124828 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 06:00:47.126004 (MainThread): Parsing macros/etc/query.sql
2021-03-31 06:00:47.127508 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 06:00:47.129657 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 06:00:47.140161 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 06:00:47.142651 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 06:00:47.145222 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 06:00:47.201113 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 06:00:47.203980 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 06:00:47.206125 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 06:00:47.208459 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 06:00:47.218843 (MainThread): Partial parsing not enabled
2021-03-31 06:00:47.267349 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:00:47.295379 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:00:47.563641 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d6934fb-4faf-4ae4-b51a-45296f5687a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d0518>]}
2021-03-31 06:00:47.604455 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-03-31 06:00:47.605286 (MainThread): 
2021-03-31 06:00:47.605603 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:00:47.608475 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 06:00:47.623943 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 06:00:47.624086 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 06:00:47.624177 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 06:00:59.331366 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 11.71 seconds
2021-03-31 06:00:59.335618 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 06:01:01.329836 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:01:01.338064 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:01:01.338190 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 06:01:01.338293 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 06:01:10.097385 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 8.76 seconds
2021-03-31 06:01:10.097910 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 06:01:12.544460 (MainThread): Using snowflake connection "master".
2021-03-31 06:01:12.544652 (MainThread): On master: BEGIN
2021-03-31 06:01:12.544779 (MainThread): Opening a new connection, currently in state init
2021-03-31 06:01:16.969534 (MainThread): SQL status: SUCCESS 1 in 4.42 seconds
2021-03-31 06:01:16.969731 (MainThread): On master: COMMIT
2021-03-31 06:01:16.969902 (MainThread): Using snowflake connection "master".
2021-03-31 06:01:16.969999 (MainThread): On master: COMMIT
2021-03-31 06:01:18.400296 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-03-31 06:01:18.400465 (MainThread): On master: Close
2021-03-31 06:01:23.715927 (MainThread): 14:01:23 | Concurrency: 10 threads (target='dev')
2021-03-31 06:01:23.716123 (MainThread): 14:01:23 | 
2021-03-31 06:01:23.718209 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:01:23.719533 (Thread-1): 14:01:23 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 06:01:23.719863 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:01:23.719995 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 06:01:23.743227 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:01:23.744092 (Thread-1): finished collecting timing info
2021-03-31 06:01:23.784225 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:01:23.785973 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:01:23.786112 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 06:01:23.786221 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 06:01:30.890308 (Thread-1): SQL status: SUCCESS 1 in 7.10 seconds
2021-03-31 06:01:30.890569 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:01:30.890722 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 06:01:34.128743 (Thread-1): SQL status: SUCCESS 1 in 3.24 seconds
2021-03-31 06:01:34.134055 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:01:34.134298 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:01:34.134408 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:01:35.600391 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-03-31 06:01:35.616204 (Thread-1): finished collecting timing info
2021-03-31 06:01:35.616494 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 06:01:38.453271 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6934fb-4faf-4ae4-b51a-45296f5687a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113764ac8>]}
2021-03-31 06:01:38.454810 (Thread-1): 14:01:38 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 14.73s]
2021-03-31 06:01:38.454996 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:01:38.455455 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:01:38.456789 (Thread-3): 14:01:38 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 06:01:38.457258 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:01:38.457430 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 06:01:38.466768 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:01:38.467296 (Thread-3): finished collecting timing info
2021-03-31 06:01:38.492567 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:01:38.493511 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:01:38.493629 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 06:01:38.493729 (Thread-3): Opening a new connection, currently in state init
2021-03-31 06:01:47.201826 (Thread-3): SQL status: SUCCESS 1 in 8.71 seconds
2021-03-31 06:01:47.202067 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:01:47.202210 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 06:01:48.327209 (Thread-3): SQL status: SUCCESS 1 in 1.12 seconds
2021-03-31 06:01:48.332540 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:01:48.332743 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:01:48.332856 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:01:48.771148 (Thread-3): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 06:01:48.776138 (Thread-3): finished collecting timing info
2021-03-31 06:01:48.776452 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 06:01:49.667581 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6934fb-4faf-4ae4-b51a-45296f5687a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b6b38>]}
2021-03-31 06:01:49.668997 (Thread-3): 14:01:49 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 11.21s]
2021-03-31 06:01:49.669165 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:01:49.670279 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:01:49.670501 (MainThread): Using snowflake connection "master".
2021-03-31 06:01:49.670605 (MainThread): On master: BEGIN
2021-03-31 06:01:49.670704 (MainThread): Opening a new connection, currently in state closed
2021-03-31 06:02:05.396165 (MainThread): SQL status: SUCCESS 1 in 15.73 seconds
2021-03-31 06:02:05.396387 (MainThread): On master: COMMIT
2021-03-31 06:02:05.396584 (MainThread): Using snowflake connection "master".
2021-03-31 06:02:05.396696 (MainThread): On master: COMMIT
2021-03-31 06:02:07.025599 (MainThread): SQL status: SUCCESS 1 in 1.63 seconds
2021-03-31 06:02:07.025914 (MainThread): On master: Close
2021-03-31 06:02:09.502454 (MainThread): 14:02:09 | 
2021-03-31 06:02:09.502683 (MainThread): 14:02:09 | Finished running 1 table model, 1 view model in 81.90s.
2021-03-31 06:02:09.502830 (MainThread): Connection 'master' was properly closed.
2021-03-31 06:02:09.502936 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 06:02:09.503036 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 06:02:09.546985 (MainThread): 
2021-03-31 06:02:09.547159 (MainThread): Completed successfully
2021-03-31 06:02:09.547285 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-03-31 06:02:09.547461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113858080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113858c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113858828>]}
2021-03-31 06:02:09.547665 (MainThread): Flushing usage events
2021-03-31 06:14:20.059594 (MainThread): Running with dbt=0.19.0
2021-03-31 06:14:20.546143 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 06:14:20.546910 (MainThread): Tracking: tracking
2021-03-31 06:14:20.547281 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11438b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11438b2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11438b208>]}
2021-03-31 06:14:20.568553 (MainThread): Partial parsing not enabled
2021-03-31 06:14:20.569523 (MainThread): Parsing macros/catalog.sql
2021-03-31 06:14:20.571801 (MainThread): Parsing macros/adapters.sql
2021-03-31 06:14:20.601491 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 06:14:20.603594 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 06:14:20.605115 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 06:14:20.609172 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 06:14:20.619718 (MainThread): Parsing macros/core.sql
2021-03-31 06:14:20.623715 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 06:14:20.632762 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 06:14:20.634704 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 06:14:20.653425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 06:14:20.686074 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 06:14:20.707162 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 06:14:20.709037 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 06:14:20.715386 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 06:14:20.729388 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 06:14:20.736689 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 06:14:20.743087 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 06:14:20.748146 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 06:14:20.749094 (MainThread): Parsing macros/etc/query.sql
2021-03-31 06:14:20.750166 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 06:14:20.751822 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 06:14:20.760866 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 06:14:20.762926 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 06:14:20.764683 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 06:14:20.806647 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 06:14:20.808581 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 06:14:20.810201 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 06:14:20.811992 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 06:14:20.820334 (MainThread): Partial parsing not enabled
2021-03-31 06:14:20.856270 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:14:20.878467 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:14:21.093495 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7e3dde3-8e01-4197-8cdf-b4dc2fa51b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a73550>]}
2021-03-31 06:14:21.128049 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-03-31 06:14:21.128721 (MainThread): 
2021-03-31 06:14:21.128967 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:14:21.131300 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 06:14:21.144930 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 06:14:21.145055 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 06:14:21.145133 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 06:14:25.408610 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 4.26 seconds
2021-03-31 06:14:25.412639 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 06:14:25.970081 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:14:25.978024 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:14:25.978157 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 06:14:25.978252 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 06:14:29.034732 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 3.06 seconds
2021-03-31 06:14:29.038005 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 06:14:29.783470 (MainThread): Using snowflake connection "master".
2021-03-31 06:14:29.783628 (MainThread): On master: BEGIN
2021-03-31 06:14:29.783733 (MainThread): Opening a new connection, currently in state init
2021-03-31 06:14:33.008078 (MainThread): SQL status: SUCCESS 1 in 3.22 seconds
2021-03-31 06:14:33.008270 (MainThread): On master: COMMIT
2021-03-31 06:14:33.008437 (MainThread): Using snowflake connection "master".
2021-03-31 06:14:33.008552 (MainThread): On master: COMMIT
2021-03-31 06:14:33.497116 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-03-31 06:14:33.497307 (MainThread): On master: Close
2021-03-31 06:14:34.570743 (MainThread): 14:14:34 | Concurrency: 10 threads (target='dev')
2021-03-31 06:14:34.570938 (MainThread): 14:14:34 | 
2021-03-31 06:14:34.572435 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:14:34.573827 (Thread-1): 14:14:34 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 06:14:34.574164 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:14:34.574299 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 06:14:34.598585 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:14:34.599129 (Thread-1): finished collecting timing info
2021-03-31 06:14:34.638163 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:14:34.639238 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:14:34.639345 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 06:14:34.639438 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 06:14:38.526392 (Thread-1): SQL status: SUCCESS 1 in 3.89 seconds
2021-03-31 06:14:38.526648 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:14:38.526794 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 06:14:42.305948 (Thread-1): SQL status: SUCCESS 1 in 3.78 seconds
2021-03-31 06:14:42.310348 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:14:42.310561 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:14:42.310663 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:14:42.585784 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-03-31 06:14:42.601843 (Thread-1): finished collecting timing info
2021-03-31 06:14:42.602174 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 06:14:44.476490 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e3dde3-8e01-4197-8cdf-b4dc2fa51b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114de0fd0>]}
2021-03-31 06:14:44.478098 (Thread-1): 14:14:44 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 9.90s]
2021-03-31 06:14:44.478281 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:14:44.478705 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:14:44.480203 (Thread-3): 14:14:44 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 06:14:44.480579 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:14:44.480713 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 06:14:44.489980 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:14:44.490474 (Thread-3): finished collecting timing info
2021-03-31 06:14:44.516017 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:14:44.516985 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:14:44.517114 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 06:14:44.517215 (Thread-3): Opening a new connection, currently in state init
2021-03-31 06:14:48.735695 (Thread-3): SQL status: SUCCESS 1 in 4.22 seconds
2021-03-31 06:14:48.735911 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:14:48.736018 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 06:14:49.273561 (Thread-3): SQL status: SUCCESS 1 in 0.54 seconds
2021-03-31 06:14:49.278232 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:14:49.278436 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:14:49.278541 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:14:49.597225 (Thread-3): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 06:14:49.602767 (Thread-3): finished collecting timing info
2021-03-31 06:14:49.603081 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 06:14:50.376235 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e3dde3-8e01-4197-8cdf-b4dc2fa51b22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167482b0>]}
2021-03-31 06:14:50.377525 (Thread-3): 14:14:50 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 5.90s]
2021-03-31 06:14:50.377723 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:14:50.478707 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:14:50.479214 (MainThread): Using snowflake connection "master".
2021-03-31 06:14:50.479377 (MainThread): On master: BEGIN
2021-03-31 06:14:50.479541 (MainThread): Opening a new connection, currently in state closed
2021-03-31 06:14:54.035604 (MainThread): SQL status: SUCCESS 1 in 3.56 seconds
2021-03-31 06:14:54.035809 (MainThread): On master: COMMIT
2021-03-31 06:14:54.035986 (MainThread): Using snowflake connection "master".
2021-03-31 06:14:54.036086 (MainThread): On master: COMMIT
2021-03-31 06:14:54.456682 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-03-31 06:14:54.456904 (MainThread): On master: Close
2021-03-31 06:14:55.665679 (MainThread): 14:14:55 | 
2021-03-31 06:14:55.665881 (MainThread): 14:14:55 | Finished running 1 table model, 1 view model in 34.54s.
2021-03-31 06:14:55.666012 (MainThread): Connection 'master' was properly closed.
2021-03-31 06:14:55.666106 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 06:14:55.666192 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 06:14:55.708988 (MainThread): 
2021-03-31 06:14:55.709151 (MainThread): Completed successfully
2021-03-31 06:14:55.709268 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-03-31 06:14:55.709430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11674a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11674a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11674ab70>]}
2021-03-31 06:14:55.709620 (MainThread): Flushing usage events
2021-03-31 06:51:52.519402 (MainThread): Running with dbt=0.19.0
2021-03-31 06:51:53.308160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 06:51:53.309391 (MainThread): Tracking: tracking
2021-03-31 06:51:53.309742 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae962b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae96278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae96198>]}
2021-03-31 06:51:53.339348 (MainThread): Partial parsing not enabled
2021-03-31 06:51:53.340764 (MainThread): Parsing macros/catalog.sql
2021-03-31 06:51:53.343731 (MainThread): Parsing macros/adapters.sql
2021-03-31 06:51:53.382925 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 06:51:53.386564 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 06:51:53.388678 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 06:51:53.393750 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 06:51:53.408442 (MainThread): Parsing macros/core.sql
2021-03-31 06:51:53.413771 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 06:51:53.425671 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 06:51:53.428043 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 06:51:53.452152 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 06:51:53.488480 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 06:51:53.511256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 06:51:53.513325 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 06:51:53.520589 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 06:51:53.536482 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 06:51:53.543840 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 06:51:53.551403 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 06:51:53.557059 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 06:51:53.558196 (MainThread): Parsing macros/etc/query.sql
2021-03-31 06:51:53.559419 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 06:51:53.561263 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 06:51:53.571234 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 06:51:53.573451 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 06:51:53.575563 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 06:51:53.621378 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 06:51:53.623554 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 06:51:53.625296 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 06:51:53.627260 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 06:51:53.637214 (MainThread): Partial parsing not enabled
2021-03-31 06:51:53.677962 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:51:53.701746 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:51:53.714371 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:51:54.005256 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28131c29-306c-4348-bb62-565b0382c840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed1240>]}
2021-03-31 06:51:54.042153 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 06:51:54.042868 (MainThread): 
2021-03-31 06:51:54.043151 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:51:54.046613 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 06:51:54.060127 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 06:51:54.060250 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 06:51:54.060328 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 06:51:57.751089 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 3.69 seconds
2021-03-31 06:51:57.755358 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 06:51:58.385759 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:51:58.393840 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:51:58.393965 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 06:51:58.394062 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 06:52:03.891017 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 5.50 seconds
2021-03-31 06:52:03.894034 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 06:52:04.322157 (MainThread): Using snowflake connection "master".
2021-03-31 06:52:04.322340 (MainThread): On master: BEGIN
2021-03-31 06:52:04.322461 (MainThread): Opening a new connection, currently in state init
2021-03-31 06:52:05.778924 (MainThread): SQL status: SUCCESS 1 in 1.46 seconds
2021-03-31 06:52:05.779148 (MainThread): On master: COMMIT
2021-03-31 06:52:05.779339 (MainThread): Using snowflake connection "master".
2021-03-31 06:52:05.779449 (MainThread): On master: COMMIT
2021-03-31 06:52:06.071788 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-03-31 06:52:06.072015 (MainThread): On master: Close
2021-03-31 06:52:06.525911 (MainThread): 14:52:06 | Concurrency: 10 threads (target='dev')
2021-03-31 06:52:06.526140 (MainThread): 14:52:06 | 
2021-03-31 06:52:06.528249 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:52:06.529623 (Thread-1): 14:52:06 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 06:52:06.529970 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:52:06.530135 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:52:06.530302 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 06:52:06.531872 (Thread-2): 14:52:06 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 06:52:06.537415 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:52:06.543234 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:52:06.566836 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:52:06.568155 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 06:52:06.568798 (Thread-2): finished collecting timing info
2021-03-31 06:52:06.598804 (Thread-1): finished collecting timing info
2021-03-31 06:52:06.606408 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 06:52:06.625653 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:52:06.626427 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:52:06.626521 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 06:52:06.626600 (Thread-2): Opening a new connection, currently in state init
2021-03-31 06:52:06.628236 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:52:06.628324 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 06:52:06.628398 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 06:52:08.425461 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-03-31 06:52:08.425718 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:52:08.425865 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 06:52:08.475804 (Thread-2): SQL status: SUCCESS 1 in 1.85 seconds
2021-03-31 06:52:08.476043 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:52:08.476185 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
),

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 06:52:08.929771 (Thread-2): SQL status: SUCCESS 1 in 0.45 seconds
2021-03-31 06:52:08.935489 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 06:52:08.935691 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:52:08.935789 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 06:52:09.171833 (Thread-2): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 06:52:09.185256 (Thread-2): finished collecting timing info
2021-03-31 06:52:09.185587 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 06:52:09.607303 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28131c29-306c-4348-bb62-565b0382c840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b8c50>]}
2021-03-31 06:52:09.608594 (Thread-2): 14:52:09 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 3.07s]
2021-03-31 06:52:09.608750 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:52:09.654067 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-03-31 06:52:09.658643 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:52:09.658838 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:52:09.658942 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:52:09.910339 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 06:52:09.918528 (Thread-1): finished collecting timing info
2021-03-31 06:52:09.918832 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 06:52:10.385037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28131c29-306c-4348-bb62-565b0382c840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1e0320>]}
2021-03-31 06:52:10.386578 (Thread-1): 14:52:10 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.85s]
2021-03-31 06:52:10.386762 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:52:10.387222 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:52:10.388392 (Thread-4): 14:52:10 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 06:52:10.388712 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:52:10.388839 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 06:52:10.398219 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:52:10.398787 (Thread-4): finished collecting timing info
2021-03-31 06:52:10.404278 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:52:10.405211 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:52:10.405326 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 06:52:10.405426 (Thread-4): Opening a new connection, currently in state init
2021-03-31 06:52:12.069331 (Thread-4): SQL status: SUCCESS 1 in 1.66 seconds
2021-03-31 06:52:12.069665 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:52:12.069940 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 06:52:12.604116 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-03-31 06:52:12.608481 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:52:12.608667 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:52:12.608766 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:52:12.873909 (Thread-4): SQL status: SUCCESS 1 in 0.27 seconds
2021-03-31 06:52:12.878809 (Thread-4): finished collecting timing info
2021-03-31 06:52:12.879120 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 06:52:13.292265 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28131c29-306c-4348-bb62-565b0382c840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0a18d0>]}
2021-03-31 06:52:13.293774 (Thread-4): 14:52:13 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.90s]
2021-03-31 06:52:13.293925 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:52:13.373511 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:52:13.373819 (MainThread): Using snowflake connection "master".
2021-03-31 06:52:13.373940 (MainThread): On master: BEGIN
2021-03-31 06:52:13.374054 (MainThread): Opening a new connection, currently in state closed
2021-03-31 06:52:15.343161 (MainThread): SQL status: SUCCESS 1 in 1.97 seconds
2021-03-31 06:52:15.343361 (MainThread): On master: COMMIT
2021-03-31 06:52:15.343550 (MainThread): Using snowflake connection "master".
2021-03-31 06:52:15.343645 (MainThread): On master: COMMIT
2021-03-31 06:52:15.643593 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-03-31 06:52:15.643869 (MainThread): On master: Close
2021-03-31 06:52:16.068406 (MainThread): 14:52:16 | 
2021-03-31 06:52:16.068662 (MainThread): 14:52:16 | Finished running 2 view models, 1 table model in 22.03s.
2021-03-31 06:52:16.068813 (MainThread): Connection 'master' was properly closed.
2021-03-31 06:52:16.068917 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 06:52:16.069014 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 06:52:16.069107 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 06:52:16.116820 (MainThread): 
2021-03-31 06:52:16.117000 (MainThread): Completed successfully
2021-03-31 06:52:16.117143 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 06:52:16.117324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ed748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bbeb8>]}
2021-03-31 06:52:16.117535 (MainThread): Flushing usage events
2021-03-31 06:57:39.494274 (MainThread): Running with dbt=0.19.0
2021-03-31 06:57:40.154165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 06:57:40.155266 (MainThread): Tracking: tracking
2021-03-31 06:57:40.155560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3482e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3482b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3481d0>]}
2021-03-31 06:57:40.183352 (MainThread): Partial parsing not enabled
2021-03-31 06:57:40.184664 (MainThread): Parsing macros/catalog.sql
2021-03-31 06:57:40.187581 (MainThread): Parsing macros/adapters.sql
2021-03-31 06:57:40.220419 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 06:57:40.222686 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 06:57:40.224384 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 06:57:40.228784 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 06:57:40.240027 (MainThread): Parsing macros/core.sql
2021-03-31 06:57:40.244627 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 06:57:40.253983 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 06:57:40.255954 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 06:57:40.275160 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 06:57:40.309466 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 06:57:40.332210 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 06:57:40.334387 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 06:57:40.340973 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 06:57:40.355910 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 06:57:40.363657 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 06:57:40.370993 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 06:57:40.377215 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 06:57:40.378392 (MainThread): Parsing macros/etc/query.sql
2021-03-31 06:57:40.379647 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 06:57:40.381454 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 06:57:40.390795 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 06:57:40.393072 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 06:57:40.395313 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 06:57:40.440816 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 06:57:40.443075 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 06:57:40.444789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 06:57:40.446659 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 06:57:40.454996 (MainThread): Partial parsing not enabled
2021-03-31 06:57:40.493435 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:57:40.515670 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:57:40.527474 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:57:40.785324 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e1446a5-71f2-4c5e-801b-1437fc5520c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f35dba8>]}
2021-03-31 06:57:40.823337 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 06:57:40.824017 (MainThread): 
2021-03-31 06:57:40.824277 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:57:40.827774 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 06:57:40.840801 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 06:57:40.840927 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 06:57:40.841006 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 06:57:43.100500 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.26 seconds
2021-03-31 06:57:43.104650 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 06:57:43.531388 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:57:43.539595 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 06:57:43.539722 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 06:57:43.539822 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 06:57:45.168720 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.63 seconds
2021-03-31 06:57:45.173194 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 06:57:45.592409 (MainThread): Using snowflake connection "master".
2021-03-31 06:57:45.592566 (MainThread): On master: BEGIN
2021-03-31 06:57:45.592666 (MainThread): Opening a new connection, currently in state init
2021-03-31 06:57:47.078952 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 06:57:47.079323 (MainThread): On master: COMMIT
2021-03-31 06:57:47.079583 (MainThread): Using snowflake connection "master".
2021-03-31 06:57:47.079750 (MainThread): On master: COMMIT
2021-03-31 06:57:47.393557 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-03-31 06:57:47.393837 (MainThread): On master: Close
2021-03-31 06:57:47.821061 (MainThread): 14:57:47 | Concurrency: 5 threads (target='dev')
2021-03-31 06:57:47.821289 (MainThread): 14:57:47 | 
2021-03-31 06:57:47.822686 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:57:47.824175 (Thread-1): 14:57:47 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 06:57:47.824366 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:57:47.825554 (Thread-2): 14:57:47 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 06:57:47.825889 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:57:47.826027 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 06:57:47.826811 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:57:47.826949 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:57:47.864064 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:57:47.864260 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 06:57:47.864771 (Thread-1): finished collecting timing info
2021-03-31 06:57:47.871164 (Thread-2): finished collecting timing info
2021-03-31 06:57:47.912242 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 06:57:47.916236 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 06:57:47.917027 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:57:47.917113 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 06:57:47.917190 (Thread-2): Opening a new connection, currently in state init
2021-03-31 06:57:47.918296 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:57:47.918386 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 06:57:47.918461 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 06:57:49.485614 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-03-31 06:57:49.485875 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:57:49.486024 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 06:57:49.659490 (Thread-2): SQL status: SUCCESS 1 in 1.74 seconds
2021-03-31 06:57:49.659740 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:57:49.659888 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
),

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 06:57:50.101292 (Thread-2): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 06:57:50.105581 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 06:57:50.105763 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 06:57:50.105863 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 06:57:50.334132 (Thread-2): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 06:57:50.347562 (Thread-2): finished collecting timing info
2021-03-31 06:57:50.347851 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 06:57:50.618167 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-03-31 06:57:50.623625 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:57:50.623806 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 06:57:50.623908 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 06:57:50.797640 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1446a5-71f2-4c5e-801b-1437fc5520c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a96a0>]}
2021-03-31 06:57:50.799241 (Thread-2): 14:57:50 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 2.97s]
2021-03-31 06:57:50.799425 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 06:57:50.851165 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 06:57:50.858324 (Thread-1): finished collecting timing info
2021-03-31 06:57:50.858589 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 06:57:51.287321 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1446a5-71f2-4c5e-801b-1437fc5520c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181e208>]}
2021-03-31 06:57:51.288860 (Thread-1): 14:57:51 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.46s]
2021-03-31 06:57:51.289020 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 06:57:51.289356 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:57:51.290535 (Thread-4): 14:57:51 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 06:57:51.290866 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:57:51.291002 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 06:57:51.300451 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:57:51.301096 (Thread-4): finished collecting timing info
2021-03-31 06:57:51.306631 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 06:57:51.307569 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:57:51.307689 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 06:57:51.307789 (Thread-4): Opening a new connection, currently in state init
2021-03-31 06:57:53.217555 (Thread-4): SQL status: SUCCESS 1 in 1.91 seconds
2021-03-31 06:57:53.217790 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:57:53.217902 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 06:57:53.747804 (Thread-4): SQL status: SUCCESS 1 in 0.53 seconds
2021-03-31 06:57:53.753059 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:57:53.753256 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 06:57:53.753358 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 06:57:53.987466 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 06:57:53.992327 (Thread-4): finished collecting timing info
2021-03-31 06:57:53.992644 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 06:57:54.430710 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1446a5-71f2-4c5e-801b-1437fc5520c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e0978>]}
2021-03-31 06:57:54.432214 (Thread-4): 14:57:54 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.14s]
2021-03-31 06:57:54.432396 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 06:57:54.517653 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 06:57:54.518149 (MainThread): Using snowflake connection "master".
2021-03-31 06:57:54.518303 (MainThread): On master: BEGIN
2021-03-31 06:57:54.518448 (MainThread): Opening a new connection, currently in state closed
2021-03-31 06:57:56.141356 (MainThread): SQL status: SUCCESS 1 in 1.62 seconds
2021-03-31 06:57:56.141622 (MainThread): On master: COMMIT
2021-03-31 06:57:56.141862 (MainThread): Using snowflake connection "master".
2021-03-31 06:57:56.142031 (MainThread): On master: COMMIT
2021-03-31 06:57:56.715017 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-03-31 06:57:56.715316 (MainThread): On master: Close
2021-03-31 06:57:57.278765 (MainThread): 14:57:57 | 
2021-03-31 06:57:57.278966 (MainThread): 14:57:57 | Finished running 2 view models, 1 table model in 16.45s.
2021-03-31 06:57:57.279096 (MainThread): Connection 'master' was properly closed.
2021-03-31 06:57:57.279186 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 06:57:57.279270 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 06:57:57.279352 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 06:57:57.327103 (MainThread): 
2021-03-31 06:57:57.327266 (MainThread): Completed successfully
2021-03-31 06:57:57.327384 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 06:57:57.327566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6e358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111816630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118165f8>]}
2021-03-31 06:57:57.327767 (MainThread): Flushing usage events
2021-03-31 07:00:18.381542 (MainThread): Running with dbt=0.19.0
2021-03-31 07:00:19.167383 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 07:00:19.169367 (MainThread): Tracking: tracking
2021-03-31 07:00:19.169819 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df12f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df30160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df30048>]}
2021-03-31 07:00:19.199988 (MainThread): Partial parsing not enabled
2021-03-31 07:00:19.201914 (MainThread): Parsing macros/catalog.sql
2021-03-31 07:00:19.206291 (MainThread): Parsing macros/adapters.sql
2021-03-31 07:00:19.246449 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 07:00:19.249618 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 07:00:19.251788 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 07:00:19.257139 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 07:00:19.271256 (MainThread): Parsing macros/core.sql
2021-03-31 07:00:19.276779 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 07:00:19.289067 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 07:00:19.291545 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 07:00:19.315736 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 07:00:19.358177 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 07:00:19.386475 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 07:00:19.389103 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 07:00:19.397255 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 07:00:19.416309 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 07:00:19.425460 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 07:00:19.434110 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 07:00:19.440706 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 07:00:19.442007 (MainThread): Parsing macros/etc/query.sql
2021-03-31 07:00:19.443459 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 07:00:19.445716 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 07:00:19.457327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 07:00:19.459976 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 07:00:19.462497 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 07:00:19.510898 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 07:00:19.513417 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 07:00:19.515516 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 07:00:19.517647 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 07:00:19.527664 (MainThread): Partial parsing not enabled
2021-03-31 07:00:19.579112 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:00:19.607786 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:00:19.623456 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:00:19.933517 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e074cc1b-9f68-40e2-a7db-93b718bf2ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df5cc88>]}
2021-03-31 07:00:19.981740 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 07:00:19.982676 (MainThread): 
2021-03-31 07:00:19.983111 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 07:00:19.987444 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 07:00:20.004597 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 07:00:20.004752 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 07:00:20.004854 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 07:00:22.291136 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.29 seconds
2021-03-31 07:00:22.295819 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 07:00:22.730066 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 07:00:22.738060 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 07:00:22.738180 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 07:00:22.738284 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 07:00:24.436941 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.70 seconds
2021-03-31 07:00:24.441524 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 07:00:24.870254 (MainThread): Using snowflake connection "master".
2021-03-31 07:00:24.870445 (MainThread): On master: BEGIN
2021-03-31 07:00:24.870572 (MainThread): Opening a new connection, currently in state init
2021-03-31 07:00:26.389689 (MainThread): SQL status: SUCCESS 1 in 1.52 seconds
2021-03-31 07:00:26.389957 (MainThread): On master: COMMIT
2021-03-31 07:00:26.390203 (MainThread): Using snowflake connection "master".
2021-03-31 07:00:26.390349 (MainThread): On master: COMMIT
2021-03-31 07:00:26.759566 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-03-31 07:00:26.759844 (MainThread): On master: Close
2021-03-31 07:00:27.181069 (MainThread): 15:00:27 | Concurrency: 5 threads (target='dev')
2021-03-31 07:00:27.181330 (MainThread): 15:00:27 | 
2021-03-31 07:00:27.182782 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 07:00:27.182972 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:00:27.184356 (Thread-1): 15:00:27 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 07:00:27.185507 (Thread-2): 15:00:27 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 07:00:27.185873 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:00:27.186275 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:00:27.186400 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 07:00:27.186521 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:00:27.222693 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 07:00:27.223449 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 07:00:27.223821 (Thread-1): finished collecting timing info
2021-03-31 07:00:27.230377 (Thread-2): finished collecting timing info
2021-03-31 07:00:27.275861 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 07:00:27.277743 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 07:00:27.278621 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:00:27.278704 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 07:00:27.278780 (Thread-2): Opening a new connection, currently in state init
2021-03-31 07:00:27.280650 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:00:27.280897 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 07:00:27.280993 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 07:00:28.899753 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-03-31 07:00:28.900009 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:00:28.900154 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 07:00:28.907598 (Thread-2): SQL status: SUCCESS 1 in 1.63 seconds
2021-03-31 07:00:28.907802 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:00:28.907918 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
),

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 07:00:29.404496 (Thread-2): SQL status: SUCCESS 1 in 0.50 seconds
2021-03-31 07:00:29.409002 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 07:00:29.409194 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:00:29.409298 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 07:00:29.640203 (Thread-2): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 07:00:29.653701 (Thread-2): finished collecting timing info
2021-03-31 07:00:29.653992 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 07:00:29.940354 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-03-31 07:00:29.945198 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 07:00:29.945378 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:00:29.945477 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 07:00:30.077695 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e074cc1b-9f68-40e2-a7db-93b718bf2ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110255a90>]}
2021-03-31 07:00:30.079253 (Thread-2): 15:00:30 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 2.89s]
2021-03-31 07:00:30.079434 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:00:30.182715 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 07:00:30.189353 (Thread-1): finished collecting timing info
2021-03-31 07:00:30.189628 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 07:00:30.733059 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e074cc1b-9f68-40e2-a7db-93b718bf2ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110176da0>]}
2021-03-31 07:00:30.734489 (Thread-1): 15:00:30 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.55s]
2021-03-31 07:00:30.734656 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 07:00:30.735011 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 07:00:30.736159 (Thread-4): 15:00:30 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 07:00:30.736485 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:00:30.736609 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 07:00:30.745886 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 07:00:30.746351 (Thread-4): finished collecting timing info
2021-03-31 07:00:30.751645 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 07:00:30.752547 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:00:30.752658 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 07:00:30.752755 (Thread-4): Opening a new connection, currently in state init
2021-03-31 07:00:32.212412 (Thread-4): SQL status: SUCCESS 1 in 1.46 seconds
2021-03-31 07:00:32.212722 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:00:32.212900 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 07:00:32.926936 (Thread-4): SQL status: SUCCESS 1 in 0.71 seconds
2021-03-31 07:00:32.932288 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 07:00:32.932499 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:00:32.932604 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 07:00:33.161115 (Thread-4): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 07:00:33.165391 (Thread-4): finished collecting timing info
2021-03-31 07:00:33.165684 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 07:00:33.628735 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e074cc1b-9f68-40e2-a7db-93b718bf2ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015e160>]}
2021-03-31 07:00:33.630272 (Thread-4): 15:00:33 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 2.89s]
2021-03-31 07:00:33.630461 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 07:00:33.649676 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 07:00:33.650052 (MainThread): Using snowflake connection "master".
2021-03-31 07:00:33.650205 (MainThread): On master: BEGIN
2021-03-31 07:00:33.650349 (MainThread): Opening a new connection, currently in state closed
2021-03-31 07:00:35.304467 (MainThread): SQL status: SUCCESS 1 in 1.65 seconds
2021-03-31 07:00:35.304690 (MainThread): On master: COMMIT
2021-03-31 07:00:35.304885 (MainThread): Using snowflake connection "master".
2021-03-31 07:00:35.304997 (MainThread): On master: COMMIT
2021-03-31 07:00:35.659885 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 07:00:35.660127 (MainThread): On master: Close
2021-03-31 07:00:36.123092 (MainThread): 15:00:36 | 
2021-03-31 07:00:36.123319 (MainThread): 15:00:36 | Finished running 2 view models, 1 table model in 16.14s.
2021-03-31 07:00:36.123463 (MainThread): Connection 'master' was properly closed.
2021-03-31 07:00:36.123570 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 07:00:36.123676 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 07:00:36.123850 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 07:00:36.170505 (MainThread): 
2021-03-31 07:00:36.170676 (MainThread): Completed successfully
2021-03-31 07:00:36.170795 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 07:00:36.170962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e668160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca535c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026b908>]}
2021-03-31 07:00:36.171157 (MainThread): Flushing usage events
2021-03-31 07:01:37.298526 (MainThread): Running with dbt=0.19.0
2021-03-31 07:01:37.928371 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 07:01:37.930240 (MainThread): Tracking: tracking
2021-03-31 07:01:37.931385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad5d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd8240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd82e8>]}
2021-03-31 07:01:37.958504 (MainThread): Partial parsing not enabled
2021-03-31 07:01:37.959703 (MainThread): Parsing macros/catalog.sql
2021-03-31 07:01:37.962195 (MainThread): Parsing macros/adapters.sql
2021-03-31 07:01:37.995978 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 07:01:37.998857 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 07:01:38.000567 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 07:01:38.004861 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 07:01:38.016403 (MainThread): Parsing macros/core.sql
2021-03-31 07:01:38.020955 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 07:01:38.030095 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 07:01:38.032042 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 07:01:38.050613 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 07:01:38.084004 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 07:01:38.105465 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 07:01:38.107566 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 07:01:38.114106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 07:01:38.128299 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 07:01:38.135293 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 07:01:38.141934 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 07:01:38.147108 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 07:01:38.148191 (MainThread): Parsing macros/etc/query.sql
2021-03-31 07:01:38.149474 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 07:01:38.151254 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 07:01:38.160325 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 07:01:38.162484 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 07:01:38.164580 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 07:01:38.209408 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 07:01:38.212030 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 07:01:38.214351 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 07:01:38.216312 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 07:01:38.225058 (MainThread): Partial parsing not enabled
2021-03-31 07:01:38.261993 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:01:38.283448 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:01:38.295347 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:01:38.539762 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e18ccb-9e4e-46fc-8973-24850641a9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dacd2e8>]}
2021-03-31 07:01:38.575729 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 07:01:38.576388 (MainThread): 
2021-03-31 07:01:38.576731 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 07:01:38.580429 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 07:01:38.594492 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 07:01:38.594624 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 07:01:38.594705 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 07:01:40.593476 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.00 seconds
2021-03-31 07:01:40.598149 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 07:01:41.028895 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 07:01:41.036917 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 07:01:41.037049 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 07:01:41.037155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 07:01:42.691968 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.65 seconds
2021-03-31 07:01:42.696563 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 07:01:43.118727 (MainThread): Using snowflake connection "master".
2021-03-31 07:01:43.118886 (MainThread): On master: BEGIN
2021-03-31 07:01:43.118994 (MainThread): Opening a new connection, currently in state init
2021-03-31 07:01:44.985070 (MainThread): SQL status: SUCCESS 1 in 1.87 seconds
2021-03-31 07:01:44.985267 (MainThread): On master: COMMIT
2021-03-31 07:01:44.985445 (MainThread): Using snowflake connection "master".
2021-03-31 07:01:44.985548 (MainThread): On master: COMMIT
2021-03-31 07:01:45.365008 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-03-31 07:01:45.365217 (MainThread): On master: Close
2021-03-31 07:01:45.788097 (MainThread): 15:01:45 | Concurrency: 5 threads (target='dev')
2021-03-31 07:01:45.788340 (MainThread): 15:01:45 | 
2021-03-31 07:01:45.789612 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 07:01:45.789798 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:01:45.791059 (Thread-1): 15:01:45 | 1 of 3 START table model PUBLIC.my_first_dbt_model................... [RUN]
2021-03-31 07:01:45.792138 (Thread-2): 15:01:45 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 07:01:45.792491 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:01:45.792940 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:01:45.793073 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 07:01:45.793214 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:01:45.821187 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 07:01:45.823192 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 07:01:45.823724 (Thread-1): finished collecting timing info
2021-03-31 07:01:45.829050 (Thread-2): finished collecting timing info
2021-03-31 07:01:45.876783 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 07:01:45.881026 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 07:01:45.882164 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:01:45.882834 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:01:45.883031 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 07:01:45.883172 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 07:01:45.883309 (Thread-2): Opening a new connection, currently in state init
2021-03-31 07:01:45.883419 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 07:01:47.831553 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-03-31 07:01:47.831816 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:01:47.831970 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 07:01:47.849908 (Thread-2): SQL status: SUCCESS 1 in 1.97 seconds
2021-03-31 07:01:47.850163 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:01:47.850315 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
),

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 07:01:49.026147 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-03-31 07:01:49.030671 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 07:01:49.030846 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 07:01:49.030948 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 07:01:49.232160 (Thread-2): SQL status: SUCCESS 1 in 1.38 seconds
2021-03-31 07:01:49.237468 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 07:01:49.237651 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 07:01:49.237755 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 07:01:49.258357 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 07:01:49.274853 (Thread-1): finished collecting timing info
2021-03-31 07:01:49.275133 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 07:01:49.467113 (Thread-2): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 07:01:49.472256 (Thread-2): finished collecting timing info
2021-03-31 07:01:49.472545 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 07:01:49.698286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e18ccb-9e4e-46fc-8973-24850641a9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230b828>]}
2021-03-31 07:01:49.699800 (Thread-1): 15:01:49 | 1 of 3 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 3.91s]
2021-03-31 07:01:49.699990 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 07:01:49.700379 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 07:01:49.701572 (Thread-4): 15:01:49 | 3 of 3 START view model PUBLIC.my_second_dbt_model................... [RUN]
2021-03-31 07:01:49.701879 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:01:49.702007 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 07:01:49.710648 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 07:01:49.711111 (Thread-4): finished collecting timing info
2021-03-31 07:01:49.715877 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 07:01:49.716672 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:01:49.716782 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 07:01:49.716881 (Thread-4): Opening a new connection, currently in state init
2021-03-31 07:01:49.917716 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e18ccb-9e4e-46fc-8973-24850641a9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112313e80>]}
2021-03-31 07:01:49.919060 (Thread-2): 15:01:49 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 4.12s]
2021-03-31 07:01:49.919286 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 07:01:51.351952 (Thread-4): SQL status: SUCCESS 1 in 1.64 seconds
2021-03-31 07:01:51.352168 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:01:51.352293 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2021-03-31 07:01:51.932168 (Thread-4): SQL status: SUCCESS 1 in 0.58 seconds
2021-03-31 07:01:51.936240 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 07:01:51.936523 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 07:01:51.936659 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 07:01:52.363100 (Thread-4): SQL status: SUCCESS 1 in 0.43 seconds
2021-03-31 07:01:52.367320 (Thread-4): finished collecting timing info
2021-03-31 07:01:52.367674 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 07:01:52.810649 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e18ccb-9e4e-46fc-8973-24850641a9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122fccc0>]}
2021-03-31 07:01:52.812386 (Thread-4): 15:01:52 | 3 of 3 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 3.11s]
2021-03-31 07:01:52.812729 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 07:01:52.878005 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 07:01:52.878528 (MainThread): Using snowflake connection "master".
2021-03-31 07:01:52.878692 (MainThread): On master: BEGIN
2021-03-31 07:01:52.878843 (MainThread): Opening a new connection, currently in state closed
2021-03-31 07:01:54.537973 (MainThread): SQL status: SUCCESS 1 in 1.66 seconds
2021-03-31 07:01:54.538165 (MainThread): On master: COMMIT
2021-03-31 07:01:54.538344 (MainThread): Using snowflake connection "master".
2021-03-31 07:01:54.538445 (MainThread): On master: COMMIT
2021-03-31 07:01:54.838520 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-03-31 07:01:54.838802 (MainThread): On master: Close
2021-03-31 07:01:55.269690 (MainThread): 15:01:55 | 
2021-03-31 07:01:55.269909 (MainThread): 15:01:55 | Finished running 1 table model, 2 view models in 16.69s.
2021-03-31 07:01:55.270054 (MainThread): Connection 'master' was properly closed.
2021-03-31 07:01:55.270162 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 07:01:55.270263 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 07:01:55.270360 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 07:01:55.315061 (MainThread): 
2021-03-31 07:01:55.315225 (MainThread): Completed successfully
2021-03-31 07:01:55.315342 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 07:01:55.315506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11239ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11239f400>]}
2021-03-31 07:01:55.315699 (MainThread): Flushing usage events
2021-03-31 09:29:58.900348 (MainThread): Running with dbt=0.19.0
2021-03-31 09:29:59.601215 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 09:29:59.602898 (MainThread): Tracking: tracking
2021-03-31 09:29:59.603261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f9bf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fad2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fad358>]}
2021-03-31 09:29:59.627152 (MainThread): Partial parsing not enabled
2021-03-31 09:29:59.628786 (MainThread): Parsing macros/catalog.sql
2021-03-31 09:29:59.631241 (MainThread): Parsing macros/adapters.sql
2021-03-31 09:29:59.665449 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 09:29:59.668212 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 09:29:59.669922 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 09:29:59.675019 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 09:29:59.687374 (MainThread): Parsing macros/core.sql
2021-03-31 09:29:59.693807 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 09:29:59.705868 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 09:29:59.707920 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 09:29:59.727407 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 09:29:59.761707 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 09:29:59.783371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 09:29:59.785456 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 09:29:59.791941 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 09:29:59.806617 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 09:29:59.813781 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 09:29:59.820451 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 09:29:59.825815 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 09:29:59.826905 (MainThread): Parsing macros/etc/query.sql
2021-03-31 09:29:59.828126 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 09:29:59.829938 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 09:29:59.839166 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 09:29:59.841329 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 09:29:59.843368 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 09:29:59.886867 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 09:29:59.888931 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 09:29:59.890664 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 09:29:59.892554 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 09:29:59.901124 (MainThread): Partial parsing not enabled
2021-03-31 09:29:59.939076 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:29:59.960239 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:29:59.971120 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:30:00.218957 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad69a38-41d8-47e7-bdea-69b233672ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fc36d8>]}
2021-03-31 09:30:00.255402 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 09:30:00.256329 (MainThread): 
2021-03-31 09:30:00.256652 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 09:30:00.260321 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 09:30:00.267262 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 09:30:00.274597 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 09:30:00.276423 (ThreadPoolExecutor-0_1): Using snowflake connection "list_DEMO_DB".
2021-03-31 09:30:00.276551 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 09:30:00.276647 (ThreadPoolExecutor-0_1): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 09:30:00.276737 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 09:30:00.276819 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2021-03-31 09:30:09.122615 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 2 in 8.85 seconds
2021-03-31 09:30:09.126743 (ThreadPoolExecutor-0_1): On list_DEMO_DB: Close
2021-03-31 09:30:12.050514 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 11.77 seconds
2021-03-31 09:30:12.052587 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 09:30:13.436513 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "create_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:13.436939 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "create_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:13.437539 (ThreadPoolExecutor-0_1): Creating schema "DEMO_DB.PUBLIC_staging"
2021-03-31 09:30:13.442732 (ThreadPoolExecutor-0_1): Using snowflake connection "create_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:13.442853 (ThreadPoolExecutor-0_1): On create_DEMO_DB_PUBLIC_staging: BEGIN
2021-03-31 09:30:13.442932 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state closed
2021-03-31 09:30:16.481498 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 1 in 3.04 seconds
2021-03-31 09:30:16.481730 (ThreadPoolExecutor-0_1): Using snowflake connection "create_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:16.481857 (ThreadPoolExecutor-0_1): On create_DEMO_DB_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "create_DEMO_DB_PUBLIC_staging"} */
create schema if not exists DEMO_DB.PUBLIC_staging
2021-03-31 09:30:16.982145 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 1 in 0.50 seconds
2021-03-31 09:30:16.987631 (ThreadPoolExecutor-0_1): On create_DEMO_DB_PUBLIC_staging: COMMIT
2021-03-31 09:30:16.987847 (ThreadPoolExecutor-0_1): Using snowflake connection "create_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:16.987953 (ThreadPoolExecutor-0_1): On create_DEMO_DB_PUBLIC_staging: COMMIT
2021-03-31 09:30:17.233461 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 09:30:17.233671 (ThreadPoolExecutor-0_1): On create_DEMO_DB_PUBLIC_staging: Close
2021-03-31 09:30:17.777951 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 09:30:17.778370 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:17.786499 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 09:30:17.788516 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC_staging".
2021-03-31 09:30:17.788646 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 09:30:17.788753 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC_staging"} */

    show terse objects in DEMO_DB.PUBLIC_staging
2021-03-31 09:30:17.788855 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 09:30:17.788953 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state closed
2021-03-31 09:30:19.789483 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 0 in 2.00 seconds
2021-03-31 09:30:19.789955 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC_staging: Close
2021-03-31 09:30:20.879395 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 3.09 seconds
2021-03-31 09:30:20.884929 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 09:30:21.622331 (MainThread): Using snowflake connection "master".
2021-03-31 09:30:21.622534 (MainThread): On master: BEGIN
2021-03-31 09:30:21.622661 (MainThread): Opening a new connection, currently in state init
2021-03-31 09:30:24.066449 (MainThread): SQL status: SUCCESS 1 in 2.44 seconds
2021-03-31 09:30:24.066724 (MainThread): On master: COMMIT
2021-03-31 09:30:24.066970 (MainThread): Using snowflake connection "master".
2021-03-31 09:30:24.067113 (MainThread): On master: COMMIT
2021-03-31 09:30:24.413468 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 09:30:24.413676 (MainThread): On master: Close
2021-03-31 09:30:24.876288 (MainThread): 17:30:24 | Concurrency: 5 threads (target='dev')
2021-03-31 09:30:24.876525 (MainThread): 17:30:24 | 
2021-03-31 09:30:24.877948 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 09:30:24.878187 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:30:24.879621 (Thread-1): 17:30:24 | 1 of 3 START table model PUBLIC_staging.my_first_dbt_model........... [RUN]
2021-03-31 09:30:24.880746 (Thread-2): 17:30:24 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 09:30:24.881092 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:30:24.881456 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:30:24.881629 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 09:30:24.881768 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:30:24.919585 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 09:30:24.921454 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 09:30:24.923381 (Thread-1): finished collecting timing info
2021-03-31 09:30:24.923671 (Thread-2): finished collecting timing info
2021-03-31 09:30:24.980318 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 09:30:24.981462 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 09:30:24.982543 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:30:24.982635 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 09:30:24.982716 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 09:30:24.983840 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:30:24.983938 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 09:30:24.984047 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 09:30:27.269336 (Thread-2): SQL status: SUCCESS 1 in 2.29 seconds
2021-03-31 09:30:27.269549 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:30:27.269673 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 09:30:27.924359 (Thread-2): SQL status: SUCCESS 1 in 0.65 seconds
2021-03-31 09:30:27.928908 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 09:30:27.929120 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:30:27.929231 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 09:30:28.155617 (Thread-1): SQL status: SUCCESS 1 in 3.17 seconds
2021-03-31 09:30:28.155809 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:30:28.155935 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.PUBLIC_staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 09:30:29.056404 (Thread-2): SQL status: SUCCESS 1 in 1.13 seconds
2021-03-31 09:30:29.069515 (Thread-2): finished collecting timing info
2021-03-31 09:30:29.069846 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 09:30:29.761785 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad69a38-41d8-47e7-bdea-69b233672ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118339b00>]}
2021-03-31 09:30:29.763111 (Thread-2): 17:30:29 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 4.88s]
2021-03-31 09:30:29.763279 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:30:29.980171 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-03-31 09:30:29.985613 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 09:30:29.985900 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:30:29.986025 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 09:30:30.281979 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-03-31 09:30:30.290183 (Thread-1): finished collecting timing info
2021-03-31 09:30:30.290513 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 09:30:30.712002 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad69a38-41d8-47e7-bdea-69b233672ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182d6400>]}
2021-03-31 09:30:30.713514 (Thread-1): 17:30:30 | 1 of 3 OK created table model PUBLIC_staging.my_first_dbt_model...... [SUCCESS 1 in 5.83s]
2021-03-31 09:30:30.713701 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 09:30:30.714141 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 09:30:30.715273 (Thread-4): 17:30:30 | 3 of 3 START view model PUBLIC_staging.my_second_dbt_model........... [RUN]
2021-03-31 09:30:30.715649 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:30:30.715903 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 09:30:30.725929 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 09:30:30.727116 (Thread-4): finished collecting timing info
2021-03-31 09:30:30.732147 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 09:30:30.733887 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:30:30.734000 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 09:30:30.734105 (Thread-4): Opening a new connection, currently in state init
2021-03-31 09:30:32.573101 (Thread-4): SQL status: SUCCESS 1 in 1.84 seconds
2021-03-31 09:30:32.573289 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:30:32.573402 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.PUBLIC_staging.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.PUBLIC_staging.my_first_dbt_model
where id = 1
  );
2021-03-31 09:30:33.226771 (Thread-4): SQL status: SUCCESS 1 in 0.65 seconds
2021-03-31 09:30:33.231210 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 09:30:33.231414 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:30:33.231519 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 09:30:33.703297 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-03-31 09:30:33.707219 (Thread-4): finished collecting timing info
2021-03-31 09:30:33.707554 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 09:30:34.452290 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad69a38-41d8-47e7-bdea-69b233672ae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11833f198>]}
2021-03-31 09:30:34.453781 (Thread-4): 17:30:34 | 3 of 3 OK created view model PUBLIC_staging.my_second_dbt_model...... [SUCCESS 1 in 3.74s]
2021-03-31 09:30:34.453967 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 09:30:34.531554 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 09:30:34.531823 (MainThread): Using snowflake connection "master".
2021-03-31 09:30:34.531925 (MainThread): On master: BEGIN
2021-03-31 09:30:34.532015 (MainThread): Opening a new connection, currently in state closed
2021-03-31 09:30:36.688096 (MainThread): SQL status: SUCCESS 1 in 2.16 seconds
2021-03-31 09:30:36.688310 (MainThread): On master: COMMIT
2021-03-31 09:30:36.688485 (MainThread): Using snowflake connection "master".
2021-03-31 09:30:36.688585 (MainThread): On master: COMMIT
2021-03-31 09:30:37.290667 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2021-03-31 09:30:37.290887 (MainThread): On master: Close
2021-03-31 09:30:38.041789 (MainThread): 17:30:38 | 
2021-03-31 09:30:38.042016 (MainThread): 17:30:38 | Finished running 2 view models, 1 table model in 37.79s.
2021-03-31 09:30:38.042171 (MainThread): Connection 'master' was properly closed.
2021-03-31 09:30:38.042284 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 09:30:38.042389 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 09:30:38.042490 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 09:30:38.088523 (MainThread): 
2021-03-31 09:30:38.088722 (MainThread): Completed successfully
2021-03-31 09:30:38.088865 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 09:30:38.089102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a79ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183399b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183398d0>]}
2021-03-31 09:30:38.089386 (MainThread): Flushing usage events
2021-03-31 09:42:42.895033 (MainThread): Running with dbt=0.19.0
2021-03-31 09:42:43.598591 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 09:42:43.599929 (MainThread): Tracking: tracking
2021-03-31 09:42:43.600411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a913c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a91390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a912b0>]}
2021-03-31 09:42:43.624053 (MainThread): Partial parsing not enabled
2021-03-31 09:42:43.625167 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 09:42:43.627121 (MainThread): Parsing macros/catalog.sql
2021-03-31 09:42:43.629550 (MainThread): Parsing macros/adapters.sql
2021-03-31 09:42:43.661398 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 09:42:43.663556 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 09:42:43.665184 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 09:42:43.669272 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 09:42:43.680469 (MainThread): Parsing macros/core.sql
2021-03-31 09:42:43.685055 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 09:42:43.694556 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 09:42:43.696716 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 09:42:43.716429 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 09:42:43.750048 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 09:42:43.771891 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 09:42:43.774029 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 09:42:43.780546 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 09:42:43.795136 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 09:42:43.802298 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 09:42:43.808968 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 09:42:43.814301 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 09:42:43.815372 (MainThread): Parsing macros/etc/query.sql
2021-03-31 09:42:43.816600 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 09:42:43.818401 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 09:42:43.827652 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 09:42:43.829855 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 09:42:43.832113 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 09:42:43.876341 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 09:42:43.878460 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 09:42:43.880250 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 09:42:43.882211 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 09:42:43.890441 (MainThread): Partial parsing not enabled
2021-03-31 09:42:43.932787 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:42:43.962608 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:42:43.978223 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:42:44.286622 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb86e3a-0d6a-4bc9-9f79-82b78c37c949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11356d390>]}
2021-03-31 09:42:44.335536 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 09:42:44.336392 (MainThread): 
2021-03-31 09:42:44.336713 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 09:42:44.341684 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 09:42:44.348490 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 09:42:44.361820 (ThreadPoolExecutor-0_1): Using snowflake connection "list_DEMO_DB".
2021-03-31 09:42:44.366631 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 09:42:44.366739 (ThreadPoolExecutor-0_1): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 09:42:44.366864 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 09:42:44.366974 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2021-03-31 09:42:44.367070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 09:42:46.722134 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.36 seconds
2021-03-31 09:42:46.726614 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 09:42:46.943414 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 3 in 2.58 seconds
2021-03-31 09:42:46.944318 (ThreadPoolExecutor-0_1): On list_DEMO_DB: Close
2021-03-31 09:42:47.405848 (ThreadPoolExecutor-0_2): Acquiring new snowflake connection "create_DEMO_DB_staging".
2021-03-31 09:42:47.406314 (ThreadPoolExecutor-0_2): Acquiring new snowflake connection "create_DEMO_DB_staging".
2021-03-31 09:42:47.406544 (ThreadPoolExecutor-0_2): Creating schema "DEMO_DB.staging"
2021-03-31 09:42:47.413137 (ThreadPoolExecutor-0_2): Using snowflake connection "create_DEMO_DB_staging".
2021-03-31 09:42:47.413284 (ThreadPoolExecutor-0_2): On create_DEMO_DB_staging: BEGIN
2021-03-31 09:42:47.413389 (ThreadPoolExecutor-0_2): Opening a new connection, currently in state init
2021-03-31 09:42:49.108699 (ThreadPoolExecutor-0_2): SQL status: SUCCESS 1 in 1.70 seconds
2021-03-31 09:42:49.108934 (ThreadPoolExecutor-0_2): Using snowflake connection "create_DEMO_DB_staging".
2021-03-31 09:42:49.109060 (ThreadPoolExecutor-0_2): On create_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "create_DEMO_DB_staging"} */
create schema if not exists DEMO_DB.staging
2021-03-31 09:42:49.440964 (ThreadPoolExecutor-0_2): SQL status: SUCCESS 1 in 0.33 seconds
2021-03-31 09:42:49.446309 (ThreadPoolExecutor-0_2): On create_DEMO_DB_staging: COMMIT
2021-03-31 09:42:49.446534 (ThreadPoolExecutor-0_2): Using snowflake connection "create_DEMO_DB_staging".
2021-03-31 09:42:49.446639 (ThreadPoolExecutor-0_2): On create_DEMO_DB_staging: COMMIT
2021-03-31 09:42:49.737240 (ThreadPoolExecutor-0_2): SQL status: SUCCESS 1 in 0.29 seconds
2021-03-31 09:42:49.737577 (ThreadPoolExecutor-0_2): On create_DEMO_DB_staging: Close
2021-03-31 09:42:50.470997 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 09:42:50.476703 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 09:42:50.480074 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 09:42:50.482702 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 09:42:50.482892 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 09:42:50.483019 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 09:42:50.483166 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 09:42:50.483320 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state closed
2021-03-31 09:42:52.170627 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.69 seconds
2021-03-31 09:42:52.171261 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 09:42:52.400593 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 1.92 seconds
2021-03-31 09:42:52.404627 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 09:42:52.823980 (MainThread): Using snowflake connection "master".
2021-03-31 09:42:52.824244 (MainThread): On master: BEGIN
2021-03-31 09:42:52.824472 (MainThread): Opening a new connection, currently in state init
2021-03-31 09:42:54.478007 (MainThread): SQL status: SUCCESS 1 in 1.65 seconds
2021-03-31 09:42:54.478215 (MainThread): On master: COMMIT
2021-03-31 09:42:54.478388 (MainThread): Using snowflake connection "master".
2021-03-31 09:42:54.478486 (MainThread): On master: COMMIT
2021-03-31 09:42:54.768066 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-03-31 09:42:54.768298 (MainThread): On master: Close
2021-03-31 09:42:55.261873 (MainThread): 17:42:55 | Concurrency: 5 threads (target='dev')
2021-03-31 09:42:55.262225 (MainThread): 17:42:55 | 
2021-03-31 09:42:55.263826 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 09:42:55.264018 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:42:55.265438 (Thread-1): 17:42:55 | 1 of 3 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 09:42:55.266625 (Thread-2): 17:42:55 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 09:42:55.266987 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:42:55.267320 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:42:55.267479 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 09:42:55.267639 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:42:55.300435 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 09:42:55.303559 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 09:42:55.304104 (Thread-2): finished collecting timing info
2021-03-31 09:42:55.314976 (Thread-1): finished collecting timing info
2021-03-31 09:42:55.362254 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 09:42:55.373216 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 09:42:55.374325 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:42:55.375131 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:42:55.375321 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 09:42:55.375541 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 09:42:55.375718 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 09:42:55.375991 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 09:42:56.999623 (Thread-2): SQL status: SUCCESS 1 in 1.62 seconds
2021-03-31 09:42:56.999810 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:42:56.999913 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 09:42:57.019090 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-03-31 09:42:57.019337 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:42:57.019496 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 09:42:57.511418 (Thread-2): SQL status: SUCCESS 1 in 0.51 seconds
2021-03-31 09:42:57.516218 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 09:42:57.516446 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 09:42:57.516557 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 09:42:57.743128 (Thread-2): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 09:42:57.756641 (Thread-2): finished collecting timing info
2021-03-31 09:42:57.756999 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 09:42:58.179980 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb86e3a-0d6a-4bc9-9f79-82b78c37c949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116caa6a0>]}
2021-03-31 09:42:58.181320 (Thread-2): 17:42:58 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 2.91s]
2021-03-31 09:42:58.181493 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 09:42:58.946817 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2021-03-31 09:42:58.951364 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 09:42:58.951548 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 09:42:58.951648 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 09:42:59.183353 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 09:42:59.190011 (Thread-1): finished collecting timing info
2021-03-31 09:42:59.190312 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 09:42:59.613907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb86e3a-0d6a-4bc9-9f79-82b78c37c949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116dbe5c0>]}
2021-03-31 09:42:59.615189 (Thread-1): 17:42:59 | 1 of 3 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 4.35s]
2021-03-31 09:42:59.615410 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 09:42:59.615932 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 09:42:59.617106 (Thread-4): 17:42:59 | 3 of 3 START view model staging.my_second_dbt_model.................. [RUN]
2021-03-31 09:42:59.617820 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:42:59.618048 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 09:42:59.628397 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 09:42:59.628952 (Thread-4): finished collecting timing info
2021-03-31 09:42:59.634154 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 09:42:59.635213 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:42:59.635359 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 09:42:59.635471 (Thread-4): Opening a new connection, currently in state init
2021-03-31 09:43:01.121639 (Thread-4): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 09:43:01.121820 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:43:01.121942 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.staging.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
  );
2021-03-31 09:43:01.536811 (Thread-4): SQL status: SUCCESS 1 in 0.41 seconds
2021-03-31 09:43:01.542095 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 09:43:01.542316 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 09:43:01.542419 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 09:43:01.779800 (Thread-4): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 09:43:01.783648 (Thread-4): finished collecting timing info
2021-03-31 09:43:01.783942 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 09:43:02.215023 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb86e3a-0d6a-4bc9-9f79-82b78c37c949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116de4a20>]}
2021-03-31 09:43:02.216525 (Thread-4): 17:43:02 | 3 of 3 OK created view model staging.my_second_dbt_model............. [SUCCESS 1 in 2.60s]
2021-03-31 09:43:02.216704 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 09:43:02.224733 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 09:43:02.225054 (MainThread): Using snowflake connection "master".
2021-03-31 09:43:02.225178 (MainThread): On master: BEGIN
2021-03-31 09:43:02.225291 (MainThread): Opening a new connection, currently in state closed
2021-03-31 09:43:03.893570 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2021-03-31 09:43:03.893837 (MainThread): On master: COMMIT
2021-03-31 09:43:03.894082 (MainThread): Using snowflake connection "master".
2021-03-31 09:43:03.894223 (MainThread): On master: COMMIT
2021-03-31 09:43:04.207735 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-03-31 09:43:04.208009 (MainThread): On master: Close
2021-03-31 09:43:04.631312 (MainThread): 17:43:04 | 
2021-03-31 09:43:04.631547 (MainThread): 17:43:04 | Finished running 2 view models, 1 table model in 20.29s.
2021-03-31 09:43:04.631764 (MainThread): Connection 'master' was properly closed.
2021-03-31 09:43:04.631900 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 09:43:04.632008 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 09:43:04.632115 (MainThread): Connection 'create_DEMO_DB_staging' was properly closed.
2021-03-31 09:43:04.632244 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 09:43:04.677036 (MainThread): 
2021-03-31 09:43:04.677199 (MainThread): Completed successfully
2021-03-31 09:43:04.677315 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 09:43:04.677478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c95550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b1d6a0>]}
2021-03-31 09:43:04.677671 (MainThread): Flushing usage events
2021-03-31 10:20:12.038883 (MainThread): Running with dbt=0.19.0
2021-03-31 10:20:12.724870 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 10:20:12.726426 (MainThread): Tracking: tracking
2021-03-31 10:20:12.726746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152743c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115274390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115274240>]}
2021-03-31 10:20:12.749580 (MainThread): Partial parsing not enabled
2021-03-31 10:20:12.750770 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 10:20:12.752389 (MainThread): Parsing macros/catalog.sql
2021-03-31 10:20:12.754898 (MainThread): Parsing macros/adapters.sql
2021-03-31 10:20:12.787007 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 10:20:12.789403 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 10:20:12.791094 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 10:20:12.795411 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 10:20:12.807068 (MainThread): Parsing macros/core.sql
2021-03-31 10:20:12.811440 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 10:20:12.820751 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 10:20:12.822782 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 10:20:12.841576 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 10:20:12.875595 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 10:20:12.897223 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 10:20:12.899267 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 10:20:12.905787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 10:20:12.920298 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 10:20:12.928004 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 10:20:12.935353 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 10:20:12.941431 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 10:20:12.942580 (MainThread): Parsing macros/etc/query.sql
2021-03-31 10:20:12.944108 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 10:20:12.945944 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 10:20:12.956056 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 10:20:12.958318 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 10:20:12.960572 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 10:20:13.004217 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 10:20:13.006284 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 10:20:13.007989 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 10:20:13.009945 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 10:20:13.018072 (MainThread): Partial parsing not enabled
2021-03-31 10:20:13.056246 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:20:13.078228 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:20:13.089865 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:20:13.364254 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8858a91b-b48b-41ea-90f6-84e16dac16ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11528bb70>]}
2021-03-31 10:20:13.404116 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 10:20:13.404960 (MainThread): 
2021-03-31 10:20:13.405238 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:20:13.413360 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:20:13.419871 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:20:13.432644 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:20:13.436038 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:20:13.436184 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 10:20:13.436350 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 10:20:13.436484 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 10:20:13.436586 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 10:20:20.757132 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 2 in 7.32 seconds
2021-03-31 10:20:20.763190 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 10:20:20.765297 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 7.33 seconds
2021-03-31 10:20:20.769090 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 10:20:21.207153 (MainThread): 18:20:21 | Concurrency: 5 threads (target='dev')
2021-03-31 10:20:21.207360 (MainThread): 18:20:21 | 
2021-03-31 10:20:21.208812 (Thread-1): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:20:21.209045 (Thread-2): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:20:21.209248 (Thread-1): 18:20:21 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 10:20:21.209376 (Thread-3): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:20:21.209656 (Thread-4): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:20:21.209843 (Thread-2): 18:20:21 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 10:20:21.210353 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:20:21.210597 (Thread-3): 18:20:21 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 10:20:21.210951 (Thread-4): 18:20:21 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 10:20:21.211561 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:20:21.211760 (Thread-1): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:20:21.212255 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:20:21.212930 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:20:21.213138 (Thread-2): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:20:21.224192 (Thread-3): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:20:21.236696 (Thread-1): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 10:20:21.236879 (Thread-4): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:20:21.246840 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 10:20:21.256428 (Thread-3): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 10:20:21.265788 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 10:20:21.266609 (Thread-1): finished collecting timing info
2021-03-31 10:20:21.266965 (Thread-3): finished collecting timing info
2021-03-31 10:20:21.267656 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:20:21.268463 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:20:21.268604 (Thread-4): finished collecting timing info
2021-03-31 10:20:21.268889 (Thread-2): finished collecting timing info
2021-03-31 10:20:21.269180 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 10:20:21.269330 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 10:20:21.270105 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:20:21.270648 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:20:21.270820 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 10:20:21.270982 (Thread-3): Opening a new connection, currently in state init
2021-03-31 10:20:21.271121 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 10:20:21.271257 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 10:20:21.274528 (Thread-4): Opening a new connection, currently in state init
2021-03-31 10:20:21.275093 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 10:20:23.511569 (Thread-1): SQL status: SUCCESS 1 in 2.24 seconds
2021-03-31 10:20:23.511773 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:20:23.511883 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 10:20:23.524112 (Thread-2): SQL status: SUCCESS 1 in 2.25 seconds
2021-03-31 10:20:23.524321 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:20:23.524443 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 10:20:23.544797 (Thread-4): SQL status: SUCCESS 1 in 2.27 seconds
2021-03-31 10:20:23.545005 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:20:23.545126 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:20:23.945766 (Thread-3): SQL status: SUCCESS 1 in 2.67 seconds
2021-03-31 10:20:23.945943 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:20:23.946041 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:20:25.224674 (Thread-2): SQL status: SUCCESS 1 in 1.70 seconds
2021-03-31 10:20:25.225377 (Thread-2): finished collecting timing info
2021-03-31 10:20:25.226209 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:20:25.235443 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-03-31 10:20:25.235968 (Thread-1): finished collecting timing info
2021-03-31 10:20:25.236326 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:20:25.246849 (Thread-4): SQL status: SUCCESS 1 in 1.70 seconds
2021-03-31 10:20:25.247257 (Thread-4): finished collecting timing info
2021-03-31 10:20:25.247613 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:20:25.261075 (Thread-3): SQL status: SUCCESS 1 in 1.31 seconds
2021-03-31 10:20:25.261587 (Thread-3): finished collecting timing info
2021-03-31 10:20:25.261982 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:20:25.558187 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 10:20:26.424774 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 10:20:26.426850 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 10:20:26.427934 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 10:20:26.654229 (Thread-2): 18:20:26 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 5.44s]
2021-03-31 10:20:26.654595 (Thread-2): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:20:26.844580 (Thread-4): 18:20:26 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 5.63s]
2021-03-31 10:20:26.844779 (Thread-4): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:20:26.850245 (Thread-1): 18:20:26 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 5.64s]
2021-03-31 10:20:26.850973 (Thread-1): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:20:26.853037 (Thread-3): 18:20:26 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 5.64s]
2021-03-31 10:20:26.853205 (Thread-3): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:20:26.858687 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:20:26.859213 (MainThread): 18:20:26 | 
2021-03-31 10:20:26.859396 (MainThread): 18:20:26 | Finished running 4 tests in 13.45s.
2021-03-31 10:20:26.859623 (MainThread): Connection 'master' was properly closed.
2021-03-31 10:20:26.859871 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 10:20:26.860029 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 10:20:26.860145 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 10:20:26.860238 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 10:20:26.913954 (MainThread): 
2021-03-31 10:20:26.914176 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 10:20:26.914307 (MainThread): 
2021-03-31 10:20:26.914479 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/staging/schema.yml)
2021-03-31 10:20:26.914671 (MainThread):   Got 1 result, expected 0.
2021-03-31 10:20:26.914852 (MainThread): 
2021-03-31 10:20:26.915071 (MainThread):   compiled SQL at target/compiled/demo_dbt/models/staging/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-03-31 10:20:26.915223 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-03-31 10:20:26.915411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e5f048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155acba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155e82b0>]}
2021-03-31 10:20:26.915641 (MainThread): Flushing usage events
2021-03-31 10:25:03.898097 (MainThread): Running with dbt=0.19.0
2021-03-31 10:25:04.734474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 10:25:04.735779 (MainThread): Tracking: tracking
2021-03-31 10:25:04.736254 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb564a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb56390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb56358>]}
2021-03-31 10:25:04.768563 (MainThread): Partial parsing not enabled
2021-03-31 10:25:04.770312 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 10:25:04.773131 (MainThread): Parsing macros/catalog.sql
2021-03-31 10:25:04.776452 (MainThread): Parsing macros/adapters.sql
2021-03-31 10:25:04.819745 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 10:25:04.822696 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 10:25:04.825228 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 10:25:04.831096 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 10:25:04.846606 (MainThread): Parsing macros/core.sql
2021-03-31 10:25:04.852373 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 10:25:04.865114 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 10:25:04.867668 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 10:25:04.892707 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 10:25:04.940623 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 10:25:04.971490 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 10:25:04.974535 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 10:25:04.983778 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 10:25:05.003684 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 10:25:05.013704 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 10:25:05.023063 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 10:25:05.030084 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 10:25:05.031537 (MainThread): Parsing macros/etc/query.sql
2021-03-31 10:25:05.033170 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 10:25:05.035458 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 10:25:05.048108 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 10:25:05.050895 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 10:25:05.053378 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 10:25:05.109005 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 10:25:05.111772 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 10:25:05.114045 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 10:25:05.116369 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 10:25:05.126807 (MainThread): Partial parsing not enabled
2021-03-31 10:25:05.176553 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:05.205274 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:05.220801 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:05.527303 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6213d0-18ed-4921-83fc-bc9247ad30f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb6ffd0>]}
2021-03-31 10:25:05.575722 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 10:25:05.576686 (MainThread): 
2021-03-31 10:25:05.577035 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:25:05.586237 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:05.592327 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:05.605572 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:05.605759 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 10:25:05.611191 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 10:25:05.611705 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:05.612824 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 10:25:05.612941 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 10:25:07.831348 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.22 seconds
2021-03-31 10:25:07.838281 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 10:25:08.005825 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 2.39 seconds
2021-03-31 10:25:08.011440 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 10:25:08.457949 (MainThread): 18:25:08 | Concurrency: 5 threads (target='dev')
2021-03-31 10:25:08.458197 (MainThread): 18:25:08 | 
2021-03-31 10:25:08.459589 (Thread-1): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:25:08.459805 (Thread-1): 18:25:08 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 10:25:08.460137 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:25:08.460280 (Thread-2): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:25:08.460519 (Thread-1): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:25:08.460652 (Thread-3): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:25:08.460816 (Thread-4): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:25:08.460994 (Thread-2): 18:25:08 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 10:25:08.478435 (Thread-3): 18:25:08 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 10:25:08.484408 (Thread-1): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 10:25:08.484622 (Thread-4): 18:25:08 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 10:25:08.484980 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:25:08.485303 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:25:08.485821 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:25:08.485969 (Thread-2): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:25:08.486243 (Thread-3): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:25:08.486413 (Thread-1): finished collecting timing info
2021-03-31 10:25:08.486703 (Thread-4): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:25:08.496802 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 10:25:08.506210 (Thread-3): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 10:25:08.506846 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:25:08.516218 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 10:25:08.516636 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 10:25:08.516955 (Thread-2): finished collecting timing info
2021-03-31 10:25:08.517436 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 10:25:08.517591 (Thread-4): finished collecting timing info
2021-03-31 10:25:08.518217 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:25:08.518329 (Thread-3): finished collecting timing info
2021-03-31 10:25:08.519401 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:25:08.520578 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 10:25:08.521431 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:25:08.521945 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 10:25:08.522376 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 10:25:08.522517 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 10:25:08.522673 (Thread-4): Opening a new connection, currently in state init
2021-03-31 10:25:08.523507 (Thread-3): Opening a new connection, currently in state init
2021-03-31 10:25:10.527572 (Thread-3): SQL status: SUCCESS 1 in 2.00 seconds
2021-03-31 10:25:10.527763 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:25:10.527870 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:25:10.529078 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2021-03-31 10:25:10.529811 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:25:10.530088 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 10:25:10.696648 (Thread-4): SQL status: SUCCESS 1 in 2.17 seconds
2021-03-31 10:25:10.696847 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:25:10.696953 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:25:10.775383 (Thread-2): SQL status: SUCCESS 1 in 2.25 seconds
2021-03-31 10:25:10.775596 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:25:10.775719 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 10:25:10.798204 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-03-31 10:25:10.798683 (Thread-1): finished collecting timing info
2021-03-31 10:25:10.799400 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:25:10.832947 (Thread-3): SQL status: SUCCESS 1 in 0.30 seconds
2021-03-31 10:25:10.833374 (Thread-3): finished collecting timing info
2021-03-31 10:25:10.833739 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:25:11.030238 (Thread-4): SQL status: SUCCESS 1 in 0.33 seconds
2021-03-31 10:25:11.030621 (Thread-4): finished collecting timing info
2021-03-31 10:25:11.030938 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:25:11.033968 (Thread-2): SQL status: SUCCESS 1 in 0.26 seconds
2021-03-31 10:25:11.034324 (Thread-2): finished collecting timing info
2021-03-31 10:25:11.034659 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:25:11.097202 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 10:25:11.115218 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 10:25:11.334304 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 10:25:11.335657 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 10:25:11.522007 (Thread-1): 18:25:11 | 1 of 4 FAIL 1 not_null_my_first_dbt_model_id......................... [FAIL 1 in 3.06s]
2021-03-31 10:25:11.522228 (Thread-1): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:25:11.577338 (Thread-3): 18:25:11 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 3.09s]
2021-03-31 10:25:11.577591 (Thread-3): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:25:11.751631 (Thread-2): 18:25:11 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 3.27s]
2021-03-31 10:25:11.751826 (Thread-2): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:25:11.755174 (Thread-4): 18:25:11 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 3.27s]
2021-03-31 10:25:11.755391 (Thread-4): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:25:11.759224 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:25:11.759605 (MainThread): 18:25:11 | 
2021-03-31 10:25:11.759764 (MainThread): 18:25:11 | Finished running 4 tests in 6.18s.
2021-03-31 10:25:11.759886 (MainThread): Connection 'master' was properly closed.
2021-03-31 10:25:11.759979 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 10:25:11.760066 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 10:25:11.760151 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 10:25:11.760234 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 10:25:11.814975 (MainThread): 
2021-03-31 10:25:11.815187 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 10:25:11.815422 (MainThread): 
2021-03-31 10:25:11.815635 (MainThread): Failure in test not_null_my_first_dbt_model_id (models/staging/schema.yml)
2021-03-31 10:25:11.815778 (MainThread):   Got 1 result, expected 0.
2021-03-31 10:25:11.815896 (MainThread): 
2021-03-31 10:25:11.816013 (MainThread):   compiled SQL at target/compiled/demo_dbt/models/staging/schema.yml/schema_test/not_null_my_first_dbt_model_id.sql
2021-03-31 10:25:11.816138 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-03-31 10:25:11.816325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb3c908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2025f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca6cc0>]}
2021-03-31 10:25:11.816553 (MainThread): Flushing usage events
2021-03-31 10:25:35.385694 (MainThread): Running with dbt=0.19.0
2021-03-31 10:25:36.082418 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 10:25:36.084333 (MainThread): Tracking: tracking
2021-03-31 10:25:36.085769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa3358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa3240>]}
2021-03-31 10:25:36.115551 (MainThread): Partial parsing not enabled
2021-03-31 10:25:36.116715 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 10:25:36.118727 (MainThread): Parsing macros/catalog.sql
2021-03-31 10:25:36.121534 (MainThread): Parsing macros/adapters.sql
2021-03-31 10:25:36.158224 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 10:25:36.160636 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 10:25:36.162551 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 10:25:36.167203 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 10:25:36.178599 (MainThread): Parsing macros/core.sql
2021-03-31 10:25:36.183055 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 10:25:36.192441 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 10:25:36.194411 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 10:25:36.213352 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 10:25:36.247312 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 10:25:36.269067 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 10:25:36.271157 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 10:25:36.278011 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 10:25:36.292821 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 10:25:36.300041 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 10:25:36.306779 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 10:25:36.312371 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 10:25:36.313515 (MainThread): Parsing macros/etc/query.sql
2021-03-31 10:25:36.314743 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 10:25:36.316552 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 10:25:36.326067 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 10:25:36.328222 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 10:25:36.330453 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 10:25:36.374981 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 10:25:36.377083 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 10:25:36.378802 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 10:25:36.380717 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 10:25:36.388899 (MainThread): Partial parsing not enabled
2021-03-31 10:25:36.427564 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:36.449932 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:36.461552 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:36.708699 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2333dbfc-c01c-4262-95da-935afc370d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111579358>]}
2021-03-31 10:25:36.746117 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 10:25:36.746831 (MainThread): 
2021-03-31 10:25:36.747103 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:25:36.751020 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 10:25:36.751324 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 10:25:36.767651 (ThreadPoolExecutor-0_1): Using snowflake connection "list_DEMO_DB".
2021-03-31 10:25:36.767768 (ThreadPoolExecutor-0_1): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 10:25:36.767849 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2021-03-31 10:25:36.770927 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 10:25:36.771026 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 10:25:36.771108 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 10:25:38.997500 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 4 in 2.23 seconds
2021-03-31 10:25:38.998436 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.23 seconds
2021-03-31 10:25:39.002474 (ThreadPoolExecutor-0_1): On list_DEMO_DB: Close
2021-03-31 10:25:39.003205 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 10:25:39.444471 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:39.444947 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:39.453056 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:39.455200 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:39.455437 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 10:25:39.455558 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 10:25:39.455669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 10:25:39.455773 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state closed
2021-03-31 10:25:41.905519 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 2 in 2.45 seconds
2021-03-31 10:25:41.910059 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 10:25:41.914170 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.46 seconds
2021-03-31 10:25:41.919791 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 10:25:42.336625 (MainThread): Using snowflake connection "master".
2021-03-31 10:25:42.336810 (MainThread): On master: BEGIN
2021-03-31 10:25:42.336932 (MainThread): Opening a new connection, currently in state init
2021-03-31 10:25:43.953735 (MainThread): SQL status: SUCCESS 1 in 1.62 seconds
2021-03-31 10:25:43.953968 (MainThread): On master: COMMIT
2021-03-31 10:25:43.954177 (MainThread): Using snowflake connection "master".
2021-03-31 10:25:43.954297 (MainThread): On master: COMMIT
2021-03-31 10:25:44.266854 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-03-31 10:25:44.267127 (MainThread): On master: Close
2021-03-31 10:25:44.687659 (MainThread): 18:25:44 | Concurrency: 5 threads (target='dev')
2021-03-31 10:25:44.687900 (MainThread): 18:25:44 | 
2021-03-31 10:25:44.689549 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 10:25:44.689811 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 10:25:44.691114 (Thread-1): 18:25:44 | 1 of 3 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 10:25:44.692414 (Thread-2): 18:25:44 | 2 of 3 START view model PUBLIC.snowflake_sample_data_store_sales..... [RUN]
2021-03-31 10:25:44.692957 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:44.693407 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:44.693633 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 10:25:44.693798 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 10:25:44.733380 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 10:25:44.734332 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 10:25:44.735364 (Thread-1): finished collecting timing info
2021-03-31 10:25:44.772658 (Thread-2): finished collecting timing info
2021-03-31 10:25:44.776337 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 10:25:44.802239 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 10:25:44.803174 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:44.803303 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 10:25:44.803412 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 10:25:44.805965 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:44.806426 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 10:25:44.807025 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 10:25:46.547850 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-03-31 10:25:46.548071 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:46.548193 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 10:25:46.786550 (Thread-2): SQL status: SUCCESS 1 in 1.98 seconds
2021-03-31 10:25:46.786810 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:46.787000 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.PUBLIC.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 10:25:47.382791 (Thread-2): SQL status: SUCCESS 1 in 0.60 seconds
2021-03-31 10:25:47.387468 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 10:25:47.387690 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:47.387799 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 10:25:47.602470 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-03-31 10:25:47.608285 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 10:25:47.608530 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:47.608643 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 10:25:47.615698 (Thread-2): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 10:25:47.629664 (Thread-2): finished collecting timing info
2021-03-31 10:25:47.629987 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 10:25:47.834411 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 10:25:47.842071 (Thread-1): finished collecting timing info
2021-03-31 10:25:47.842405 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 10:25:48.046848 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2333dbfc-c01c-4262-95da-935afc370d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113499320>]}
2021-03-31 10:25:48.048189 (Thread-2): 18:25:48 | 2 of 3 OK created view model PUBLIC.snowflake_sample_data_store_sales [SUCCESS 1 in 3.35s]
2021-03-31 10:25:48.048356 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 10:25:48.257460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2333dbfc-c01c-4262-95da-935afc370d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bde8d0>]}
2021-03-31 10:25:48.259245 (Thread-1): 18:25:48 | 1 of 3 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 3.56s]
2021-03-31 10:25:48.259456 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 10:25:48.260098 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 10:25:48.261439 (Thread-4): 18:25:48 | 3 of 3 START view model staging.my_second_dbt_model.................. [RUN]
2021-03-31 10:25:48.261812 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:48.261949 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 10:25:48.271091 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 10:25:48.271550 (Thread-4): finished collecting timing info
2021-03-31 10:25:48.277290 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 10:25:48.278233 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:48.278353 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 10:25:48.278455 (Thread-4): Opening a new connection, currently in state init
2021-03-31 10:25:49.946370 (Thread-4): SQL status: SUCCESS 1 in 1.67 seconds
2021-03-31 10:25:49.946611 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:49.946754 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.staging.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
  );
2021-03-31 10:25:50.367451 (Thread-4): SQL status: SUCCESS 1 in 0.42 seconds
2021-03-31 10:25:50.372089 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 10:25:50.372401 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:50.372527 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 10:25:50.792996 (Thread-4): SQL status: SUCCESS 1 in 0.42 seconds
2021-03-31 10:25:50.796919 (Thread-4): finished collecting timing info
2021-03-31 10:25:50.797193 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 10:25:51.379665 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2333dbfc-c01c-4262-95da-935afc370d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136263c8>]}
2021-03-31 10:25:51.380982 (Thread-4): 18:25:51 | 3 of 3 OK created view model staging.my_second_dbt_model............. [SUCCESS 1 in 3.12s]
2021-03-31 10:25:51.381154 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 10:25:51.382662 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:25:51.382891 (MainThread): Using snowflake connection "master".
2021-03-31 10:25:51.382997 (MainThread): On master: BEGIN
2021-03-31 10:25:51.383097 (MainThread): Opening a new connection, currently in state closed
2021-03-31 10:25:52.873128 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 10:25:52.873364 (MainThread): On master: COMMIT
2021-03-31 10:25:52.873566 (MainThread): Using snowflake connection "master".
2021-03-31 10:25:52.873686 (MainThread): On master: COMMIT
2021-03-31 10:25:53.190811 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 10:25:53.191088 (MainThread): On master: Close
2021-03-31 10:25:54.077090 (MainThread): 18:25:54 | 
2021-03-31 10:25:54.077320 (MainThread): 18:25:54 | Finished running 2 view models, 1 table model in 17.33s.
2021-03-31 10:25:54.077478 (MainThread): Connection 'master' was properly closed.
2021-03-31 10:25:54.077573 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 10:25:54.077663 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 10:25:54.077750 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 10:25:54.125925 (MainThread): 
2021-03-31 10:25:54.126109 (MainThread): Completed successfully
2021-03-31 10:25:54.126245 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 10:25:54.126431 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bde7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb1c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ebc18>]}
2021-03-31 10:25:54.126653 (MainThread): Flushing usage events
2021-03-31 10:25:58.314391 (MainThread): Running with dbt=0.19.0
2021-03-31 10:25:59.065071 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 10:25:59.066033 (MainThread): Tracking: tracking
2021-03-31 10:25:59.066586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f01320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f012e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f01208>]}
2021-03-31 10:25:59.095644 (MainThread): Partial parsing not enabled
2021-03-31 10:25:59.096596 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 10:25:59.098482 (MainThread): Parsing macros/catalog.sql
2021-03-31 10:25:59.101246 (MainThread): Parsing macros/adapters.sql
2021-03-31 10:25:59.140311 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 10:25:59.143544 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 10:25:59.145597 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 10:25:59.150808 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 10:25:59.165731 (MainThread): Parsing macros/core.sql
2021-03-31 10:25:59.170900 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 10:25:59.183030 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 10:25:59.185253 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 10:25:59.209847 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 10:25:59.261786 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 10:25:59.294268 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 10:25:59.296894 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 10:25:59.305680 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 10:25:59.327983 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 10:25:59.339896 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 10:25:59.353707 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 10:25:59.363357 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 10:25:59.365088 (MainThread): Parsing macros/etc/query.sql
2021-03-31 10:25:59.366719 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 10:25:59.369089 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 10:25:59.384277 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 10:25:59.387040 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 10:25:59.391120 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 10:25:59.451456 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 10:25:59.453629 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 10:25:59.455457 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 10:25:59.457445 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 10:25:59.465687 (MainThread): Partial parsing not enabled
2021-03-31 10:25:59.503891 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 10:25:59.525969 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 10:25:59.537141 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 10:25:59.789750 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20c29215-657e-4516-b6f7-7c8f446da649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f185f8>]}
2021-03-31 10:25:59.827630 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 10:25:59.828364 (MainThread): 
2021-03-31 10:25:59.828629 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:25:59.836151 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:59.842851 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:59.854230 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 10:25:59.854345 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 10:25:59.854432 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 10:25:59.856442 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 10:25:59.857446 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 10:25:59.857541 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 10:26:01.694344 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.84 seconds
2021-03-31 10:26:01.701718 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 10:26:01.703300 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 2 in 1.85 seconds
2021-03-31 10:26:01.708192 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 10:26:02.133031 (MainThread): 18:26:02 | Concurrency: 5 threads (target='dev')
2021-03-31 10:26:02.133262 (MainThread): 18:26:02 | 
2021-03-31 10:26:02.135117 (Thread-1): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:26:02.135415 (Thread-2): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:26:02.135697 (Thread-3): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:26:02.135882 (Thread-4): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:26:02.136066 (Thread-1): 18:26:02 | 1 of 4 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 10:26:02.136244 (Thread-2): 18:26:02 | 2 of 4 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 10:26:02.136464 (Thread-3): 18:26:02 | 3 of 4 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 10:26:02.136639 (Thread-4): 18:26:02 | 4 of 4 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 10:26:02.137356 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:26:02.138035 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:26:02.138790 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:26:02.139502 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:26:02.139757 (Thread-1): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:26:02.139935 (Thread-2): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:26:02.140079 (Thread-3): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:26:02.140249 (Thread-4): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:26:02.193778 (Thread-1): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 10:26:02.195444 (Thread-3): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 10:26:02.199674 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 10:26:02.210187 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 10:26:02.211578 (Thread-3): finished collecting timing info
2021-03-31 10:26:02.211964 (Thread-2): finished collecting timing info
2021-03-31 10:26:02.212221 (Thread-4): finished collecting timing info
2021-03-31 10:26:02.213074 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:26:02.213993 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:26:02.214220 (Thread-1): finished collecting timing info
2021-03-31 10:26:02.215294 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:26:02.215473 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 10:26:02.215633 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 10:26:02.216179 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:26:02.216323 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 10:26:02.216462 (Thread-3): Opening a new connection, currently in state init
2021-03-31 10:26:02.216579 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 10:26:02.216707 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 10:26:02.216824 (Thread-4): Opening a new connection, currently in state init
2021-03-31 10:26:02.218520 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 10:26:03.990304 (Thread-2): SQL status: SUCCESS 1 in 1.77 seconds
2021-03-31 10:26:03.990553 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 10:26:03.990698 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 10:26:04.026553 (Thread-3): SQL status: SUCCESS 1 in 1.81 seconds
2021-03-31 10:26:04.026795 (Thread-3): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 10:26:04.026944 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:26:04.072216 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-03-31 10:26:04.072399 (Thread-1): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 10:26:04.072497 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 10:26:04.267229 (Thread-4): SQL status: SUCCESS 1 in 2.05 seconds
2021-03-31 10:26:04.267472 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 10:26:04.267616 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 10:26:04.561720 (Thread-2): SQL status: SUCCESS 1 in 0.57 seconds
2021-03-31 10:26:04.562437 (Thread-2): finished collecting timing info
2021-03-31 10:26:04.562895 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:26:04.566837 (Thread-3): SQL status: SUCCESS 1 in 0.54 seconds
2021-03-31 10:26:04.567119 (Thread-3): finished collecting timing info
2021-03-31 10:26:04.567404 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:26:04.600033 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-03-31 10:26:04.600549 (Thread-1): finished collecting timing info
2021-03-31 10:26:04.600990 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 10:26:04.859147 (Thread-3): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 10:26:04.868983 (Thread-2): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 10:26:04.922081 (Thread-1): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 10:26:05.231497 (Thread-4): SQL status: SUCCESS 1 in 0.96 seconds
2021-03-31 10:26:05.231870 (Thread-4): finished collecting timing info
2021-03-31 10:26:05.232188 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 10:26:05.275086 (Thread-3): 18:26:05 | 3 of 4 PASS unique_my_first_dbt_model_id............................. [PASS in 3.14s]
2021-03-31 10:26:05.275245 (Thread-3): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 10:26:05.292434 (Thread-2): 18:26:05 | 2 of 4 PASS not_null_my_second_dbt_model_id.......................... [PASS in 3.15s]
2021-03-31 10:26:05.292685 (Thread-2): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 10:26:05.357386 (Thread-1): 18:26:05 | 1 of 4 PASS not_null_my_first_dbt_model_id........................... [PASS in 3.22s]
2021-03-31 10:26:05.357541 (Thread-1): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 10:26:05.524651 (Thread-4): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 10:26:05.951715 (Thread-4): 18:26:05 | 4 of 4 PASS unique_my_second_dbt_model_id............................ [PASS in 3.81s]
2021-03-31 10:26:05.951942 (Thread-4): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 10:26:05.955691 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 10:26:05.956109 (MainThread): 18:26:05 | 
2021-03-31 10:26:05.956272 (MainThread): 18:26:05 | Finished running 4 tests in 6.13s.
2021-03-31 10:26:05.956405 (MainThread): Connection 'master' was properly closed.
2021-03-31 10:26:05.956506 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 10:26:05.956604 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 10:26:05.956697 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 10:26:05.956803 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 10:26:06.005393 (MainThread): 
2021-03-31 10:26:06.005572 (MainThread): Completed successfully
2021-03-31 10:26:06.005700 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-03-31 10:26:06.005877 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116180e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef30f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f0d470>]}
2021-03-31 10:26:06.006081 (MainThread): Flushing usage events
2021-03-31 11:00:32.685587 (MainThread): Running with dbt=0.19.0
2021-03-31 11:00:33.461291 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 11:00:33.462608 (MainThread): Tracking: tracking
2021-03-31 11:00:33.463124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11691b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11691b358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11691b278>]}
2021-03-31 11:00:33.491843 (MainThread): Partial parsing not enabled
2021-03-31 11:00:33.493408 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 11:00:33.495648 (MainThread): Parsing macros/catalog.sql
2021-03-31 11:00:33.498561 (MainThread): Parsing macros/adapters.sql
2021-03-31 11:00:33.536731 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 11:00:33.539352 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 11:00:33.541590 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 11:00:33.547231 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 11:00:33.561349 (MainThread): Parsing macros/core.sql
2021-03-31 11:00:33.566709 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 11:00:33.578084 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 11:00:33.580533 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 11:00:33.603506 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 11:00:33.640601 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 11:00:33.664347 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 11:00:33.666794 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 11:00:33.674478 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 11:00:33.691417 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 11:00:33.699149 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 11:00:33.705893 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 11:00:33.711670 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 11:00:33.712916 (MainThread): Parsing macros/etc/query.sql
2021-03-31 11:00:33.714404 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 11:00:33.716502 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 11:00:33.727460 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 11:00:33.730213 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 11:00:33.732730 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 11:00:33.780396 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 11:00:33.782640 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 11:00:33.784358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 11:00:33.786342 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 11:00:33.794954 (MainThread): Partial parsing not enabled
2021-03-31 11:00:33.841410 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:00:33.868348 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:00:33.883423 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:00:34.180217 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e917c226-581e-46b9-bbb0-157146322236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153ef828>]}
2021-03-31 11:00:34.227333 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 11:00:34.228191 (MainThread): 
2021-03-31 11:00:34.228675 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:00:34.233300 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 11:00:34.250548 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 11:00:34.250700 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 11:00:34.250800 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 11:00:37.438746 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.19 seconds
2021-03-31 11:00:37.443551 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 11:00:38.077512 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:00:38.078004 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:00:38.091593 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:00:38.091733 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 11:00:38.091842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 11:00:38.092958 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:00:38.093082 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 11:00:38.093187 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 11:00:40.260617 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.17 seconds
2021-03-31 11:00:40.263370 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 11:00:40.485471 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 2.39 seconds
2021-03-31 11:00:40.489648 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 11:00:41.051039 (MainThread): Using snowflake connection "master".
2021-03-31 11:00:41.051222 (MainThread): On master: BEGIN
2021-03-31 11:00:41.051345 (MainThread): Opening a new connection, currently in state init
2021-03-31 11:00:43.583648 (MainThread): SQL status: SUCCESS 1 in 2.53 seconds
2021-03-31 11:00:43.583925 (MainThread): On master: COMMIT
2021-03-31 11:00:43.584175 (MainThread): Using snowflake connection "master".
2021-03-31 11:00:43.585905 (MainThread): On master: COMMIT
2021-03-31 11:00:44.105694 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2021-03-31 11:00:44.105977 (MainThread): On master: Close
2021-03-31 11:00:45.176829 (MainThread): 19:00:45 | Concurrency: 5 threads (target='dev')
2021-03-31 11:00:45.177086 (MainThread): 19:00:45 | 
2021-03-31 11:00:45.178360 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:00:45.178533 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:00:45.179800 (Thread-1): 19:00:45 | 1 of 3 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 11:00:45.180920 (Thread-2): 19:00:45 | 2 of 3 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 11:00:45.181273 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:00:45.181613 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:00:45.181762 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 11:00:45.181898 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:00:45.216968 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:00:45.217514 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:00:45.218138 (Thread-1): finished collecting timing info
2021-03-31 11:00:45.229301 (Thread-2): finished collecting timing info
2021-03-31 11:00:45.269430 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:00:45.270444 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:00:45.271496 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:00:45.271584 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 11:00:45.271663 (Thread-2): Opening a new connection, currently in state init
2021-03-31 11:00:45.272809 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:00:45.272901 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 11:00:45.272979 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 11:00:48.067935 (Thread-1): SQL status: SUCCESS 1 in 2.79 seconds
2021-03-31 11:00:48.068192 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:00:48.068341 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 11:00:48.079190 (Thread-2): SQL status: SUCCESS 1 in 2.81 seconds
2021-03-31 11:00:48.079402 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:00:48.079521 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 11:00:48.790650 (Thread-2): SQL status: SUCCESS 1 in 0.71 seconds
2021-03-31 11:00:48.795454 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:00:48.795683 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:00:48.795795 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:00:49.550389 (Thread-2): SQL status: SUCCESS 1 in 0.75 seconds
2021-03-31 11:00:49.563147 (Thread-2): finished collecting timing info
2021-03-31 11:00:49.563458 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 11:00:50.743921 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e917c226-581e-46b9-bbb0-157146322236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c5eda0>]}
2021-03-31 11:00:50.745550 (Thread-2): 19:00:50 | 2 of 3 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 5.56s]
2021-03-31 11:00:50.745785 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:01:42.746313 (Thread-1): SQL status: SUCCESS 1 in 54.68 seconds
2021-03-31 11:01:42.750752 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 11:01:42.750940 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:01:42.751041 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 11:01:43.384114 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-03-31 11:01:43.390992 (Thread-1): finished collecting timing info
2021-03-31 11:01:43.391344 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 11:01:44.219397 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e917c226-581e-46b9-bbb0-157146322236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c49c50>]}
2021-03-31 11:01:44.220647 (Thread-1): 19:01:44 | 1 of 3 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 59.04s]
2021-03-31 11:01:44.220805 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:01:44.221120 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:01:44.222180 (Thread-4): 19:01:44 | 3 of 3 START view model staging.my_second_dbt_model.................. [RUN]
2021-03-31 11:01:44.222476 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:01:44.222597 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 11:01:44.232708 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 11:01:44.233201 (Thread-4): finished collecting timing info
2021-03-31 11:01:44.238062 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 11:01:44.238851 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:01:44.238954 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 11:01:44.239048 (Thread-4): Opening a new connection, currently in state init
2021-03-31 11:01:47.559550 (Thread-4): SQL status: SUCCESS 1 in 3.32 seconds
2021-03-31 11:01:47.559742 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:01:47.559960 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create or replace  view DEMO_DB.staging.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
  );
2021-03-31 11:01:48.534687 (Thread-4): SQL status: SUCCESS 1 in 0.97 seconds
2021-03-31 11:01:48.539832 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 11:01:48.540069 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:01:48.540180 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 11:01:49.746004 (Thread-4): SQL status: SUCCESS 1 in 1.21 seconds
2021-03-31 11:01:49.750675 (Thread-4): finished collecting timing info
2021-03-31 11:01:49.751045 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 11:01:51.049982 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e917c226-581e-46b9-bbb0-157146322236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c48898>]}
2021-03-31 11:01:51.051292 (Thread-4): 19:01:51 | 3 of 3 OK created view model staging.my_second_dbt_model............. [SUCCESS 1 in 6.83s]
2021-03-31 11:01:51.051459 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:01:51.063294 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:01:51.063564 (MainThread): Using snowflake connection "master".
2021-03-31 11:01:51.063670 (MainThread): On master: BEGIN
2021-03-31 11:01:51.063768 (MainThread): Opening a new connection, currently in state closed
2021-03-31 11:01:54.558884 (MainThread): SQL status: SUCCESS 1 in 3.50 seconds
2021-03-31 11:01:54.559089 (MainThread): On master: COMMIT
2021-03-31 11:01:54.559266 (MainThread): Using snowflake connection "master".
2021-03-31 11:01:54.559436 (MainThread): On master: COMMIT
2021-03-31 11:01:55.382709 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-03-31 11:01:55.382987 (MainThread): On master: Close
2021-03-31 11:01:56.708784 (MainThread): 19:01:56 | 
2021-03-31 11:01:56.709195 (MainThread): 19:01:56 | Finished running 2 view models, 1 table model in 82.48s.
2021-03-31 11:01:56.709473 (MainThread): Connection 'master' was properly closed.
2021-03-31 11:01:56.709610 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 11:01:56.709739 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 11:01:56.709867 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 11:01:56.709975 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 11:01:56.758874 (MainThread): 
2021-03-31 11:01:56.759169 (MainThread): Completed successfully
2021-03-31 11:01:56.759433 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 11:01:56.759648 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118af2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11703d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c6e278>]}
2021-03-31 11:01:56.759933 (MainThread): Flushing usage events
2021-03-31 11:02:06.023830 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-03-31 11:02:06.024037 (MainThread): Error sending message, disabling tracking
2021-03-31 11:03:54.940437 (MainThread): Running with dbt=0.19.0
2021-03-31 11:03:55.486388 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 11:03:55.487316 (MainThread): Tracking: tracking
2021-03-31 11:03:55.487626 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109578518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095784e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109578400>]}
2021-03-31 11:03:55.510740 (MainThread): Partial parsing not enabled
2021-03-31 11:03:55.511449 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 11:03:55.513245 (MainThread): Parsing macros/catalog.sql
2021-03-31 11:03:55.515623 (MainThread): Parsing macros/adapters.sql
2021-03-31 11:03:55.546732 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 11:03:55.548800 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 11:03:55.550314 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 11:03:55.554356 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 11:03:55.564961 (MainThread): Parsing macros/core.sql
2021-03-31 11:03:55.568902 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 11:03:55.577658 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 11:03:55.579420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 11:03:55.597870 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 11:03:55.631271 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 11:03:55.653056 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 11:03:55.655049 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 11:03:55.661755 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 11:03:55.676139 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 11:03:55.683205 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 11:03:55.689921 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 11:03:55.694994 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 11:03:55.695960 (MainThread): Parsing macros/etc/query.sql
2021-03-31 11:03:55.697040 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 11:03:55.698721 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 11:03:55.707898 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 11:03:55.710049 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 11:03:55.711813 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 11:03:55.756113 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 11:03:55.758365 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 11:03:55.760189 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 11:03:55.762119 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 11:03:55.770647 (MainThread): Partial parsing not enabled
2021-03-31 11:03:55.809475 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:03:55.833786 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:03:55.847976 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:03:56.104809 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c60ada0-2d30-4541-954f-5be76df92ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080453c8>]}
2021-03-31 11:03:56.144173 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 11:03:56.144863 (MainThread): 
2021-03-31 11:03:56.145128 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:03:56.148552 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 11:03:56.161462 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 11:03:56.161597 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 11:03:56.161680 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 11:03:59.443251 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.28 seconds
2021-03-31 11:03:59.447694 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 11:04:00.912123 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:04:00.917815 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:04:00.921053 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:04:00.923266 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:04:00.923403 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 11:04:00.923544 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 11:04:00.923681 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 11:04:00.923809 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 11:04:04.572867 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 3.65 seconds
2021-03-31 11:04:04.577096 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 11:04:05.007939 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 4.08 seconds
2021-03-31 11:04:05.012718 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 11:04:06.123968 (MainThread): Using snowflake connection "master".
2021-03-31 11:04:06.124163 (MainThread): On master: BEGIN
2021-03-31 11:04:06.124293 (MainThread): Opening a new connection, currently in state init
2021-03-31 11:04:10.363560 (MainThread): SQL status: SUCCESS 1 in 4.24 seconds
2021-03-31 11:04:10.363811 (MainThread): On master: COMMIT
2021-03-31 11:04:10.363996 (MainThread): Using snowflake connection "master".
2021-03-31 11:04:10.364098 (MainThread): On master: COMMIT
2021-03-31 11:04:10.896567 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2021-03-31 11:04:10.896766 (MainThread): On master: Close
2021-03-31 11:04:11.880329 (MainThread): 19:04:11 | Concurrency: 5 threads (target='dev')
2021-03-31 11:04:11.880543 (MainThread): 19:04:11 | 
2021-03-31 11:04:11.881670 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:04:11.883113 (Thread-1): 19:04:11 | 1 of 3 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 11:04:11.883257 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:04:11.883639 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:04:11.884765 (Thread-2): 19:04:11 | 2 of 3 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 11:04:11.884936 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 11:04:11.885320 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:04:11.891245 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:04:11.918635 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:04:11.921274 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:04:11.921771 (Thread-2): finished collecting timing info
2021-03-31 11:04:11.927343 (Thread-1): finished collecting timing info
2021-03-31 11:04:11.986185 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:04:11.988514 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:04:11.989649 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:04:11.989758 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 11:04:11.990543 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:04:11.990637 (Thread-2): Opening a new connection, currently in state init
2021-03-31 11:04:11.990740 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 11:04:11.991129 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 11:04:16.712669 (Thread-2): SQL status: SUCCESS 1 in 4.72 seconds
2021-03-31 11:04:16.712879 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:04:16.712988 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 11:04:16.783689 (Thread-1): SQL status: SUCCESS 1 in 4.79 seconds
2021-03-31 11:04:16.783868 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:04:16.783967 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

select *
from ...

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 11:04:17.204864 (Thread-1): Snowflake query id: 019b45b8-0474-b31c-0000-002da6833501
2021-03-31 11:04:17.205012 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 5 unexpected '.'.
syntax error line 25 at position 0 unexpected 'select'.
2021-03-31 11:04:17.205153 (Thread-1): finished collecting timing info
2021-03-31 11:04:17.205434 (Thread-1): On model.demo_dbt.my_first_dbt_model: ROLLBACK
2021-03-31 11:04:17.343853 (Thread-2): SQL status: SUCCESS 1 in 0.63 seconds
2021-03-31 11:04:17.348617 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:04:17.348840 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:04:17.348944 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:04:17.615410 (Thread-2): SQL status: SUCCESS 1 in 0.27 seconds
2021-03-31 11:04:17.616304 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 11:04:17.630113 (Thread-2): finished collecting timing info
2021-03-31 11:04:17.630930 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 11:04:18.597101 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c60ada0-2d30-4541-954f-5be76df92ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ca2e8>]}
2021-03-31 11:04:18.599395 (Thread-2): 19:04:18 | 2 of 3 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 6.71s]
2021-03-31 11:04:18.599565 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:04:18.597451 (Thread-1): Database Error in model my_first_dbt_model (models/staging/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 5 unexpected '.'.
  syntax error line 25 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/staging/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 15 at position 5 unexpected '.'.
syntax error line 25 at position 0 unexpected 'select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/staging/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 5 unexpected '.'.
  syntax error line 25 at position 0 unexpected 'select'.
  compiled SQL at target/run/demo_dbt/models/staging/example/my_first_dbt_model.sql
2021-03-31 11:04:18.614526 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c60ada0-2d30-4541-954f-5be76df92ab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b899f28>]}
2021-03-31 11:04:18.615913 (Thread-1): 19:04:18 | 1 of 3 ERROR creating table model staging.my_first_dbt_model......... [ERROR in 6.73s]
2021-03-31 11:04:18.616114 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:04:18.616512 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:04:18.616679 (Thread-4): 19:04:18 | 3 of 3 SKIP relation staging.my_second_dbt_model..................... [SKIP]
2021-03-31 11:04:18.616819 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:04:18.719597 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:04:18.719915 (MainThread): Using snowflake connection "master".
2021-03-31 11:04:18.720059 (MainThread): On master: BEGIN
2021-03-31 11:04:18.720160 (MainThread): Opening a new connection, currently in state closed
2021-03-31 11:04:21.441989 (MainThread): SQL status: SUCCESS 1 in 2.72 seconds
2021-03-31 11:04:21.442235 (MainThread): On master: COMMIT
2021-03-31 11:04:21.442606 (MainThread): Using snowflake connection "master".
2021-03-31 11:04:21.442732 (MainThread): On master: COMMIT
2021-03-31 11:04:21.941729 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-03-31 11:04:21.941983 (MainThread): On master: Close
2021-03-31 11:04:23.154461 (MainThread): 19:04:23 | 
2021-03-31 11:04:23.154647 (MainThread): 19:04:23 | Finished running 1 view model, 2 table models in 27.01s.
2021-03-31 11:04:23.154770 (MainThread): Connection 'master' was properly closed.
2021-03-31 11:04:23.154860 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 11:04:23.154944 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 11:04:23.155025 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 11:04:23.201071 (MainThread): 
2021-03-31 11:04:23.201248 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 11:04:23.201370 (MainThread): 
2021-03-31 11:04:23.201493 (MainThread): Database Error in model my_first_dbt_model (models/staging/example/my_first_dbt_model.sql)
2021-03-31 11:04:23.201599 (MainThread):   001003 (42000): SQL compilation error:
2021-03-31 11:04:23.201695 (MainThread):   syntax error line 15 at position 5 unexpected '.'.
2021-03-31 11:04:23.201788 (MainThread):   syntax error line 25 at position 0 unexpected 'select'.
2021-03-31 11:04:23.201883 (MainThread):   compiled SQL at target/run/demo_dbt/models/staging/example/my_first_dbt_model.sql
2021-03-31 11:04:23.201988 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-03-31 11:04:23.202155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b899f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802a7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d6f60>]}
2021-03-31 11:04:23.202358 (MainThread): Flushing usage events
2021-03-31 11:04:31.299466 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-03-31 11:04:31.299659 (MainThread): Error sending message, disabling tracking
2021-03-31 11:05:28.935318 (MainThread): Running with dbt=0.19.0
2021-03-31 11:05:29.433429 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 11:05:29.434428 (MainThread): Tracking: tracking
2021-03-31 11:05:29.434828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133755f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133751d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133754e0>]}
2021-03-31 11:05:29.464735 (MainThread): Partial parsing not enabled
2021-03-31 11:05:29.465858 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 11:05:29.468057 (MainThread): Parsing macros/catalog.sql
2021-03-31 11:05:29.470974 (MainThread): Parsing macros/adapters.sql
2021-03-31 11:05:29.524940 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 11:05:29.528256 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 11:05:29.530830 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 11:05:29.536573 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 11:05:29.551420 (MainThread): Parsing macros/core.sql
2021-03-31 11:05:29.556482 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 11:05:29.568914 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 11:05:29.571230 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 11:05:29.596758 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 11:05:29.639358 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 11:05:29.667313 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 11:05:29.669812 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 11:05:29.677976 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 11:05:29.696610 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 11:05:29.705359 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 11:05:29.713680 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 11:05:29.719797 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 11:05:29.720961 (MainThread): Parsing macros/etc/query.sql
2021-03-31 11:05:29.722279 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 11:05:29.724285 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 11:05:29.735869 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 11:05:29.738330 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 11:05:29.740545 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 11:05:29.795503 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 11:05:29.797904 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 11:05:29.799852 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 11:05:29.802011 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 11:05:29.812240 (MainThread): Partial parsing not enabled
2021-03-31 11:05:29.860895 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:05:29.890175 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:29.906730 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:05:30.204383 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5981078e-1c4d-49a4-a424-f89d21cfc86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3fa58>]}
2021-03-31 11:05:30.248478 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 11:05:30.249287 (MainThread): 
2021-03-31 11:05:30.249596 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:05:30.253649 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 11:05:30.269562 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 11:05:30.269714 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 11:05:30.269811 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 11:05:33.847485 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.58 seconds
2021-03-31 11:05:33.851934 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 11:05:34.924355 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:05:34.924840 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:05:34.933751 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 11:05:34.936111 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 11:05:34.936257 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 11:05:34.936406 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 11:05:34.936549 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 11:05:34.936669 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 11:05:38.167771 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 3.23 seconds
2021-03-31 11:05:38.172147 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 11:05:38.222729 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 3.29 seconds
2021-03-31 11:05:38.227140 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 11:05:39.104528 (MainThread): Using snowflake connection "master".
2021-03-31 11:05:39.104689 (MainThread): On master: BEGIN
2021-03-31 11:05:39.104793 (MainThread): Opening a new connection, currently in state init
2021-03-31 11:05:42.300319 (MainThread): SQL status: SUCCESS 1 in 3.20 seconds
2021-03-31 11:05:42.300508 (MainThread): On master: COMMIT
2021-03-31 11:05:42.300672 (MainThread): Using snowflake connection "master".
2021-03-31 11:05:42.300776 (MainThread): On master: COMMIT
2021-03-31 11:05:42.872254 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-03-31 11:05:42.872419 (MainThread): On master: Close
2021-03-31 11:05:44.174443 (MainThread): 19:05:44 | Concurrency: 5 threads (target='dev')
2021-03-31 11:05:44.174653 (MainThread): 19:05:44 | 
2021-03-31 11:05:44.175747 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:05:44.175930 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:05:44.177234 (Thread-1): 19:05:44 | 1 of 3 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 11:05:44.178492 (Thread-2): 19:05:44 | 2 of 3 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 11:05:44.178893 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:05:44.179267 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:05:44.179449 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 11:05:44.179592 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:05:44.213948 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:05:44.216706 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:05:44.217303 (Thread-2): finished collecting timing info
2021-03-31 11:05:44.223888 (Thread-1): finished collecting timing info
2021-03-31 11:05:44.257703 (Thread-2): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 11:05:44.267540 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 11:05:44.268421 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:05:44.268567 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 11:05:44.269187 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:05:44.269261 (Thread-2): Opening a new connection, currently in state init
2021-03-31 11:05:44.269347 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 11:05:44.270476 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 11:05:46.794726 (Thread-2): SQL status: SUCCESS 1 in 2.53 seconds
2021-03-31 11:05:46.794964 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:05:46.795103 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 11:05:46.805287 (Thread-1): SQL status: SUCCESS 1 in 2.53 seconds
2021-03-31 11:05:46.805426 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:05:46.805525 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 11:05:47.577795 (Thread-2): SQL status: SUCCESS 1 in 0.78 seconds
2021-03-31 11:05:47.582692 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:05:47.582897 (Thread-2): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 11:05:47.582999 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 11:05:48.280072 (Thread-2): SQL status: SUCCESS 1 in 0.70 seconds
2021-03-31 11:05:48.292545 (Thread-2): finished collecting timing info
2021-03-31 11:05:48.292862 (Thread-2): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 11:05:48.344409 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-03-31 11:05:48.348636 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 11:05:48.348841 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 11:05:48.348946 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 11:05:48.752758 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-03-31 11:05:48.759515 (Thread-1): finished collecting timing info
2021-03-31 11:05:48.759939 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 11:05:48.929103 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5981078e-1c4d-49a4-a424-f89d21cfc86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11568fef0>]}
2021-03-31 11:05:48.930454 (Thread-2): 19:05:48 | 2 of 3 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 4.75s]
2021-03-31 11:05:48.930626 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 11:05:49.383269 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5981078e-1c4d-49a4-a424-f89d21cfc86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115584ac8>]}
2021-03-31 11:05:49.384851 (Thread-1): 19:05:49 | 1 of 3 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 5.20s]
2021-03-31 11:05:49.385123 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 11:05:49.385850 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:05:49.387265 (Thread-4): 19:05:49 | 3 of 3 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 11:05:49.387683 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:49.387823 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 11:05:49.398262 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 11:05:49.398957 (Thread-4): finished collecting timing info
2021-03-31 11:05:49.408825 (Thread-4): Dropping relation "DEMO_DB"."STAGING"."MY_SECOND_DBT_MODEL" because it is of type view
2021-03-31 11:05:49.418106 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:49.418268 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "DEMO_DB"."STAGING"."MY_SECOND_DBT_MODEL" cascade
2021-03-31 11:05:49.418381 (Thread-4): Opening a new connection, currently in state init
2021-03-31 11:05:53.036518 (Thread-4): SQL status: SUCCESS 1 in 3.62 seconds
2021-03-31 11:05:53.041589 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 11:05:53.042616 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:53.042742 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 11:05:53.826341 (Thread-4): SQL status: SUCCESS 1 in 0.78 seconds
2021-03-31 11:05:53.826571 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:53.826695 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 11:05:55.729783 (Thread-4): SQL status: SUCCESS 1 in 1.90 seconds
2021-03-31 11:05:55.734383 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 11:05:55.734569 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 11:05:55.734669 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 11:05:56.201869 (Thread-4): SQL status: SUCCESS 1 in 0.47 seconds
2021-03-31 11:05:56.204859 (Thread-4): finished collecting timing info
2021-03-31 11:05:56.205183 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 11:05:57.237820 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5981078e-1c4d-49a4-a424-f89d21cfc86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11567f6d8>]}
2021-03-31 11:05:57.239166 (Thread-4): 19:05:57 | 3 of 3 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 7.85s]
2021-03-31 11:05:57.239335 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 11:05:57.286458 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 11:05:57.286790 (MainThread): Using snowflake connection "master".
2021-03-31 11:05:57.286920 (MainThread): On master: BEGIN
2021-03-31 11:05:57.287039 (MainThread): Opening a new connection, currently in state closed
2021-03-31 11:06:00.735292 (MainThread): SQL status: SUCCESS 1 in 3.45 seconds
2021-03-31 11:06:00.735570 (MainThread): On master: COMMIT
2021-03-31 11:06:00.735819 (MainThread): Using snowflake connection "master".
2021-03-31 11:06:00.735965 (MainThread): On master: COMMIT
2021-03-31 11:06:01.058987 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 11:06:01.059286 (MainThread): On master: Close
2021-03-31 11:06:02.078248 (MainThread): 19:06:02 | 
2021-03-31 11:06:02.078442 (MainThread): 19:06:02 | Finished running 1 view model, 2 table models in 31.83s.
2021-03-31 11:06:02.078571 (MainThread): Connection 'master' was properly closed.
2021-03-31 11:06:02.078664 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 11:06:02.078750 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 11:06:02.078835 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 11:06:02.078916 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 11:06:02.124792 (MainThread): 
2021-03-31 11:06:02.124959 (MainThread): Completed successfully
2021-03-31 11:06:02.125077 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-31 11:06:02.125248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a9a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e48a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115586be0>]}
2021-03-31 11:06:02.125449 (MainThread): Flushing usage events
2021-03-31 11:06:10.060260 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-03-31 11:06:10.060583 (MainThread): Error sending message, disabling tracking
2021-03-31 11:10:30.807809 (MainThread): Running with dbt=0.19.0
2021-03-31 11:10:31.343192 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-03-31 11:10:31.343659 (MainThread): Tracking: tracking
2021-03-31 11:10:31.343839 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e438>]}
2021-03-31 11:10:31.345631 (MainThread): Set downloads directory='/var/folders/ry/5dkjcfvj6v72yqn9h7t4hbw40000gp/T/dbt-downloads-ervj9q9b'
2021-03-31 11:10:31.346524 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-03-31 11:10:33.717678 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-03-31 11:10:33.717993 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-03-31 11:10:35.204886 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-03-31 11:10:35.221337 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.4.json
2021-03-31 11:10:37.639151 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.4.json 200
2021-03-31 11:10:37.644859 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-03-31 11:10:39.329510 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-03-31 11:10:39.345435 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.4.json
2021-03-31 11:10:40.276970 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.6.4.json 200
2021-03-31 11:10:40.278200 (MainThread): Installing fishtown-analytics/dbt_utils@0.6.4
2021-03-31 11:10:42.472838 (MainThread):   Installed from version 0.6.4

2021-03-31 11:10:42.473124 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '398ad60e-b4c8-4528-b95c-e314c4cada28', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114410b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115cacf8>]}
2021-03-31 11:10:42.473948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146e438>]}
2021-03-31 11:10:42.474116 (MainThread): Flushing usage events
2021-03-31 12:30:50.737769 (MainThread): Running with dbt=0.19.0
2021-03-31 12:30:51.532683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-03-31 12:30:51.534343 (MainThread): Tracking: tracking
2021-03-31 12:30:51.534750 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b661780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d315908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee56668>]}
2021-03-31 12:30:51.578503 (MainThread): Partial parsing not enabled
2021-03-31 12:30:51.580150 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:30:51.582640 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:30:51.585636 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:30:51.624390 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:30:51.627125 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:30:51.629166 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:30:51.634621 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:30:51.648567 (MainThread): Parsing macros/core.sql
2021-03-31 12:30:51.653960 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:30:51.665430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:30:51.667917 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:30:51.689882 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:30:51.725364 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:30:51.747965 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:30:51.750136 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:30:51.756695 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:30:51.771745 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:30:51.779334 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:30:51.786655 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:30:51.792501 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:30:51.793746 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:30:51.795084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:30:51.797170 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:30:51.807861 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:30:51.810620 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:30:51.813296 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:30:51.867035 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:30:51.869635 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:30:51.871794 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:30:51.874000 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:30:51.879299 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:30:51.881252 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:30:51.883463 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:30:51.886795 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:30:51.895638 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:30:51.897477 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:30:51.900113 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:30:51.903558 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:30:51.905202 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:30:51.908391 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:30:51.921249 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:30:51.924011 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:30:51.926153 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:30:51.928705 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:30:51.931279 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:30:51.932972 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:30:51.937573 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:30:51.944484 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:30:51.945748 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:30:51.949726 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:30:51.952482 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:30:51.954703 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:30:51.957672 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:30:51.989571 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:30:51.991435 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:30:51.993244 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:30:51.994878 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:30:52.001964 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:30:52.004909 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:30:52.008605 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:30:52.011289 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:30:52.013919 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:30:52.016913 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:30:52.020656 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:30:52.023314 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:30:52.025518 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:30:52.028495 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:30:52.030860 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:30:52.035512 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:30:52.038695 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:30:52.041120 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:30:52.043950 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:30:52.049406 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:30:52.058203 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:30:52.060770 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:30:52.066166 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:30:52.072265 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:30:52.077002 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:30:52.079633 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:30:52.085006 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:30:52.094783 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:30:52.106313 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:30:52.108373 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:30:52.113358 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:30:52.116183 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:30:52.118773 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:30:52.127226 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:30:52.133876 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:30:52.139320 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:30:52.149396 (MainThread): Partial parsing not enabled
2021-03-31 12:30:52.206426 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:30:52.274397 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:30:52.293028 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:30:52.652539 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31fe3932-def6-44dd-a286-98a580f29d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f487320>]}
2021-03-31 12:30:52.713820 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 12:30:52.714958 (MainThread): 
2021-03-31 12:30:52.715305 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:30:52.724246 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:30:52.724646 (ThreadPoolExecutor-0_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:30:52.746835 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:30:52.747871 (ThreadPoolExecutor-0_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:30:52.747966 (ThreadPoolExecutor-0_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:30:52.748083 (ThreadPoolExecutor-0_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:30:52.748210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:30:52.748318 (ThreadPoolExecutor-0_1): Opening a new connection, currently in state init
2021-03-31 12:30:55.132724 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.38 seconds
2021-03-31 12:30:55.140036 (ThreadPoolExecutor-0_0): On list_DEMO_DB_staging: Close
2021-03-31 12:30:55.142362 (ThreadPoolExecutor-0_1): SQL status: SUCCESS 3 in 2.39 seconds
2021-03-31 12:30:55.145764 (ThreadPoolExecutor-0_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:30:55.594516 (MainThread): 20:30:55 | Concurrency: 5 threads (target='dev')
2021-03-31 12:30:55.594760 (MainThread): 20:30:55 | 
2021-03-31 12:30:55.596353 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:30:55.596593 (Thread-2): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:30:55.596994 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:30:55.597384 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:30:55.597661 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 12:30:55.597807 (Thread-2): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:30:55.627612 (Thread-2): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:30:55.630173 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:30:55.630861 (Thread-2): finished collecting timing info
2021-03-31 12:30:55.631262 (Thread-1): finished collecting timing info
2021-03-31 12:30:55.631556 (Thread-2): finished collecting timing info
2021-03-31 12:30:55.631838 (Thread-1): finished collecting timing info
2021-03-31 12:30:55.632344 (Thread-2): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:30:55.632653 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:30:55.633302 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:30:55.633643 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:30:55.633775 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 12:30:55.640223 (Thread-5): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 12:30:55.640559 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 12:30:55.640693 (Thread-5): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 12:30:55.649048 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:30:55.655637 (Thread-3): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 12:30:55.661588 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 12:30:55.661748 (Thread-3): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 12:30:55.667398 (Thread-5): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 12:30:55.670777 (Thread-3): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 12:30:55.671203 (Thread-4): finished collecting timing info
2021-03-31 12:30:55.671494 (Thread-4): finished collecting timing info
2021-03-31 12:30:55.671899 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:30:55.672232 (Thread-1): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 12:30:55.672513 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 12:30:55.672634 (Thread-1): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 12:30:55.681045 (Thread-1): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 12:30:55.681209 (Thread-2): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 12:30:55.681990 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 12:30:55.682122 (Thread-2): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 12:30:55.688086 (Thread-5): finished collecting timing info
2021-03-31 12:30:55.688340 (Thread-5): finished collecting timing info
2021-03-31 12:30:55.688713 (Thread-5): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 12:30:55.688929 (Thread-3): finished collecting timing info
2021-03-31 12:30:55.689190 (Thread-3): finished collecting timing info
2021-03-31 12:30:55.689556 (Thread-3): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 12:30:55.689757 (Thread-1): finished collecting timing info
2021-03-31 12:30:55.690011 (Thread-1): finished collecting timing info
2021-03-31 12:30:55.690374 (Thread-1): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 12:30:55.692859 (Thread-2): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 12:30:55.693253 (Thread-2): finished collecting timing info
2021-03-31 12:30:55.693508 (Thread-2): finished collecting timing info
2021-03-31 12:30:55.693868 (Thread-2): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 12:30:55.696487 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:30:55.696621 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 12:30:55.696708 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 12:30:55.696786 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 12:30:55.696861 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 12:30:55.696934 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 12:30:55.757736 (MainThread): 20:30:55 | Done.
2021-03-31 12:30:55.763863 (MainThread): Acquiring new snowflake connection "generate_catalog".
2021-03-31 12:30:55.764022 (MainThread): 20:30:55 | Building catalog
2021-03-31 12:30:55.790849 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "DEMO_DB.information_schema".
2021-03-31 12:30:55.797130 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema".
2021-03-31 12:30:55.800313 (ThreadPoolExecutor-1_0): Using snowflake connection "DEMO_DB.information_schema".
2021-03-31 12:30:55.804319 (ThreadPoolExecutor-1_1): Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema".
2021-03-31 12:30:55.804454 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "DEMO_DB.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from DEMO_DB.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from DEMO_DB.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('staging') or upper("table_schema") = upper('public'))
      order by "column_index"
2021-03-31 12:30:55.804561 (ThreadPoolExecutor-1_1): On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('tpcds_sf10tcl'))
      order by "column_index"
2021-03-31 12:30:55.804668 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 12:30:55.804758 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:31:00.435623 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 50 in 4.63 seconds
2021-03-31 12:31:00.457819 (ThreadPoolExecutor-1_0): On DEMO_DB.information_schema: Close
2021-03-31 12:31:00.573786 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 429 in 4.77 seconds
2021-03-31 12:31:01.939717 (ThreadPoolExecutor-1_1): On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
2021-03-31 12:31:02.650830 (MainThread): 20:31:02 | Catalog written to /Users/chi.zhang/Documents/demo_dbt/target/catalog.json
2021-03-31 12:31:02.651431 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee98ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee98c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee98dd8>]}
2021-03-31 12:31:02.651609 (MainThread): Flushing usage events
2021-03-31 12:31:04.543127 (MainThread): Connection 'generate_catalog' was properly closed.
2021-03-31 12:31:04.543331 (MainThread): Connection 'DEMO_DB.information_schema' was properly closed.
2021-03-31 12:31:04.543459 (MainThread): Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.
2021-03-31 12:32:07.129916 (MainThread): Running with dbt=0.19.0
2021-03-31 12:32:07.608804 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-03-31 12:32:07.609818 (MainThread): Tracking: tracking
2021-03-31 12:32:07.610096 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d79a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11526b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11526b828>]}
2021-03-31 12:32:07.611885 (MainThread): Serving docs at 0.0.0.0:8080
2021-03-31 12:32:07.612027 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-03-31 12:32:07.612120 (MainThread): Press Ctrl+C to exit.


2021-03-31 12:36:17.103359 (MainThread): Flushing usage events
2021-03-31 12:36:19.242361 (MainThread): ctrl-c
2021-03-31 12:40:22.741138 (MainThread): Running with dbt=0.19.0
2021-03-31 12:40:23.447902 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-03-31 12:40:23.449063 (MainThread): Tracking: tracking
2021-03-31 12:40:23.449553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a49e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6a128>]}
2021-03-31 12:40:23.485612 (MainThread): Partial parsing not enabled
2021-03-31 12:40:23.487258 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:40:23.489246 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:40:23.491594 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:40:23.522201 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:40:23.524383 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:40:23.526050 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:40:23.530168 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:40:23.542203 (MainThread): Parsing macros/core.sql
2021-03-31 12:40:23.547030 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:40:23.557979 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:40:23.559976 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:40:23.578908 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:40:23.612365 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:40:23.635672 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:40:23.638085 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:40:23.644765 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:40:23.661432 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:40:23.669197 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:40:23.675911 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:40:23.681807 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:40:23.683070 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:40:23.684330 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:40:23.686351 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:40:23.695668 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:40:23.697985 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:40:23.700371 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:40:23.746645 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:40:23.748938 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:40:23.750752 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:40:23.752712 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:40:23.757577 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:40:23.759936 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:40:23.761782 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:40:23.764829 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:40:23.772752 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:40:23.774235 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:40:23.776220 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:40:23.778973 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:40:23.780423 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:40:23.783134 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:40:23.793752 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:40:23.796032 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:40:23.797907 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:40:23.799994 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:40:23.801927 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:40:23.803247 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:40:23.807045 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:40:23.812929 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:40:23.813991 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:40:23.817214 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:40:23.819466 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:40:23.821325 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:40:23.823857 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:40:23.851089 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:40:23.852560 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:40:23.854088 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:40:23.855650 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:40:23.861106 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:40:23.863759 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:40:23.866949 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:40:23.869095 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:40:23.871048 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:40:23.873416 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:40:23.876388 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:40:23.878697 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:40:23.880730 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:40:23.883158 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:40:23.885272 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:40:23.888901 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:40:23.891469 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:40:23.893449 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:40:23.895854 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:40:23.900171 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:40:23.907303 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:40:23.909290 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:40:23.913244 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:40:23.918052 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:40:23.921991 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:40:23.924045 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:40:23.928296 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:40:23.936393 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:40:23.945360 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:40:23.947289 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:40:23.951321 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:40:23.953354 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:40:23.955387 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:40:23.962272 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:40:23.967612 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:40:23.972093 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:40:23.980520 (MainThread): Partial parsing not enabled
2021-03-31 12:40:24.026044 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:40:24.088531 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:40:24.106646 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:40:24.471494 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '203fceab-8e9c-459c-9f84-90e69d23615a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b0a630>]}
2021-03-31 12:40:24.548298 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:40:24.549360 (MainThread): 
2021-03-31 12:40:24.549889 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:40:24.551565 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:40:24.567845 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:40:24.568009 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:40:24.568111 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:40:27.216958 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.65 seconds
2021-03-31 12:40:27.222147 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 12:40:27.730516 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:40:27.730995 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:40:27.782457 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:40:27.785567 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:40:27.785766 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:40:27.785911 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:40:27.786069 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 12:40:27.786212 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:40:29.762209 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 1.98 seconds
2021-03-31 12:40:29.766600 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:40:29.768377 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 1.98 seconds
2021-03-31 12:40:29.771977 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 12:40:30.233817 (MainThread): Using snowflake connection "master".
2021-03-31 12:40:30.233978 (MainThread): On master: BEGIN
2021-03-31 12:40:30.234084 (MainThread): Opening a new connection, currently in state init
2021-03-31 12:40:32.246624 (MainThread): SQL status: SUCCESS 1 in 2.01 seconds
2021-03-31 12:40:32.246919 (MainThread): On master: COMMIT
2021-03-31 12:40:32.247218 (MainThread): Using snowflake connection "master".
2021-03-31 12:40:32.247346 (MainThread): On master: COMMIT
2021-03-31 12:40:32.594574 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 12:40:32.594801 (MainThread): On master: Close
2021-03-31 12:40:33.050439 (MainThread): 20:40:33 | Concurrency: 5 threads (target='dev')
2021-03-31 12:40:33.050665 (MainThread): 20:40:33 | 
2021-03-31 12:40:33.052114 (Thread-1): Began running node seed.demo_dbt.team_location
2021-03-31 12:40:33.053481 (Thread-1): 20:40:33 | 1 of 1 START seed file PUBLIC.team_location.......................... [RUN]
2021-03-31 12:40:33.053869 (Thread-1): Acquiring new snowflake connection "seed.demo_dbt.team_location".
2021-03-31 12:40:33.054017 (Thread-1): finished collecting timing info
2021-03-31 12:40:33.099156 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-03-31 12:40:33.099399 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '203fceab-8e9c-459c-9f84-90e69d23615a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8c6a0>]}
2021-03-31 12:40:33.100356 (Thread-1): Using snowflake connection "seed.demo_dbt.team_location".
2021-03-31 12:40:33.100501 (Thread-1): On seed.demo_dbt.team_location: BEGIN
2021-03-31 12:40:33.100609 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 12:40:34.640113 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-03-31 12:40:34.640303 (Thread-1): Using snowflake connection "seed.demo_dbt.team_location".
2021-03-31 12:40:34.640411 (Thread-1): On seed.demo_dbt.team_location: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "seed.demo_dbt.team_location"} */

    create table DEMO_DB.PUBLIC.team_location (name text, city text, state text)
2021-03-31 12:40:35.053125 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-03-31 12:40:35.075845 (Thread-1): Using snowflake connection "seed.demo_dbt.team_location".
2021-03-31 12:40:35.076016 (Thread-1): On seed.demo_dbt.team_location: insert into DEMO_DB.PUBLIC.team_location (name,  city,  state) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
2021-03-31 12:40:36.015350 (Thread-1): SQL status: SUCCESS 4 in 0.94 seconds
2021-03-31 12:40:36.021864 (Thread-1): Writing runtime SQL for node "seed.demo_dbt.team_location"
2021-03-31 12:40:36.037718 (Thread-1): On seed.demo_dbt.team_location: COMMIT
2021-03-31 12:40:36.037960 (Thread-1): Using snowflake connection "seed.demo_dbt.team_location".
2021-03-31 12:40:36.038068 (Thread-1): On seed.demo_dbt.team_location: COMMIT
2021-03-31 12:40:36.459383 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-03-31 12:40:36.462285 (Thread-1): finished collecting timing info
2021-03-31 12:40:36.462608 (Thread-1): On seed.demo_dbt.team_location: Close
2021-03-31 12:40:36.946784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '203fceab-8e9c-459c-9f84-90e69d23615a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089c4e0>]}
2021-03-31 12:40:36.947153 (Thread-1): 20:40:36 | 1 of 1 OK loaded seed file PUBLIC.team_location...................... [INSERT 4 in 3.89s]
2021-03-31 12:40:36.947336 (Thread-1): Finished running node seed.demo_dbt.team_location
2021-03-31 12:40:36.951258 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:40:36.951561 (MainThread): Using snowflake connection "master".
2021-03-31 12:40:36.951688 (MainThread): On master: BEGIN
2021-03-31 12:40:36.951807 (MainThread): Opening a new connection, currently in state closed
2021-03-31 12:40:38.767383 (MainThread): SQL status: SUCCESS 1 in 1.82 seconds
2021-03-31 12:40:38.767806 (MainThread): On master: COMMIT
2021-03-31 12:40:38.768012 (MainThread): Using snowflake connection "master".
2021-03-31 12:40:38.768119 (MainThread): On master: COMMIT
2021-03-31 12:40:39.086189 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 12:40:39.086435 (MainThread): On master: Close
2021-03-31 12:40:39.563380 (MainThread): 20:40:39 | 
2021-03-31 12:40:39.563611 (MainThread): 20:40:39 | Finished running 1 seed in 15.01s.
2021-03-31 12:40:39.563761 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:40:39.563868 (MainThread): Connection 'seed.demo_dbt.team_location' was properly closed.
2021-03-31 12:40:39.563973 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 12:40:39.640323 (MainThread): 
2021-03-31 12:40:39.640538 (MainThread): Completed successfully
2021-03-31 12:40:39.640737 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-03-31 12:40:39.641024 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8fe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11301bd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110848550>]}
2021-03-31 12:40:39.641356 (MainThread): Flushing usage events
2021-03-31 12:47:14.956387 (MainThread): Running with dbt=0.19.0
2021-03-31 12:47:15.750724 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:47:15.753255 (MainThread): Tracking: tracking
2021-03-31 12:47:15.754177 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad3898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117a518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117a160>]}
2021-03-31 12:47:15.803396 (MainThread): Partial parsing not enabled
2021-03-31 12:47:15.804975 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:47:15.807694 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:47:15.810719 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:47:15.849546 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:47:15.852558 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:47:15.855246 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:47:15.860694 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:47:15.875337 (MainThread): Parsing macros/core.sql
2021-03-31 12:47:15.880940 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:47:15.893248 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:47:15.895706 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:47:15.919452 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:47:15.958116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:47:15.980445 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:47:15.982547 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:47:15.989806 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:47:16.005855 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:47:16.013494 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:47:16.020556 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:47:16.026424 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:47:16.027713 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:47:16.029146 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:47:16.031258 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:47:16.041958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:47:16.044540 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:47:16.046976 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:47:16.093692 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:47:16.095819 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:47:16.097559 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:47:16.099446 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:47:16.104861 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:47:16.106821 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:47:16.108656 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:47:16.112043 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:47:16.123322 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:47:16.125158 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:47:16.127700 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:47:16.131193 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:47:16.132910 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:47:16.136905 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:47:16.149828 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:47:16.153089 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:47:16.155519 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:47:16.158142 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:47:16.160577 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:47:16.162122 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:47:16.166624 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:47:16.174203 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:47:16.175557 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:47:16.179299 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:47:16.182001 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:47:16.184305 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:47:16.187709 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:47:16.221500 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:47:16.223559 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:47:16.225545 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:47:16.227339 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:47:16.234016 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:47:16.237191 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:47:16.241116 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:47:16.243456 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:47:16.245964 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:47:16.248637 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:47:16.252221 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:47:16.255303 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:47:16.257672 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:47:16.260583 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:47:16.262831 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:47:16.266815 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:47:16.269732 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:47:16.272329 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:47:16.275030 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:47:16.280022 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:47:16.287761 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:47:16.290038 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:47:16.294264 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:47:16.299302 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:47:16.303463 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:47:16.305879 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:47:16.310122 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:47:16.318931 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:47:16.329419 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:47:16.331544 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:47:16.336135 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:47:16.338365 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:47:16.340454 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:47:16.347683 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:47:16.353396 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:47:16.358074 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:47:16.366260 (MainThread): Partial parsing not enabled
2021-03-31 12:47:16.412791 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:47:16.476547 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:47:16.494690 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:47:16.514211 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:47:16.850059 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '960f18c2-5e19-41cb-8cae-49efc911cedf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a9710>]}
2021-03-31 12:47:16.926070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111591c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f6c88>]}
2021-03-31 12:47:16.926357 (MainThread): Flushing usage events
2021-03-31 12:47:18.466189 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 12:47:18.466391 (MainThread): Encountered an error:
2021-03-31 12:47:18.466520 (MainThread): Found a cycle: model.demo_dbt.example_teams
2021-03-31 12:47:18.471578 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 80, in _runtime_initialize
    self.compile_manifest()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 76, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "/Library/Python/3.7/site-packages/dbt/compilation.py", line 465, in compile
    self.link_graph(linker, manifest)
  File "/Library/Python/3.7/site-packages/dbt/compilation.py", line 459, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.demo_dbt.example_teams

2021-03-31 12:50:57.565784 (MainThread): Running with dbt=0.19.0
2021-03-31 12:50:58.200842 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['example_team_details'], partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:50:58.202294 (MainThread): Tracking: tracking
2021-03-31 12:50:58.202790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df440b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df44e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df44cc0>]}
2021-03-31 12:50:58.240192 (MainThread): Partial parsing not enabled
2021-03-31 12:50:58.241395 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:50:58.243280 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:50:58.245947 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:50:58.276500 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:50:58.278723 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:50:58.280412 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:50:58.284592 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:50:58.295800 (MainThread): Parsing macros/core.sql
2021-03-31 12:50:58.300264 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:50:58.309440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:50:58.311428 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:50:58.330726 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:50:58.369462 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:50:58.390929 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:50:58.392993 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:50:58.399940 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:50:58.414398 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:50:58.421510 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:50:58.428082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:50:58.433355 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:50:58.434481 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:50:58.435719 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:50:58.437521 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:50:58.446713 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:50:58.448857 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:50:58.450937 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:50:58.493722 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:50:58.496028 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:50:58.497795 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:50:58.499629 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:50:58.504118 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:50:58.505883 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:50:58.507737 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:50:58.510468 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:50:58.517202 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:50:58.518626 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:50:58.520632 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:50:58.523365 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:50:58.524865 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:50:58.527478 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:50:58.537446 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:50:58.539652 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:50:58.541514 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:50:58.543493 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:50:58.545438 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:50:58.546723 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:50:58.550532 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:50:58.556440 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:50:58.557550 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:50:58.560597 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:50:58.562775 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:50:58.564656 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:50:58.567145 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:50:58.593678 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:50:58.595199 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:50:58.596758 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:50:58.598337 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:50:58.603632 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:50:58.606081 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:50:58.609273 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:50:58.611268 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:50:58.613105 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:50:58.615368 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:50:58.618386 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:50:58.620503 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:50:58.622633 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:50:58.625124 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:50:58.627173 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:50:58.631074 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:50:58.633944 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:50:58.636046 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:50:58.638387 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:50:58.642535 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:50:58.649426 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:50:58.651352 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:50:58.655196 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:50:58.660011 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:50:58.663856 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:50:58.665892 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:50:58.669730 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:50:58.677623 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:50:58.686578 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:50:58.688440 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:50:58.692345 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:50:58.694310 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:50:58.696317 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:50:58.703147 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:50:58.708201 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:50:58.712743 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:50:58.721231 (MainThread): Partial parsing not enabled
2021-03-31 12:50:58.764926 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:50:58.828269 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:50:58.847013 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:50:58.862785 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:50:58.875908 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:50:59.170154 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b9574d-57de-4ea9-8b92-ff71a20b2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e83a4e0>]}
2021-03-31 12:50:59.235360 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:50:59.236281 (MainThread): 
2021-03-31 12:50:59.236614 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:50:59.238117 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:50:59.253420 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:50:59.253565 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:50:59.253661 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:51:02.772544 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.52 seconds
2021-03-31 12:51:02.776886 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 12:51:03.275481 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:51:03.281200 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:51:03.285136 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:51:03.287904 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:51:03.288146 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:51:03.288287 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:51:03.288468 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 12:51:03.288606 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:51:05.298139 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 2.01 seconds
2021-03-31 12:51:05.303112 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:51:05.304470 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.02 seconds
2021-03-31 12:51:05.308969 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 12:51:05.785302 (MainThread): Using snowflake connection "master".
2021-03-31 12:51:05.785468 (MainThread): On master: BEGIN
2021-03-31 12:51:05.785579 (MainThread): Opening a new connection, currently in state init
2021-03-31 12:51:07.867143 (MainThread): SQL status: SUCCESS 1 in 2.08 seconds
2021-03-31 12:51:07.867561 (MainThread): On master: COMMIT
2021-03-31 12:51:07.867781 (MainThread): Using snowflake connection "master".
2021-03-31 12:51:07.867889 (MainThread): On master: COMMIT
2021-03-31 12:51:08.509737 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2021-03-31 12:51:08.509979 (MainThread): On master: Close
2021-03-31 12:51:09.399847 (MainThread): 20:51:09 | Concurrency: 5 threads (target='dev')
2021-03-31 12:51:09.400098 (MainThread): 20:51:09 | 
2021-03-31 12:51:09.401762 (Thread-1): Began running node model.demo_dbt.example_team_details
2021-03-31 12:51:09.403400 (Thread-1): 20:51:09 | 1 of 1 START table model staging.example_team_details................ [RUN]
2021-03-31 12:51:09.403776 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:51:09.403919 (Thread-1): Compiling model.demo_dbt.example_team_details
2021-03-31 12:51:09.425690 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:51:09.426245 (Thread-1): finished collecting timing info
2021-03-31 12:51:09.465993 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:51:09.467635 (Thread-1): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:51:09.467785 (Thread-1): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 12:51:09.467919 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 12:51:11.039754 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-03-31 12:51:11.039956 (Thread-1): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:51:11.040073 (Thread-1): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (WITH team as (
    select * from DEMO_DB.staging.example_teams
),

team_location AS (
    select * from DEMO_DB.PUBLIC.team_location        
), 

final AS (
    SELECT 
        teams.team,
        team_location.city,
        team_location.state
    from teams
    LEFT JOIN team_location
    ON teams.team = team_location.name
)

SELECT * FROM final
      );
2021-03-31 12:51:11.319479 (Thread-1): Snowflake query id: 019b4623-044c-c813-0000-002da6833565
2021-03-31 12:51:11.319697 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.STAGING.EXAMPLE_TEAMS' does not exist or not authorized.
2021-03-31 12:51:11.319916 (Thread-1): finished collecting timing info
2021-03-31 12:51:11.320358 (Thread-1): On model.demo_dbt.example_team_details: ROLLBACK
2021-03-31 12:51:11.646115 (Thread-1): On model.demo_dbt.example_team_details: Close
2021-03-31 12:51:12.129129 (Thread-1): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.STAGING.EXAMPLE_TEAMS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DEMO_DB.STAGING.EXAMPLE_TEAMS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEMO_DB.STAGING.EXAMPLE_TEAMS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:51:12.144200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b9574d-57de-4ea9-8b92-ff71a20b2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead54a8>]}
2021-03-31 12:51:12.145542 (Thread-1): 20:51:12 | 1 of 1 ERROR creating table model staging.example_team_details....... [ERROR in 2.74s]
2021-03-31 12:51:12.145698 (Thread-1): Finished running node model.demo_dbt.example_team_details
2021-03-31 12:51:12.249133 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:51:12.249521 (MainThread): Using snowflake connection "master".
2021-03-31 12:51:12.249686 (MainThread): On master: BEGIN
2021-03-31 12:51:12.249831 (MainThread): Opening a new connection, currently in state closed
2021-03-31 12:51:14.650114 (MainThread): SQL status: SUCCESS 1 in 2.40 seconds
2021-03-31 12:51:14.650271 (MainThread): On master: COMMIT
2021-03-31 12:51:14.650396 (MainThread): Using snowflake connection "master".
2021-03-31 12:51:14.650465 (MainThread): On master: COMMIT
2021-03-31 12:51:14.969024 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 12:51:14.969316 (MainThread): On master: Close
2021-03-31 12:51:15.404178 (MainThread): 20:51:15 | 
2021-03-31 12:51:15.404370 (MainThread): 20:51:15 | Finished running 1 table model in 16.17s.
2021-03-31 12:51:15.404512 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:51:15.404606 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 12:51:15.404688 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 12:51:15.475946 (MainThread): 
2021-03-31 12:51:15.476124 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 12:51:15.476243 (MainThread): 
2021-03-31 12:51:15.476374 (MainThread): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
2021-03-31 12:51:15.476510 (MainThread):   002003 (42S02): SQL compilation error:
2021-03-31 12:51:15.476686 (MainThread):   Object 'DEMO_DB.STAGING.EXAMPLE_TEAMS' does not exist or not authorized.
2021-03-31 12:51:15.476779 (MainThread):   compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:51:15.476863 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-03-31 12:51:15.477011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea272e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71deb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e71d940>]}
2021-03-31 12:51:15.477190 (MainThread): Flushing usage events
2021-03-31 12:52:06.731474 (MainThread): Running with dbt=0.19.0
2021-03-31 12:52:07.358233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['example_team_details'], partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:52:07.359644 (MainThread): Tracking: tracking
2021-03-31 12:52:07.360113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc06908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f8470>]}
2021-03-31 12:52:07.396367 (MainThread): Partial parsing not enabled
2021-03-31 12:52:07.397521 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:52:07.399344 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:52:07.401691 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:52:07.431517 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:52:07.433688 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:52:07.435480 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:52:07.439595 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:52:07.450673 (MainThread): Parsing macros/core.sql
2021-03-31 12:52:07.455197 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:52:07.464280 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:52:07.466205 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:52:07.484826 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:52:07.518203 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:52:07.539658 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:52:07.541752 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:52:07.548889 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:52:07.563899 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:52:07.570950 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:52:07.577400 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:52:07.582494 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:52:07.583614 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:52:07.584807 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:52:07.586584 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:52:07.595747 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:52:07.597830 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:52:07.599998 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:52:07.642738 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:52:07.645017 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:52:07.646673 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:52:07.648560 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:52:07.653087 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:52:07.654734 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:52:07.656451 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:52:07.659102 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:52:07.665903 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:52:07.667320 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:52:07.669345 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:52:07.672482 (MainThread): Flushing usage events
2021-03-31 12:52:08.354382 (MainThread): ctrl-c
2021-03-31 12:52:08.354759 (MainThread): unclosed <socket.socket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.27.239.80', 61797), raddr=('34.199.231.102', 443)>
2021-03-31 12:52:14.904887 (MainThread): Running with dbt=0.19.0
2021-03-31 12:52:15.442424 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['exampe_teams'], partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:52:15.443458 (MainThread): Tracking: tracking
2021-03-31 12:52:15.444145 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109384898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84b0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84b6a0>]}
2021-03-31 12:52:15.478729 (MainThread): Partial parsing not enabled
2021-03-31 12:52:15.479459 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:52:15.480944 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:52:15.483264 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:52:15.512453 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:52:15.514545 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:52:15.516144 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:52:15.520260 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:52:15.530499 (MainThread): Parsing macros/core.sql
2021-03-31 12:52:15.534336 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:52:15.543055 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:52:15.544794 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:52:15.562735 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:52:15.595708 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:52:15.616847 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:52:15.618770 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:52:15.625055 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:52:15.639218 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:52:15.646184 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:52:15.652547 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:52:15.657386 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:52:15.658364 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:52:15.659473 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:52:15.661131 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:52:15.669744 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:52:15.671712 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:52:15.673419 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:52:15.714923 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:52:15.716843 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:52:15.718396 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:52:15.720134 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:52:15.724177 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:52:15.725462 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:52:15.726965 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:52:15.729463 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:52:15.736010 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:52:15.737290 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:52:15.739275 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:52:15.741872 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:52:15.743590 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:52:15.746303 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:52:15.756169 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:52:15.758415 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:52:15.760130 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:52:15.762162 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:52:15.764034 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:52:15.765290 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:52:15.768918 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:52:15.774510 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:52:15.775611 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:52:15.778686 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:52:15.780936 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:52:15.782840 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:52:15.785397 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:52:15.811458 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:52:15.812975 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:52:15.814542 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:52:15.816032 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:52:15.821318 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:52:15.823851 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:52:15.827180 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:52:15.829118 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:52:15.831021 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:52:15.833250 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:52:15.836197 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:52:15.838363 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:52:15.840338 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:52:15.842743 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:52:15.844622 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:52:15.848019 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:52:15.850588 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:52:15.852586 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:52:15.854914 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:52:15.859078 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:52:15.865973 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:52:15.867943 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:52:15.871760 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:52:15.876525 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:52:15.880371 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:52:15.882460 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:52:15.886273 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:52:15.894185 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:52:15.903038 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:52:15.904731 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:52:15.908593 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:52:15.910620 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:52:15.912608 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:52:15.919457 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:52:15.924418 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:52:15.928788 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:52:15.937202 (MainThread): Partial parsing not enabled
2021-03-31 12:52:15.980477 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:52:16.039742 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:16.058708 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:16.074747 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:16.087872 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:16.384854 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5e9d198-c024-4f82-8982-39d8f44617e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c414320>]}
2021-03-31 12:52:16.448401 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:52:16.448736 (MainThread): The selector 'exampe_teams' does not match any nodes and will be ignored
2021-03-31 12:52:16.449209 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-03-31 12:52:16.449373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c4ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c353fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ecf28>]}
2021-03-31 12:52:16.449538 (MainThread): Flushing usage events
2021-03-31 12:52:17.925715 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 12:52:27.440148 (MainThread): Running with dbt=0.19.0
2021-03-31 12:52:27.924417 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:52:27.925444 (MainThread): Tracking: tracking
2021-03-31 12:52:27.925835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089615f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10228d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d5ef0>]}
2021-03-31 12:52:27.958877 (MainThread): Partial parsing not enabled
2021-03-31 12:52:27.959593 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:52:27.961838 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:52:27.963931 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:52:27.993553 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:52:27.995616 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:52:27.997118 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:52:28.001137 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:52:28.012558 (MainThread): Parsing macros/core.sql
2021-03-31 12:52:28.017526 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:52:28.027627 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:52:28.029601 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:52:28.048150 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:52:28.080351 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:52:28.101359 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:52:28.103246 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:52:28.109378 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:52:28.123137 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:52:28.129865 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:52:28.136199 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:52:28.141207 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:52:28.142137 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:52:28.143221 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:52:28.144844 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:52:28.153623 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:52:28.155611 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:52:28.157334 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:52:28.198984 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:52:28.200887 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:52:28.202448 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:52:28.204244 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:52:28.208294 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:52:28.209552 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:52:28.211046 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:52:28.213571 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:52:28.220070 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:52:28.221355 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:52:28.223171 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:52:28.225727 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:52:28.227023 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:52:28.229495 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:52:28.239174 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:52:28.241263 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:52:28.242908 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:52:28.244764 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:52:28.246528 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:52:28.247685 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:52:28.251209 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:52:28.256636 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:52:28.257581 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:52:28.260493 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:52:28.262559 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:52:28.264295 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:52:28.266398 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:52:28.291723 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:52:28.293054 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:52:28.294490 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:52:28.295838 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:52:28.300779 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:52:28.302795 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:52:28.305606 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:52:28.307410 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:52:28.309453 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:52:28.312736 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:52:28.316179 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:52:28.318811 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:52:28.321819 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:52:28.326090 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:52:28.329275 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:52:28.335379 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:52:28.338255 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:52:28.340407 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:52:28.343532 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:52:28.348852 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:52:28.357581 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:52:28.359911 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:52:28.364599 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:52:28.370681 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:52:28.377605 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:52:28.380930 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:52:28.389083 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:52:28.410853 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:52:28.424219 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:52:28.426586 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:52:28.431673 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:52:28.434173 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:52:28.436567 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:52:28.445107 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:52:28.450917 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:52:28.455556 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:52:28.464114 (MainThread): Partial parsing not enabled
2021-03-31 12:52:28.509558 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:52:28.567713 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:28.585025 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:28.615659 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:28.628880 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:28.927677 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b0f60>]}
2021-03-31 12:52:28.991080 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:52:28.991850 (MainThread): 
2021-03-31 12:52:28.992115 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:52:28.997736 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:52:29.010930 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:52:29.011050 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:52:29.011127 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:52:31.309836 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.30 seconds
2021-03-31 12:52:31.314705 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 12:52:31.805801 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:52:31.806230 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:52:31.814624 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:52:31.817327 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:52:31.817457 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:52:31.817564 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:52:31.817670 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 12:52:31.817768 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:52:33.756740 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 3 in 1.94 seconds
2021-03-31 12:52:33.761446 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 12:52:34.013414 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 2.20 seconds
2021-03-31 12:52:34.018896 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:52:34.467511 (MainThread): Using snowflake connection "master".
2021-03-31 12:52:34.467674 (MainThread): On master: BEGIN
2021-03-31 12:52:34.467780 (MainThread): Opening a new connection, currently in state init
2021-03-31 12:52:37.813038 (MainThread): SQL status: SUCCESS 1 in 3.35 seconds
2021-03-31 12:52:37.813232 (MainThread): On master: COMMIT
2021-03-31 12:52:37.813400 (MainThread): Using snowflake connection "master".
2021-03-31 12:52:37.813497 (MainThread): On master: COMMIT
2021-03-31 12:52:38.167969 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 12:52:38.168161 (MainThread): On master: Close
2021-03-31 12:52:38.891264 (MainThread): 20:52:38 | Concurrency: 5 threads (target='dev')
2021-03-31 12:52:38.891476 (MainThread): 20:52:38 | 
2021-03-31 12:52:38.892593 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 12:52:38.892767 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:52:38.892938 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:52:38.894205 (Thread-1): 20:52:38 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 12:52:38.895373 (Thread-2): 20:52:38 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 12:52:38.896493 (Thread-3): 20:52:38 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 12:52:38.896872 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:38.897594 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:38.897947 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:38.898081 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 12:52:38.898234 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 12:52:38.898391 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:52:38.927057 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:52:38.929283 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:52:38.938506 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:52:38.939153 (Thread-1): finished collecting timing info
2021-03-31 12:52:38.939429 (Thread-2): finished collecting timing info
2021-03-31 12:52:38.950058 (Thread-3): finished collecting timing info
2021-03-31 12:52:38.993001 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:52:39.005183 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:52:39.010883 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:52:39.011643 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:39.011742 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 12:52:39.011825 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 12:52:39.013111 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:39.013210 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 12:52:39.013292 (Thread-2): Opening a new connection, currently in state init
2021-03-31 12:52:39.014921 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:39.015950 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 12:52:39.016166 (Thread-3): Opening a new connection, currently in state init
2021-03-31 12:52:40.705352 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-03-31 12:52:40.707011 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:40.707881 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 12:52:41.209296 (Thread-3): SQL status: SUCCESS 1 in 2.19 seconds
2021-03-31 12:52:41.209473 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:41.209575 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 12:52:41.266809 (Thread-2): SQL status: SUCCESS 1 in 2.25 seconds
2021-03-31 12:52:41.267079 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:41.267242 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 12:52:41.726072 (Thread-3): SQL status: SUCCESS 1 in 0.52 seconds
2021-03-31 12:52:41.730122 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:52:41.730308 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:52:41.730408 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:52:41.976579 (Thread-3): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 12:52:41.989086 (Thread-3): finished collecting timing info
2021-03-31 12:52:41.989406 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 12:52:42.448864 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7358>]}
2021-03-31 12:52:42.450331 (Thread-3): 20:52:42 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 3.55s]
2021-03-31 12:52:42.450626 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:52:43.979441 (Thread-2): SQL status: SUCCESS 1 in 2.71 seconds
2021-03-31 12:52:43.985194 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:52:43.985458 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:52:43.985572 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:52:44.067762 (Thread-1): SQL status: SUCCESS 1 in 3.36 seconds
2021-03-31 12:52:44.073197 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:52:44.073429 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:52:44.073538 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:52:44.225881 (Thread-2): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 12:52:44.233003 (Thread-2): finished collecting timing info
2021-03-31 12:52:44.233422 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 12:52:44.322316 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 12:52:44.325495 (Thread-1): finished collecting timing info
2021-03-31 12:52:44.325768 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 12:52:44.968795 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899c780>]}
2021-03-31 12:52:44.969466 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c34e0>]}
2021-03-31 12:52:44.970881 (Thread-2): 20:52:44 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 6.07s]
2021-03-31 12:52:44.972126 (Thread-1): 20:52:44 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 6.07s]
2021-03-31 12:52:44.972318 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:52:44.972497 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 12:52:44.973076 (Thread-5): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:52:44.973337 (Thread-3): Began running node model.demo_dbt.example_team_details
2021-03-31 12:52:44.974478 (Thread-5): 20:52:44 | 4 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 12:52:44.975572 (Thread-3): 20:52:44 | 5 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 12:52:44.975967 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:44.976309 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:52:44.976468 (Thread-5): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 12:52:44.976614 (Thread-3): Compiling model.demo_dbt.example_team_details
2021-03-31 12:52:44.993504 (Thread-5): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:52:44.997797 (Thread-3): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:52:44.998367 (Thread-3): finished collecting timing info
2021-03-31 12:52:45.004429 (Thread-3): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:52:45.004851 (Thread-5): finished collecting timing info
2021-03-31 12:52:45.010165 (Thread-5): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:52:45.010851 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:52:45.010980 (Thread-3): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 12:52:45.011139 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 12:52:45.012357 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:45.012479 (Thread-5): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 12:52:45.012751 (Thread-5): Opening a new connection, currently in state init
2021-03-31 12:52:47.187411 (Thread-5): SQL status: SUCCESS 1 in 2.17 seconds
2021-03-31 12:52:47.187707 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:47.187837 (Thread-5): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 12:52:47.189200 (Thread-3): SQL status: SUCCESS 1 in 2.18 seconds
2021-03-31 12:52:47.189367 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:52:47.190268 (Thread-3): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (-- WITH team as (
--     select * from DEMO_DB.staging.example_teams
-- ),

-- team_location AS (
--     select * from DEMO_DB.PUBLIC.team_location        
-- ), 

-- final AS (
--     SELECT 
--         teams.team,
--         team_location.city,
--         team_location.state
--     from teams
--     LEFT JOIN team_location
--     ON teams.team = team_location.name
-- )

-- SELECT * FROM final
      );
2021-03-31 12:52:47.457709 (Thread-3): Snowflake query id: 019b4624-04d3-9917-0000-002da6832595
2021-03-31 12:52:47.458004 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 6 unexpected ')'.
2021-03-31 12:52:47.458193 (Thread-3): finished collecting timing info
2021-03-31 12:52:47.458562 (Thread-3): On model.demo_dbt.example_team_details: ROLLBACK
2021-03-31 12:52:47.777528 (Thread-3): On model.demo_dbt.example_team_details: Close
2021-03-31 12:52:48.241209 (Thread-3): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 21 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:52:48.256185 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109408630>]}
2021-03-31 12:52:48.257561 (Thread-3): 20:52:48 | 5 of 5 ERROR creating table model staging.example_team_details....... [ERROR in 3.28s]
2021-03-31 12:52:48.257724 (Thread-3): Finished running node model.demo_dbt.example_team_details
2021-03-31 12:52:48.438239 (Thread-5): SQL status: SUCCESS 1 in 1.25 seconds
2021-03-31 12:52:48.443595 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:52:48.443806 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:52:48.443908 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:52:48.676764 (Thread-5): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 12:52:48.679958 (Thread-5): finished collecting timing info
2021-03-31 12:52:48.680281 (Thread-5): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 12:52:49.141244 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd740865a-d988-4a8a-a692-2c94c99121bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109460c50>]}
2021-03-31 12:52:49.142794 (Thread-5): 20:52:49 | 4 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 4.17s]
2021-03-31 12:52:49.142959 (Thread-5): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:52:49.224385 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:52:49.224772 (MainThread): Using snowflake connection "master".
2021-03-31 12:52:49.224929 (MainThread): On master: BEGIN
2021-03-31 12:52:49.225076 (MainThread): Opening a new connection, currently in state closed
2021-03-31 12:52:51.101159 (MainThread): SQL status: SUCCESS 1 in 1.88 seconds
2021-03-31 12:52:51.101510 (MainThread): On master: COMMIT
2021-03-31 12:52:51.101736 (MainThread): Using snowflake connection "master".
2021-03-31 12:52:51.101839 (MainThread): On master: COMMIT
2021-03-31 12:52:51.399525 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-03-31 12:52:51.399823 (MainThread): On master: Close
2021-03-31 12:52:51.836977 (MainThread): 20:52:51 | 
2021-03-31 12:52:51.837208 (MainThread): 20:52:51 | Finished running 1 view model, 4 table models in 22.84s.
2021-03-31 12:52:51.837359 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:52:51.837467 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 12:52:51.837570 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 12:52:51.837668 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 12:52:51.837764 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 12:52:51.837884 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 12:52:51.920131 (MainThread): 
2021-03-31 12:52:51.920272 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 12:52:51.920361 (MainThread): 
2021-03-31 12:52:51.920506 (MainThread): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
2021-03-31 12:52:51.920644 (MainThread):   001003 (42000): SQL compilation error:
2021-03-31 12:52:51.920827 (MainThread):   syntax error line 21 at position 6 unexpected ')'.
2021-03-31 12:52:51.920981 (MainThread):   compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:52:51.921105 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-03-31 12:52:51.921261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746bf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922f898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109211710>]}
2021-03-31 12:52:51.921438 (MainThread): Flushing usage events
2021-03-31 12:53:38.221746 (MainThread): Running with dbt=0.19.0
2021-03-31 12:53:38.897389 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:53:38.898233 (MainThread): Tracking: tracking
2021-03-31 12:53:38.898515 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11606d470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b5a4e0>]}
2021-03-31 12:53:38.935928 (MainThread): Partial parsing not enabled
2021-03-31 12:53:38.937112 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:53:38.938678 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:53:38.940864 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:53:38.971049 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:53:38.973279 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:53:38.974987 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:53:38.979250 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:53:38.991134 (MainThread): Parsing macros/core.sql
2021-03-31 12:53:38.995554 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:53:39.005089 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:53:39.007498 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:53:39.026849 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:53:39.061076 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:53:39.083939 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:53:39.086081 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:53:39.093160 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:53:39.109112 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:53:39.116895 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:53:39.124438 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:53:39.130592 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:53:39.132030 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:53:39.133530 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:53:39.135739 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:53:39.147659 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:53:39.150579 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:53:39.153284 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:53:39.206770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:53:39.209398 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:53:39.211299 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:53:39.213453 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:53:39.219491 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:53:39.221640 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:53:39.223691 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:53:39.227016 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:53:39.235122 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:53:39.236568 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:53:39.238591 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:53:39.241359 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:53:39.242778 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:53:39.245586 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:53:39.255856 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:53:39.258203 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:53:39.259991 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:53:39.261997 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:53:39.264046 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:53:39.265327 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:53:39.269097 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:53:39.274910 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:53:39.275939 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:53:39.279083 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:53:39.281401 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:53:39.283239 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:53:39.285861 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:53:39.313429 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:53:39.314980 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:53:39.316583 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:53:39.318047 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:53:39.323684 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:53:39.326349 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:53:39.329490 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:53:39.331454 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:53:39.333373 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:53:39.335615 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:53:39.338599 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:53:39.340754 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:53:39.342580 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:53:39.345042 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:53:39.346904 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:53:39.350430 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:53:39.353065 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:53:39.355044 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:53:39.357371 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:53:39.361650 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:53:39.368817 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:53:39.370919 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:53:39.374947 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:53:39.379949 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:53:39.383771 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:53:39.385972 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:53:39.389996 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:53:39.398100 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:53:39.407278 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:53:39.409102 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:53:39.412992 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:53:39.414955 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:53:39.417107 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:53:39.423917 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:53:39.429495 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:53:39.434347 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:53:39.442769 (MainThread): Partial parsing not enabled
2021-03-31 12:53:39.488176 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:53:39.552859 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:53:39.572217 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:53:39.588393 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:53:39.602267 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:53:39.906368 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11609a668>]}
2021-03-31 12:53:39.974822 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:53:39.975651 (MainThread): 
2021-03-31 12:53:39.975934 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:53:39.981453 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:53:39.996523 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:53:39.996671 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:53:39.996765 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:53:42.381193 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 2.38 seconds
2021-03-31 12:53:42.385958 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 12:53:42.874052 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:53:42.874483 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:53:42.882889 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:53:42.885293 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:53:42.885432 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:53:42.885535 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:53:42.885633 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 12:53:42.885726 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:53:44.800606 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 1.91 seconds
2021-03-31 12:53:44.806276 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 12:53:44.807260 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.92 seconds
2021-03-31 12:53:44.813363 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:53:45.287372 (MainThread): Using snowflake connection "master".
2021-03-31 12:53:45.287556 (MainThread): On master: BEGIN
2021-03-31 12:53:45.287677 (MainThread): Opening a new connection, currently in state init
2021-03-31 12:53:47.746395 (MainThread): SQL status: SUCCESS 1 in 2.46 seconds
2021-03-31 12:53:47.746620 (MainThread): On master: COMMIT
2021-03-31 12:53:47.746816 (MainThread): Using snowflake connection "master".
2021-03-31 12:53:47.746928 (MainThread): On master: COMMIT
2021-03-31 12:53:48.087195 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-03-31 12:53:48.087472 (MainThread): On master: Close
2021-03-31 12:53:48.556987 (MainThread): 20:53:48 | Concurrency: 5 threads (target='dev')
2021-03-31 12:53:48.557179 (MainThread): 20:53:48 | 
2021-03-31 12:53:48.558413 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 12:53:48.559675 (Thread-1): 20:53:48 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 12:53:48.559991 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:53:48.560147 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:53:48.560299 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 12:53:48.560393 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:53:48.561536 (Thread-2): 20:53:48 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 12:53:48.569356 (Thread-3): 20:53:48 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 12:53:48.580851 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:53:48.581223 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:53:48.581558 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:53:48.581908 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 12:53:48.582055 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:53:48.588496 (Thread-1): finished collecting timing info
2021-03-31 12:53:48.594300 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:53:48.602854 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:53:48.637090 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:53:48.637746 (Thread-3): finished collecting timing info
2021-03-31 12:53:48.644350 (Thread-2): finished collecting timing info
2021-03-31 12:53:48.648821 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:53:48.662737 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:53:48.663480 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:53:48.663577 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 12:53:48.663656 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 12:53:48.665531 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:53:48.665624 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 12:53:48.665701 (Thread-2): Opening a new connection, currently in state init
2021-03-31 12:53:48.666256 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:53:48.667386 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 12:53:48.668066 (Thread-3): Opening a new connection, currently in state init
2021-03-31 12:53:50.459166 (Thread-2): SQL status: SUCCESS 1 in 1.79 seconds
2021-03-31 12:53:50.459422 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:53:50.459574 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 12:53:50.506403 (Thread-3): SQL status: SUCCESS 1 in 1.84 seconds
2021-03-31 12:53:50.506608 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:53:50.506722 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 12:53:50.514472 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-03-31 12:53:50.514611 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:53:50.514708 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 12:53:50.996991 (Thread-3): SQL status: SUCCESS 1 in 0.49 seconds
2021-03-31 12:53:51.002360 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:53:51.002541 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:53:51.002642 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:53:51.261429 (Thread-3): SQL status: SUCCESS 1 in 0.26 seconds
2021-03-31 12:53:51.275347 (Thread-3): finished collecting timing info
2021-03-31 12:53:51.275640 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 12:53:51.540973 (Thread-2): SQL status: SUCCESS 1 in 1.08 seconds
2021-03-31 12:53:51.545255 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:53:51.545483 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:53:51.545592 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:53:51.726886 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116930208>]}
2021-03-31 12:53:51.728424 (Thread-3): 20:53:51 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 3.15s]
2021-03-31 12:53:51.728609 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:53:52.317650 (Thread-2): SQL status: SUCCESS 1 in 0.77 seconds
2021-03-31 12:53:52.325185 (Thread-2): finished collecting timing info
2021-03-31 12:53:52.325679 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2021-03-31 12:53:52.325863 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 12:53:52.329859 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:53:52.331055 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:53:52.331305 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:53:52.572828 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 12:53:52.576955 (Thread-1): finished collecting timing info
2021-03-31 12:53:52.577273 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 12:53:52.866392 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160cdef0>]}
2021-03-31 12:53:52.867928 (Thread-2): 20:53:52 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 4.29s]
2021-03-31 12:53:52.868105 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:53:52.868519 (Thread-5): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:53:52.869685 (Thread-5): 20:53:52 | 4 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 12:53:52.869994 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:53:52.870120 (Thread-5): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 12:53:52.879563 (Thread-5): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:53:52.880048 (Thread-5): finished collecting timing info
2021-03-31 12:53:52.885596 (Thread-5): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:53:52.886524 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:53:52.886638 (Thread-5): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 12:53:52.886737 (Thread-5): Opening a new connection, currently in state init
2021-03-31 12:53:53.042792 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116938470>]}
2021-03-31 12:53:53.044302 (Thread-1): 20:53:53 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 4.48s]
2021-03-31 12:53:53.044484 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 12:53:53.044839 (Thread-3): Began running node model.demo_dbt.example_team_details
2021-03-31 12:53:53.045997 (Thread-3): 20:53:53 | 5 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 12:53:53.046289 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:53:53.046413 (Thread-3): Compiling model.demo_dbt.example_team_details
2021-03-31 12:53:53.056622 (Thread-3): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:53:53.057122 (Thread-3): finished collecting timing info
2021-03-31 12:53:53.062362 (Thread-3): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 12:53:53.063137 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:53:53.063245 (Thread-3): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 12:53:53.063340 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 12:53:54.593459 (Thread-5): SQL status: SUCCESS 1 in 1.71 seconds
2021-03-31 12:53:54.593631 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:53:54.593722 (Thread-5): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 12:53:54.966034 (Thread-3): SQL status: SUCCESS 1 in 1.90 seconds
2021-03-31 12:53:54.966279 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 12:53:54.966423 (Thread-3): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (-- WITH team as (
--     select * from DEMO_DB.staging.example_teams
-- ),

-- team_location AS (
--     select * from DEMO_DB.PUBLIC.team_location        
-- ), 

-- final AS (
--     SELECT 
--         teams.team,
--         team_location.city,
--         team_location.state
--     from teams
--     LEFT JOIN team_location
--     ON teams.team = team_location.name
-- )

-- SELECT * FROM final
      );
2021-03-31 12:53:55.637553 (Thread-3): Snowflake query id: 019b4625-04da-20d7-0000-002da68325c5
2021-03-31 12:53:55.637768 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 6 unexpected ')'.
2021-03-31 12:53:55.637981 (Thread-3): finished collecting timing info
2021-03-31 12:53:55.638390 (Thread-3): On model.demo_dbt.example_team_details: ROLLBACK
2021-03-31 12:53:55.672400 (Thread-5): SQL status: SUCCESS 1 in 1.08 seconds
2021-03-31 12:53:55.677453 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:53:55.677675 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:53:55.677771 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:53:55.935568 (Thread-5): SQL status: SUCCESS 1 in 0.26 seconds
2021-03-31 12:53:55.938772 (Thread-5): finished collecting timing info
2021-03-31 12:53:55.939080 (Thread-5): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 12:53:55.950311 (Thread-3): On model.demo_dbt.example_team_details: Close
2021-03-31 12:53:56.393957 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b92b70>]}
2021-03-31 12:53:56.395481 (Thread-5): 20:53:56 | 4 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 3.52s]
2021-03-31 12:53:56.395671 (Thread-5): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:53:56.414317 (Thread-3): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 21 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 6 unexpected ')'.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:53:56.422123 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dba2735-4598-4aad-9dd8-40ac78192622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c560b8>]}
2021-03-31 12:53:56.423387 (Thread-3): 20:53:56 | 5 of 5 ERROR creating table model staging.example_team_details....... [ERROR in 3.38s]
2021-03-31 12:53:56.423540 (Thread-3): Finished running node model.demo_dbt.example_team_details
2021-03-31 12:53:56.492013 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:53:56.492396 (MainThread): Using snowflake connection "master".
2021-03-31 12:53:56.492551 (MainThread): On master: BEGIN
2021-03-31 12:53:56.492695 (MainThread): Opening a new connection, currently in state closed
2021-03-31 12:53:58.342215 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2021-03-31 12:53:58.342463 (MainThread): On master: COMMIT
2021-03-31 12:53:58.342665 (MainThread): Using snowflake connection "master".
2021-03-31 12:53:58.342784 (MainThread): On master: COMMIT
2021-03-31 12:53:58.666654 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 12:53:58.666939 (MainThread): On master: Close
2021-03-31 12:53:59.151613 (MainThread): 20:53:59 | 
2021-03-31 12:53:59.151858 (MainThread): 20:53:59 | Finished running 1 view model, 4 table models in 19.18s.
2021-03-31 12:53:59.152016 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:53:59.152129 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 12:53:59.152272 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 12:53:59.152430 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 12:53:59.152577 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 12:53:59.152689 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 12:53:59.226036 (MainThread): 
2021-03-31 12:53:59.226175 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 12:53:59.226265 (MainThread): 
2021-03-31 12:53:59.226353 (MainThread): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
2021-03-31 12:53:59.226432 (MainThread):   001003 (42000): SQL compilation error:
2021-03-31 12:53:59.226504 (MainThread):   syntax error line 21 at position 6 unexpected ')'.
2021-03-31 12:53:59.226621 (MainThread):   compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 12:53:59.226703 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-03-31 12:53:59.226884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168f82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ba1c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ba1e48>]}
2021-03-31 12:53:59.227083 (MainThread): Flushing usage events
2021-03-31 12:54:53.038819 (MainThread): Running with dbt=0.19.0
2021-03-31 12:54:53.767262 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:54:53.768931 (MainThread): Tracking: tracking
2021-03-31 12:54:53.769352 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879f7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac662b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac666a0>]}
2021-03-31 12:54:53.804741 (MainThread): Partial parsing not enabled
2021-03-31 12:54:53.805771 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:54:53.807735 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:54:53.809898 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:54:53.840888 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:54:53.843129 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:54:53.844803 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:54:53.849332 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:54:53.860651 (MainThread): Parsing macros/core.sql
2021-03-31 12:54:53.865159 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:54:53.875425 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:54:53.877356 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:54:53.896810 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:54:53.931377 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:54:53.954455 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:54:53.956562 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:54:53.963147 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:54:53.978230 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:54:53.985933 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:54:53.992935 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:54:53.998210 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:54:53.999330 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:54:54.000692 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:54:54.002645 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:54:54.012128 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:54:54.014275 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:54:54.016364 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:54:54.060803 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:54:54.062930 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:54:54.064754 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:54:54.066623 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:54:54.071284 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:54:54.073122 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:54:54.074794 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:54:54.077540 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:54:54.084529 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:54:54.085952 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:54:54.088011 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:54:54.090764 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:54:54.092241 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:54:54.094942 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:54:54.105149 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:54:54.107375 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:54:54.109136 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:54:54.111187 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:54:54.113186 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:54:54.114471 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:54:54.118248 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:54:54.124026 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:54:54.125053 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:54:54.128179 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:54:54.130382 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:54:54.132262 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:54:54.134819 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:54:54.161733 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:54:54.163191 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:54:54.164720 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:54:54.166150 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:54:54.171586 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:54:54.174051 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:54:54.177176 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:54:54.179079 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:54:54.181037 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:54:54.183268 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:54:54.186286 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:54:54.188461 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:54:54.190397 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:54:54.192918 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:54:54.194844 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:54:54.198326 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:54:54.200901 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:54:54.202862 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:54:54.205166 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:54:54.209268 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:54:54.216304 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:54:54.218251 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:54:54.222129 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:54:54.227271 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:54:54.231496 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:54:54.233703 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:54:54.237594 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:54:54.245411 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:54:54.254485 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:54:54.256148 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:54:54.260205 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:54:54.262163 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:54:54.264178 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:54:54.271118 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:54:54.276093 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:54:54.280516 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:54:54.288725 (MainThread): Partial parsing not enabled
2021-03-31 12:54:54.333205 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:54:54.395849 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:54:54.413578 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:54:54.429328 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:54:54.748849 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01c86b98-2110-435f-a084-c486e041cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ba2e8>]}
2021-03-31 12:54:54.813854 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:54:54.814574 (MainThread): 
2021-03-31 12:54:54.814904 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:54:54.819914 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:54:54.833858 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:54:54.833994 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:54:54.834076 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:54:56.688798 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.85 seconds
2021-03-31 12:54:56.692768 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 12:54:57.190072 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:54:57.225859 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:54:57.246246 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 12:54:57.247499 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 12:54:57.247604 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 12:54:57.247726 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 12:54:57.247841 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 12:54:57.247949 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 12:54:59.054513 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 1.81 seconds
2021-03-31 12:54:59.059719 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 12:54:59.834076 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 2.59 seconds
2021-03-31 12:54:59.839510 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 12:55:00.569513 (MainThread): Using snowflake connection "master".
2021-03-31 12:55:00.569678 (MainThread): On master: BEGIN
2021-03-31 12:55:00.569783 (MainThread): Opening a new connection, currently in state init
2021-03-31 12:55:02.277782 (MainThread): SQL status: SUCCESS 1 in 1.71 seconds
2021-03-31 12:55:02.278055 (MainThread): On master: COMMIT
2021-03-31 12:55:02.278303 (MainThread): Using snowflake connection "master".
2021-03-31 12:55:02.278449 (MainThread): On master: COMMIT
2021-03-31 12:55:02.603084 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 12:55:02.603361 (MainThread): On master: Close
2021-03-31 12:55:03.326764 (MainThread): 20:55:03 | Concurrency: 5 threads (target='dev')
2021-03-31 12:55:03.326995 (MainThread): 20:55:03 | 
2021-03-31 12:55:03.328496 (Thread-1): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:55:03.328737 (Thread-2): Began running node model.demo_dbt.example_teams
2021-03-31 12:55:03.330264 (Thread-1): 20:55:03 | 1 of 4 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 12:55:03.330380 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:55:03.331525 (Thread-2): 20:55:03 | 2 of 4 START table model staging.example_teams....................... [RUN]
2021-03-31 12:55:03.331895 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:55:03.333837 (Thread-3): 20:55:03 | 3 of 4 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 12:55:03.334137 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:55:03.334296 (Thread-1): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 12:55:03.334583 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:55:03.334764 (Thread-2): Compiling model.demo_dbt.example_teams
2021-03-31 12:55:03.345838 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:55:03.357669 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:55:03.369911 (Thread-2): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:55:03.373906 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:55:03.374741 (Thread-2): finished collecting timing info
2021-03-31 12:55:03.381317 (Thread-3): finished collecting timing info
2021-03-31 12:55:03.387893 (Thread-1): finished collecting timing info
2021-03-31 12:55:03.446158 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 12:55:03.449443 (Thread-2): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 12:55:03.450576 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 12:55:03.451888 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:55:03.451979 (Thread-1): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 12:55:03.452061 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 12:55:03.453162 (Thread-2): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:55:03.454192 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:55:03.454264 (Thread-2): On model.demo_dbt.example_teams: BEGIN
2021-03-31 12:55:03.454496 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 12:55:03.454909 (Thread-2): Opening a new connection, currently in state init
2021-03-31 12:55:03.455222 (Thread-3): Opening a new connection, currently in state init
2021-03-31 12:55:05.803061 (Thread-3): SQL status: SUCCESS 1 in 2.35 seconds
2021-03-31 12:55:05.803880 (Thread-1): SQL status: SUCCESS 1 in 2.35 seconds
2021-03-31 12:55:05.804034 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:55:05.804175 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:55:05.804383 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 12:55:05.804605 (Thread-1): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 12:55:06.270072 (Thread-2): SQL status: SUCCESS 1 in 2.82 seconds
2021-03-31 12:55:06.270243 (Thread-2): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:55:06.270355 (Thread-2): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 12:55:06.532658 (Thread-3): SQL status: SUCCESS 1 in 0.73 seconds
2021-03-31 12:55:06.536122 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:55:06.536274 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:55:06.536358 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 12:55:07.294072 (Thread-3): SQL status: SUCCESS 1 in 0.76 seconds
2021-03-31 12:55:07.306582 (Thread-3): finished collecting timing info
2021-03-31 12:55:07.306888 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 12:55:07.365087 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-03-31 12:55:07.370166 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:55:07.370411 (Thread-1): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:55:07.371250 (Thread-2): SQL status: SUCCESS 1 in 1.10 seconds
2021-03-31 12:55:07.371350 (Thread-1): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 12:55:07.375302 (Thread-2): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:55:07.376376 (Thread-2): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:55:07.376497 (Thread-2): On model.demo_dbt.example_teams: COMMIT
2021-03-31 12:55:09.303608 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2021-03-31 12:55:09.303990 (Thread-2): SQL status: SUCCESS 1 in 1.93 seconds
2021-03-31 12:55:09.309892 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c86b98-2110-435f-a084-c486e041cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974d2b0>]}
2021-03-31 12:55:09.311487 (Thread-1): finished collecting timing info
2021-03-31 12:55:09.314714 (Thread-2): finished collecting timing info
2021-03-31 12:55:09.315093 (Thread-1): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 12:55:09.316236 (Thread-3): 20:55:09 | 3 of 4 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 5.98s]
2021-03-31 12:55:09.316400 (Thread-2): On model.demo_dbt.example_teams: Close
2021-03-31 12:55:09.318093 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 12:55:09.776644 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c86b98-2110-435f-a084-c486e041cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b9080>]}
2021-03-31 12:55:09.778224 (Thread-2): 20:55:09 | 2 of 4 OK created table model staging.example_teams.................. [SUCCESS 1 in 6.44s]
2021-03-31 12:55:09.778389 (Thread-2): Finished running node model.demo_dbt.example_teams
2021-03-31 12:55:09.789444 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c86b98-2110-435f-a084-c486e041cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbef60>]}
2021-03-31 12:55:09.791000 (Thread-1): 20:55:09 | 1 of 4 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 6.46s]
2021-03-31 12:55:09.791246 (Thread-1): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 12:55:09.791964 (Thread-5): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:55:09.793225 (Thread-5): 20:55:09 | 4 of 4 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 12:55:09.793593 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:55:09.793749 (Thread-5): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 12:55:09.803507 (Thread-5): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:55:09.804096 (Thread-5): finished collecting timing info
2021-03-31 12:55:09.809884 (Thread-5): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 12:55:09.810862 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:55:09.810989 (Thread-5): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 12:55:09.811093 (Thread-5): Opening a new connection, currently in state init
2021-03-31 12:55:11.595831 (Thread-5): SQL status: SUCCESS 1 in 1.78 seconds
2021-03-31 12:55:11.596045 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:55:11.596172 (Thread-5): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 12:55:12.606497 (Thread-5): SQL status: SUCCESS 1 in 1.01 seconds
2021-03-31 12:55:12.610700 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:55:12.610894 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:55:12.610995 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 12:55:12.840210 (Thread-5): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 12:55:12.842681 (Thread-5): finished collecting timing info
2021-03-31 12:55:12.842953 (Thread-5): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 12:55:13.310705 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c86b98-2110-435f-a084-c486e041cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90c4e0>]}
2021-03-31 12:55:13.312222 (Thread-5): 20:55:13 | 4 of 4 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 3.52s]
2021-03-31 12:55:13.312413 (Thread-5): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 12:55:13.369950 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:55:13.370338 (MainThread): Using snowflake connection "master".
2021-03-31 12:55:13.370509 (MainThread): On master: BEGIN
2021-03-31 12:55:13.370630 (MainThread): Opening a new connection, currently in state closed
2021-03-31 12:55:15.892505 (MainThread): SQL status: SUCCESS 1 in 2.52 seconds
2021-03-31 12:55:15.892815 (MainThread): On master: COMMIT
2021-03-31 12:55:15.893022 (MainThread): Using snowflake connection "master".
2021-03-31 12:55:15.893131 (MainThread): On master: COMMIT
2021-03-31 12:55:16.216789 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 12:55:16.217064 (MainThread): On master: Close
2021-03-31 12:55:16.654765 (MainThread): 20:55:16 | 
2021-03-31 12:55:16.654958 (MainThread): 20:55:16 | Finished running 1 view model, 3 table models in 21.84s.
2021-03-31 12:55:16.655087 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:55:16.655180 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 12:55:16.655267 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 12:55:16.655352 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 12:55:16.655436 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 12:55:16.655518 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 12:55:16.729102 (MainThread): 
2021-03-31 12:55:16.729274 (MainThread): Completed successfully
2021-03-31 12:55:16.729395 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-03-31 12:55:16.729597 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b62e898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b631908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90c358>]}
2021-03-31 12:55:16.729869 (MainThread): Flushing usage events
2021-03-31 12:57:38.999583 (MainThread): Running with dbt=0.19.0
2021-03-31 12:57:39.649915 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 12:57:39.651468 (MainThread): Tracking: tracking
2021-03-31 12:57:39.651867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139444e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113944f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113944748>]}
2021-03-31 12:57:39.687674 (MainThread): Partial parsing not enabled
2021-03-31 12:57:39.689009 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 12:57:39.690759 (MainThread): Parsing macros/catalog.sql
2021-03-31 12:57:39.693684 (MainThread): Parsing macros/adapters.sql
2021-03-31 12:57:39.724494 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 12:57:39.727072 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 12:57:39.728723 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 12:57:39.733451 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 12:57:39.745351 (MainThread): Parsing macros/core.sql
2021-03-31 12:57:39.750358 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 12:57:39.761011 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 12:57:39.763207 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 12:57:39.782820 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 12:57:39.817082 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 12:57:39.838677 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 12:57:39.840733 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 12:57:39.847274 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 12:57:39.861664 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 12:57:39.868685 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 12:57:39.876278 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 12:57:39.881946 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 12:57:39.883075 (MainThread): Parsing macros/etc/query.sql
2021-03-31 12:57:39.884370 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 12:57:39.886244 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 12:57:39.895451 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 12:57:39.897586 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 12:57:39.899756 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 12:57:39.946024 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 12:57:39.948058 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 12:57:39.949751 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 12:57:39.951578 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 12:57:39.956445 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 12:57:39.958021 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 12:57:39.959596 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 12:57:39.962308 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 12:57:39.969232 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 12:57:39.970694 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 12:57:39.972618 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 12:57:39.975323 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 12:57:39.976710 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 12:57:39.979354 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 12:57:39.989393 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 12:57:39.991721 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 12:57:39.993653 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 12:57:39.995724 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 12:57:39.997677 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 12:57:39.998970 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 12:57:40.002675 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 12:57:40.008315 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 12:57:40.009417 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 12:57:40.012475 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 12:57:40.014703 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 12:57:40.016541 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 12:57:40.019061 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 12:57:40.045965 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 12:57:40.047433 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 12:57:40.048970 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 12:57:40.050385 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 12:57:40.055801 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 12:57:40.058267 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 12:57:40.061531 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 12:57:40.063519 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 12:57:40.065356 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 12:57:40.067721 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 12:57:40.070637 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 12:57:40.072794 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 12:57:40.074664 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 12:57:40.077039 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 12:57:40.078867 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 12:57:40.082343 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 12:57:40.084986 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 12:57:40.087074 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 12:57:40.089920 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 12:57:40.094721 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 12:57:40.102976 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 12:57:40.105053 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 12:57:40.108923 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 12:57:40.113692 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 12:57:40.117649 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 12:57:40.119798 (MainThread): Parsing macros/sql/star.sql
2021-03-31 12:57:40.123644 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 12:57:40.132233 (MainThread): Parsing macros/sql/union.sql
2021-03-31 12:57:40.141680 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 12:57:40.143342 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 12:57:40.147237 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 12:57:40.149221 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 12:57:40.151227 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 12:57:40.158179 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 12:57:40.163687 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 12:57:40.168289 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 12:57:40.176428 (MainThread): Partial parsing not enabled
2021-03-31 12:57:40.221332 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 12:57:40.281670 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 12:57:40.299031 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 12:57:40.312925 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 12:57:40.613053 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77893926-1a52-42ed-b337-18537d8ca137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145392e8>]}
2021-03-31 12:57:40.678404 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 12:57:40.679138 (MainThread): 
2021-03-31 12:57:40.679403 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 12:57:40.683994 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 12:57:40.697114 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 12:57:40.697255 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:57:40.697338 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 12:59:40.383938 (MainThread): Connection 'master' was properly closed.
2021-03-31 12:59:40.384120 (MainThread): Connection 'list_DEMO_DB' was properly closed.
2021-03-31 12:59:40.384219 (MainThread): Flushing usage events
2021-03-31 12:59:42.726257 (ThreadPoolExecutor-0_0): HTTPSConnectionPool(host='naa59634.snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=900201ea-47ee-4b6b-a73c-c1207bd83a91&databaseName=DEMO_DB&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=a73c8c2b-b28a-4023-b2b3-6157e6f26a62 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/urllib3/connection.py", line 160, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/Library/Python/3.7/site-packages/urllib3/util/connection.py", line 61, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/socket.py", line 748, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/urllib3/connectionpool.py", line 677, in urlopen
    chunked=chunked,
  File "/Library/Python/3.7/site-packages/urllib3/connectionpool.py", line 381, in _make_request
    self._validate_conn(conn)
  File "/Library/Python/3.7/site-packages/urllib3/connectionpool.py", line 978, in _validate_conn
    conn.connect()
  File "/Library/Python/3.7/site-packages/urllib3/connection.py", line 309, in connect
    conn = self._new_conn()
  File "/Library/Python/3.7/site-packages/urllib3/connection.py", line 172, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/Library/Python/3.7/site-packages/urllib3/connectionpool.py", line 767, in urlopen
    **response_kw
  File "/Library/Python/3.7/site-packages/urllib3/connectionpool.py", line 727, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/Library/Python/3.7/site-packages/urllib3/util/retry.py", line 446, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='naa59634.snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=900201ea-47ee-4b6b-a73c-c1207bd83a91&databaseName=DEMO_DB&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=a73c8c2b-b28a-4023-b2b3-6157e6f26a62 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/snowflake/connector/network.py", line 777, in _request_exec
    auth=SnowflakeAuth(token),
  File "/Library/Python/3.7/site-packages/requests/sessions.py", line 530, in request
    resp = self.send(prep, **send_kwargs)
  File "/Library/Python/3.7/site-packages/requests/sessions.py", line 643, in send
    r = adapter.send(request, **kwargs)
  File "/Library/Python/3.7/site-packages/requests/adapters.py", line 516, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='naa59634.snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=900201ea-47ee-4b6b-a73c-c1207bd83a91&databaseName=DEMO_DB&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=a73c8c2b-b28a-4023-b2b3-6157e6f26a62 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/snowflake/connector/network.py", line 623, in _request_exec_wrapper
    **kwargs)
  File "/Library/Python/3.7/site-packages/snowflake/connector/network.py", line 870, in _request_exec
    raise RetryRequest(err)
snowflake.connector.network.RetryRequest: HTTPSConnectionPool(host='naa59634.snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=900201ea-47ee-4b6b-a73c-c1207bd83a91&databaseName=DEMO_DB&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=a73c8c2b-b28a-4023-b2b3-6157e6f26a62 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))
2021-03-31 12:59:42.735567 (ThreadPoolExecutor-0_0): Got an error when attempting to open a snowflake connection: '250003: Failed to execute request: HTTPSConnectionPool(host='naa59634.snowflakecomputing.com', port=443): Max retries exceeded with url: /session/v1/login-request?request_id=900201ea-47ee-4b6b-a73c-c1207bd83a91&databaseName=DEMO_DB&schemaName=PUBLIC&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=a73c8c2b-b28a-4023-b2b3-6157e6f26a62 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x1144e2908>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known'))'
2021-03-31 12:59:42.735698 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 12:59:42.735786 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 12:59:42.735928 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 12:59:42.736011 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 13:00:10.389483 (MainThread): ctrl-c
2021-03-31 13:00:50.416109 (MainThread): Running with dbt=0.19.0
2021-03-31 13:00:50.893846 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:00:50.894589 (MainThread): Tracking: tracking
2021-03-31 13:00:50.894910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dbf390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dbff98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dbf748>]}
2021-03-31 13:00:50.928487 (MainThread): Partial parsing not enabled
2021-03-31 13:00:50.929224 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:00:50.930771 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:00:50.933108 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:00:50.963168 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:00:50.965249 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:00:50.966770 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:00:50.970944 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:00:50.981483 (MainThread): Parsing macros/core.sql
2021-03-31 13:00:50.985457 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:00:50.994769 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:00:50.996771 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:00:51.015535 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:00:51.049545 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:00:51.071844 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:00:51.073881 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:00:51.080336 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:00:51.094905 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:00:51.101937 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:00:51.108694 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:00:51.113817 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:00:51.114793 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:00:51.115872 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:00:51.117538 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:00:51.126756 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:00:51.128806 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:00:51.130546 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:00:51.175006 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:00:51.176956 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:00:51.178503 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:00:51.180240 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:00:51.184422 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:00:51.185689 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:00:51.187294 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:00:51.189874 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:00:51.196712 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:00:51.198040 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:00:51.199893 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:00:51.202504 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:00:51.203849 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:00:51.206427 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:00:51.216533 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:00:51.218642 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:00:51.220293 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:00:51.222404 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:00:51.224264 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:00:51.225444 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:00:51.229120 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:00:51.234808 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:00:51.235717 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:00:51.239369 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:00:51.241570 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:00:51.243327 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:00:51.245511 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:00:51.272214 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:00:51.273635 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:00:51.275047 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:00:51.276345 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:00:51.281447 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:00:51.283486 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:00:51.286479 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:00:51.288414 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:00:51.290115 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:00:51.292143 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:00:51.294929 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:00:51.296929 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:00:51.298620 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:00:51.300879 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:00:51.302613 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:00:51.306276 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:00:51.308745 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:00:51.310630 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:00:51.312807 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:00:51.316805 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:00:51.324940 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:00:51.326833 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:00:51.330557 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:00:51.335242 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:00:51.339363 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:00:51.341290 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:00:51.345068 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:00:51.352978 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:00:51.363455 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:00:51.365088 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:00:51.369257 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:00:51.371265 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:00:51.373343 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:00:51.380310 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:00:51.385451 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:00:51.390012 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:00:51.398227 (MainThread): Partial parsing not enabled
2021-03-31 13:00:51.442516 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:00:51.495441 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:00:51.510101 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:00:51.523028 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:00:51.533846 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:00:51.823743 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115988f98>]}
2021-03-31 13:00:51.886245 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 315 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:00:51.887111 (MainThread): 
2021-03-31 13:00:51.887366 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:00:51.893111 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 13:00:51.906125 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 13:00:51.906250 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 13:00:51.906378 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 13:01:40.483788 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 48.58 seconds
2021-03-31 13:01:40.488267 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 13:01:40.989992 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:01:40.990438 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:01:40.999333 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:01:41.001814 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:01:41.001954 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:01:41.002059 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:01:41.002161 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 13:01:41.002257 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:01:42.688788 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 1.69 seconds
2021-03-31 13:01:42.693055 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:01:42.855823 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.85 seconds
2021-03-31 13:01:42.861928 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:01:43.352827 (MainThread): Using snowflake connection "master".
2021-03-31 13:01:43.353035 (MainThread): On master: BEGIN
2021-03-31 13:01:43.353176 (MainThread): Opening a new connection, currently in state init
2021-03-31 13:01:44.779106 (MainThread): SQL status: SUCCESS 1 in 1.43 seconds
2021-03-31 13:01:44.779321 (MainThread): On master: COMMIT
2021-03-31 13:01:44.779525 (MainThread): Using snowflake connection "master".
2021-03-31 13:01:44.779646 (MainThread): On master: COMMIT
2021-03-31 13:01:45.133857 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 13:01:45.134103 (MainThread): On master: Close
2021-03-31 13:01:45.870976 (MainThread): 21:01:45 | Concurrency: 5 threads (target='dev')
2021-03-31 13:01:45.871302 (MainThread): 21:01:45 | 
2021-03-31 13:01:45.872666 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 13:01:45.872877 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:01:45.873001 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:01:45.874952 (Thread-1): 21:01:45 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 13:01:45.876554 (Thread-2): 21:01:45 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 13:01:45.878456 (Thread-3): 21:01:45 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 13:01:45.879254 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:01:45.880225 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:01:45.880562 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:01:45.880841 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 13:01:45.881015 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 13:01:45.881275 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:01:45.922546 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:01:45.930582 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:01:45.936689 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:01:45.937305 (Thread-1): finished collecting timing info
2021-03-31 13:01:45.943049 (Thread-2): finished collecting timing info
2021-03-31 13:01:45.948956 (Thread-3): finished collecting timing info
2021-03-31 13:01:46.029139 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:01:46.031341 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:01:46.035012 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:01:46.036417 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:01:46.036551 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 13:01:46.037239 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:01:46.037353 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:01:46.037550 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 13:01:46.038351 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:01:46.039144 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:01:46.039410 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 13:01:46.040767 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:01:47.854886 (Thread-2): SQL status: SUCCESS 1 in 1.81 seconds
2021-03-31 13:01:47.855155 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:01:47.855308 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 13:01:47.868736 (Thread-3): SQL status: SUCCESS 1 in 1.83 seconds
2021-03-31 13:01:47.868992 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:01:47.869146 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 13:01:47.906651 (Thread-1): SQL status: SUCCESS 1 in 1.87 seconds
2021-03-31 13:01:47.906899 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:01:47.907021 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 13:01:48.338766 (Thread-3): SQL status: SUCCESS 1 in 0.47 seconds
2021-03-31 13:01:48.343528 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:01:48.343733 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:01:48.343843 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:01:48.575480 (Thread-3): SQL status: SUCCESS 1 in 0.23 seconds
2021-03-31 13:01:48.593638 (Thread-3): finished collecting timing info
2021-03-31 13:01:48.593962 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 13:01:48.869032 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-03-31 13:01:48.873307 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:01:48.873605 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:01:48.873734 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:01:48.920381 (Thread-2): SQL status: SUCCESS 1 in 1.06 seconds
2021-03-31 13:01:48.925149 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:01:48.925364 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:01:48.925470 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:01:49.007522 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c5630>]}
2021-03-31 13:01:49.009063 (Thread-3): 21:01:49 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 3.13s]
2021-03-31 13:01:49.009228 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:01:49.073626 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-03-31 13:01:49.081260 (Thread-1): finished collecting timing info
2021-03-31 13:01:49.081542 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 13:01:49.130349 (Thread-2): SQL status: SUCCESS 1 in 0.20 seconds
2021-03-31 13:01:49.134630 (Thread-2): finished collecting timing info
2021-03-31 13:01:49.134990 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 13:01:49.557091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117363940>]}
2021-03-31 13:01:49.557772 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115638320>]}
2021-03-31 13:01:49.559096 (Thread-1): 21:01:49 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 3.68s]
2021-03-31 13:01:49.560243 (Thread-2): 21:01:49 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 3.68s]
2021-03-31 13:01:49.560413 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 13:01:49.560591 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:01:49.561098 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 13:01:49.561250 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:01:49.562338 (Thread-5): 21:01:49 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 13:01:49.563413 (Thread-4): 21:01:49 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 13:01:49.563812 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:01:49.564156 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:01:49.564381 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 13:01:49.564597 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 13:01:49.575119 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:01:49.584284 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:01:49.584820 (Thread-5): finished collecting timing info
2021-03-31 13:01:49.590324 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:01:49.590711 (Thread-4): finished collecting timing info
2021-03-31 13:01:49.595877 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:01:49.596779 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:01:49.597724 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:01:49.597815 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 13:01:49.597925 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 13:01:49.598031 (Thread-4): Opening a new connection, currently in state init
2021-03-31 13:01:49.598127 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:01:51.106852 (Thread-4): SQL status: SUCCESS 1 in 1.51 seconds
2021-03-31 13:01:51.107063 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:01:51.107185 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 13:01:51.299335 (Thread-5): SQL status: SUCCESS 1 in 1.70 seconds
2021-03-31 13:01:51.299584 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:01:51.299733 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (WITH team as (
    select * from DEMO_DB.staging.example_teams
),

team_location AS (
    select * from DEMO_DB.PUBLIC.team_location        
), 

final AS (
    SELECT 
        teams.team,
        team_location.city,
        team_location.state
    from teams
    LEFT JOIN team_location
    ON teams.team = team_location.name
)

SELECT * FROM final
      );
2021-03-31 13:01:51.769349 (Thread-5): Snowflake query id: 019b462d-04ab-f7a7-0000-002da6834765
2021-03-31 13:01:51.769511 (Thread-5): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TEAMS' does not exist or not authorized.
2021-03-31 13:01:51.769677 (Thread-5): finished collecting timing info
2021-03-31 13:01:51.770003 (Thread-5): On model.demo_dbt.example_team_details: ROLLBACK
2021-03-31 13:01:52.036968 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 13:01:52.039100 (Thread-4): SQL status: SUCCESS 1 in 0.93 seconds
2021-03-31 13:01:52.043272 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:01:52.043745 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:01:52.044125 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:01:52.268549 (Thread-4): SQL status: SUCCESS 1 in 0.22 seconds
2021-03-31 13:01:52.273414 (Thread-4): finished collecting timing info
2021-03-31 13:01:52.273735 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 13:01:52.529867 (Thread-5): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'TEAMS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'TEAMS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model example_team_details (models/staging/example/example_team_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'TEAMS' does not exist or not authorized.
  compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 13:01:52.545472 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11558a898>]}
2021-03-31 13:01:52.546764 (Thread-5): 21:01:52 | 4 of 5 ERROR creating table model staging.example_team_details....... [ERROR in 2.98s]
2021-03-31 13:01:52.546924 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 13:01:52.695191 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc1a7ed-48a3-4542-a3b3-2784506d4e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158e2a20>]}
2021-03-31 13:01:52.696452 (Thread-4): 21:01:52 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 3.13s]
2021-03-31 13:01:52.696609 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:01:52.766570 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:01:52.767015 (MainThread): Using snowflake connection "master".
2021-03-31 13:01:52.767171 (MainThread): On master: BEGIN
2021-03-31 13:01:52.767328 (MainThread): Opening a new connection, currently in state closed
2021-03-31 13:01:54.260761 (MainThread): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 13:01:54.261042 (MainThread): On master: COMMIT
2021-03-31 13:01:54.261293 (MainThread): Using snowflake connection "master".
2021-03-31 13:01:54.261443 (MainThread): On master: COMMIT
2021-03-31 13:01:54.552010 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-03-31 13:01:54.552296 (MainThread): On master: Close
2021-03-31 13:01:54.949110 (MainThread): 21:01:54 | 
2021-03-31 13:01:54.949353 (MainThread): 21:01:54 | Finished running 1 view model, 4 table models in 63.06s.
2021-03-31 13:01:54.949508 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:01:54.949621 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 13:01:54.949727 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 13:01:54.949829 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 13:01:54.949929 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 13:01:54.950026 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 13:01:55.026221 (MainThread): 
2021-03-31 13:01:55.026375 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 13:01:55.026470 (MainThread): 
2021-03-31 13:01:55.026561 (MainThread): Database Error in model example_team_details (models/staging/example/example_team_details.sql)
2021-03-31 13:01:55.026642 (MainThread):   002003 (42S02): SQL compilation error:
2021-03-31 13:01:55.026716 (MainThread):   Object 'TEAMS' does not exist or not authorized.
2021-03-31 13:01:55.026850 (MainThread):   compiled SQL at target/run/demo_dbt/models/staging/example/example_team_details.sql
2021-03-31 13:01:55.026960 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-03-31 13:01:55.027142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155ea828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154288d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158ed5f8>]}
2021-03-31 13:01:55.027316 (MainThread): Flushing usage events
2021-03-31 13:18:26.005683 (MainThread): Running with dbt=0.19.0
2021-03-31 13:18:26.641377 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:18:26.642814 (MainThread): Tracking: tracking
2021-03-31 13:18:26.643155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104da9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113001550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113001470>]}
2021-03-31 13:18:26.677436 (MainThread): Partial parsing not enabled
2021-03-31 13:18:26.678631 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:18:26.680417 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:18:26.683025 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:18:26.713911 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:18:26.716346 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:18:26.718062 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:18:26.722468 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:18:26.733967 (MainThread): Parsing macros/core.sql
2021-03-31 13:18:26.738327 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:18:26.747742 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:18:26.749799 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:18:26.768959 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:18:26.803142 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:18:26.825405 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:18:26.827506 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:18:26.834420 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:18:26.849264 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:18:26.856517 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:18:26.863220 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:18:26.868547 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:18:26.869707 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:18:26.870936 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:18:26.872740 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:18:26.882180 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:18:26.884468 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:18:26.886712 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:18:26.931845 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:18:26.934101 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:18:26.935916 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:18:26.937831 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:18:26.942766 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:18:26.944510 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:18:26.946209 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:18:26.949089 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:18:26.956150 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:18:26.957577 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:18:26.959595 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:18:26.962404 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:18:26.963822 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:18:26.966590 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:18:26.976811 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:18:26.979087 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:18:26.980889 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:18:26.983016 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:18:26.985077 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:18:26.986386 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:18:26.990165 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:18:26.995974 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:18:26.997005 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:18:27.000275 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:18:27.002607 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:18:27.004510 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:18:27.007090 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:18:27.034511 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:18:27.036138 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:18:27.037726 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:18:27.039212 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:18:27.044777 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:18:27.047261 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:18:27.050479 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:18:27.052490 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:18:27.054310 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:18:27.056492 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:18:27.059446 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:18:27.062151 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:18:27.064077 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:18:27.066524 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:18:27.068481 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:18:27.072113 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:18:27.074781 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:18:27.076807 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:18:27.079382 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:18:27.084076 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:18:27.091822 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:18:27.093771 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:18:27.097658 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:18:27.102589 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:18:27.106529 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:18:27.108567 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:18:27.112518 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:18:27.120515 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:18:27.129389 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:18:27.131137 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:18:27.135134 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:18:27.137165 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:18:27.139413 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:18:27.147176 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:18:27.152908 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:18:27.157669 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:18:27.166136 (MainThread): Partial parsing not enabled
2021-03-31 13:18:27.212634 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:18:27.275970 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:18:27.295943 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:18:27.314252 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:18:27.328998 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:18:27.561441 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113017390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f77b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ee208>]}
2021-03-31 13:18:27.561653 (MainThread): Flushing usage events
2021-03-31 13:18:32.359185 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 13:18:32.359416 (MainThread): Encountered an error:
2021-03-31 13:18:32.359603 (MainThread): Compilation Error in model example_team_details (models/staging/example/example_team_details.sql)
  Model 'model.demo_dbt.example_team_details' (models/staging/example/example_team_details.sql) depends on a node named 'example__teams' which was not found
2021-03-31 13:18:32.366563 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Library/Python/3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 380, in process_manifest
    process_refs(manifest, project_name)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 750, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 734, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 479, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/Library/Python/3.7/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Library/Python/3.7/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model example_team_details (models/staging/example/example_team_details.sql)
  Model 'model.demo_dbt.example_team_details' (models/staging/example/example_team_details.sql) depends on a node named 'example__teams' which was not found

2021-03-31 13:22:03.351670 (MainThread): Running with dbt=0.19.0
2021-03-31 13:22:03.827011 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:22:03.827650 (MainThread): Tracking: tracking
2021-03-31 13:22:03.828055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca309e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef22e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef22208>]}
2021-03-31 13:22:03.862793 (MainThread): Partial parsing not enabled
2021-03-31 13:22:03.863540 (MainThread): Parsing macros/test_is_even.sql
2021-03-31 13:22:03.864482 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:22:03.865794 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:22:03.867865 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:22:03.897340 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:22:03.899412 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:22:03.900930 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:22:03.904986 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:22:03.915401 (MainThread): Parsing macros/core.sql
2021-03-31 13:22:03.919386 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:22:03.928320 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:22:03.930098 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:22:03.948505 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:22:03.981244 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:22:04.002388 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:22:04.004270 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:22:04.010498 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:22:04.024521 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:22:04.031419 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:22:04.037759 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:22:04.042789 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:22:04.043722 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:22:04.044960 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:22:04.046718 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:22:04.055631 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:22:04.057699 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:22:04.059486 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:22:04.105600 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:22:04.108044 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:22:04.109635 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:22:04.111405 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:22:04.115640 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:22:04.116923 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:22:04.118434 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:22:04.121041 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:22:04.127963 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:22:04.129262 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:22:04.131154 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:22:04.133823 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:22:04.135105 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:22:04.137694 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:22:04.148564 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:22:04.150797 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:22:04.152747 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:22:04.154672 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:22:04.156488 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:22:04.157661 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:22:04.161705 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:22:04.167409 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:22:04.168323 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:22:04.171376 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:22:04.173500 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:22:04.175262 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:22:04.177428 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:22:04.204248 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:22:04.205633 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:22:04.207095 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:22:04.208441 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:22:04.213664 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:22:04.215779 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:22:04.219119 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:22:04.220957 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:22:04.222704 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:22:04.224803 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:22:04.227711 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:22:04.229797 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:22:04.231565 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:22:04.233919 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:22:04.235674 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:22:04.239120 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:22:04.241892 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:22:04.243882 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:22:04.246501 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:22:04.250691 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:22:04.257672 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:22:04.259545 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:22:04.263369 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:22:04.268163 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:22:04.272004 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:22:04.273940 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:22:04.277811 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:22:04.285917 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:22:04.295486 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:22:04.297138 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:22:04.301084 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:22:04.303042 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:22:04.305008 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:22:04.312185 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:22:04.317444 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:22:04.322081 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:22:04.330289 (MainThread): Partial parsing not enabled
2021-03-31 13:22:04.377077 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:22:04.434799 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:04.451706 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:22:04.465991 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:04.477161 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:04.710892 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6242b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da21a90>]}
2021-03-31 13:22:04.711137 (MainThread): Flushing usage events
2021-03-31 13:22:10.742538 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 13:22:10.742690 (MainThread): Encountered an error:
2021-03-31 13:22:10.742837 (MainThread): Compilation Error in model example_team_details (models/staging/example/example_team_details.sql)
  Model 'model.demo_dbt.example_team_details' (models/staging/example/example_team_details.sql) depends on a node named 'team_locations' which was not found
2021-03-31 13:22:10.746333 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.7/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.7/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Library/Python/3.7/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 436, in load_all
    manifest = loader.create_manifest()
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 414, in create_manifest
    self.process_manifest(manifest)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 380, in process_manifest
    process_refs(manifest, project_name)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 750, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 734, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/Library/Python/3.7/site-packages/dbt/parser/manifest.py", line 479, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/Library/Python/3.7/site-packages/dbt/exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Library/Python/3.7/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model example_team_details (models/staging/example/example_team_details.sql)
  Model 'model.demo_dbt.example_team_details' (models/staging/example/example_team_details.sql) depends on a node named 'team_locations' which was not found

2021-03-31 13:22:19.702779 (MainThread): Running with dbt=0.19.0
2021-03-31 13:22:20.183641 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:22:20.184727 (MainThread): Tracking: tracking
2021-03-31 13:22:20.185182 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114033a58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164f9748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164f92b0>]}
2021-03-31 13:22:20.220806 (MainThread): Partial parsing not enabled
2021-03-31 13:22:20.221828 (MainThread): Parsing macros/test_is_even.sql
2021-03-31 13:22:20.223176 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:22:20.224802 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:22:20.227222 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:22:20.257878 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:22:20.260018 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:22:20.261560 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:22:20.265603 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:22:20.276006 (MainThread): Parsing macros/core.sql
2021-03-31 13:22:20.280023 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:22:20.289035 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:22:20.290818 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:22:20.308898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:22:20.342410 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:22:20.364358 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:22:20.366292 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:22:20.372731 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:22:20.387678 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:22:20.394991 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:22:20.401726 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:22:20.407027 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:22:20.408042 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:22:20.409146 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:22:20.410814 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:22:20.420302 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:22:20.422371 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:22:20.424143 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:22:20.470571 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:22:20.472611 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:22:20.474439 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:22:20.476472 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:22:20.481297 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:22:20.482908 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:22:20.484548 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:22:20.487471 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:22:20.494291 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:22:20.495585 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:22:20.497453 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:22:20.500075 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:22:20.501339 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:22:20.503895 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:22:20.513986 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:22:20.516203 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:22:20.518087 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:22:20.520504 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:22:20.522315 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:22:20.523472 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:22:20.527167 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:22:20.532841 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:22:20.533739 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:22:20.536768 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:22:20.538883 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:22:20.540636 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:22:20.542773 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:22:20.570070 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:22:20.571444 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:22:20.572873 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:22:20.574199 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:22:20.579387 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:22:20.581465 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:22:20.584377 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:22:20.586226 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:22:20.587964 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:22:20.590070 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:22:20.592941 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:22:20.595008 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:22:20.596761 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:22:20.599092 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:22:20.600831 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:22:20.604252 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:22:20.606744 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:22:20.608640 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:22:20.610858 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:22:20.614965 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:22:20.621886 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:22:20.623755 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:22:20.627538 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:22:20.632330 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:22:20.636145 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:22:20.638086 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:22:20.641929 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:22:20.649783 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:22:20.658820 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:22:20.660410 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:22:20.664241 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:22:20.666127 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:22:20.668043 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:22:20.674981 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:22:20.679978 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:22:20.684369 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:22:20.692551 (MainThread): Partial parsing not enabled
2021-03-31 13:22:20.737734 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:22:20.796042 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:20.812115 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:22:20.825008 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:20.835937 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:21.142166 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170ed860>]}
2021-03-31 13:22:21.205745 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:22:21.206505 (MainThread): 
2021-03-31 13:22:21.206768 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:22:21.212275 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 13:22:21.226772 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 13:22:21.226899 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 13:22:21.226978 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 13:22:28.637570 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 7.41 seconds
2021-03-31 13:22:28.642499 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 13:22:30.937253 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:22:30.937667 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:22:30.944813 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:22:30.947385 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:22:30.947540 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:22:30.947654 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:22:30.947765 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 13:22:30.947865 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:22:38.753547 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 7.81 seconds
2021-03-31 13:22:38.758783 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:22:40.847962 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 9.90 seconds
2021-03-31 13:22:40.853247 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:22:42.710476 (MainThread): Using snowflake connection "master".
2021-03-31 13:22:42.710665 (MainThread): On master: BEGIN
2021-03-31 13:22:42.710782 (MainThread): Opening a new connection, currently in state init
2021-03-31 13:22:47.042226 (MainThread): SQL status: SUCCESS 1 in 4.33 seconds
2021-03-31 13:22:47.042432 (MainThread): On master: COMMIT
2021-03-31 13:22:47.042617 (MainThread): Using snowflake connection "master".
2021-03-31 13:22:47.042719 (MainThread): On master: COMMIT
2021-03-31 13:22:47.629203 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-03-31 13:22:47.629489 (MainThread): On master: Close
2021-03-31 13:22:49.259244 (MainThread): 21:22:49 | Concurrency: 5 threads (target='dev')
2021-03-31 13:22:49.259402 (MainThread): 21:22:49 | 
2021-03-31 13:22:49.260387 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 13:22:49.261424 (Thread-1): 21:22:49 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 13:22:49.261541 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:22:49.261687 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:22:49.262028 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:49.262888 (Thread-2): 21:22:49 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 13:22:49.263734 (Thread-3): 21:22:49 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 13:22:49.263869 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 13:22:49.264433 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:49.264782 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:49.278811 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:22:49.278948 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:22:49.279086 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 13:22:49.286997 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:22:49.297531 (Thread-1): finished collecting timing info
2021-03-31 13:22:49.297940 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:22:49.326481 (Thread-3): finished collecting timing info
2021-03-31 13:22:49.338220 (Thread-2): finished collecting timing info
2021-03-31 13:22:49.341021 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:22:49.354027 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:22:49.359931 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:22:49.361310 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:49.361875 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:49.362459 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:49.362540 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 13:22:49.362645 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 13:22:49.362745 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 13:22:49.362842 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:22:49.362926 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:22:49.363015 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:22:54.774975 (Thread-3): SQL status: SUCCESS 1 in 5.41 seconds
2021-03-31 13:22:54.775198 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:54.775305 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 13:22:55.006657 (Thread-2): SQL status: SUCCESS 1 in 5.64 seconds
2021-03-31 13:22:55.006857 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:55.006970 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 13:22:55.089374 (Thread-1): SQL status: SUCCESS 1 in 5.73 seconds
2021-03-31 13:22:55.089769 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:55.089941 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 13:22:56.351120 (Thread-3): SQL status: SUCCESS 1 in 1.58 seconds
2021-03-31 13:22:56.356068 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:22:56.356299 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:22:56.356413 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:22:57.230797 (Thread-3): SQL status: SUCCESS 1 in 0.87 seconds
2021-03-31 13:22:57.244418 (Thread-3): finished collecting timing info
2021-03-31 13:22:57.244769 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 13:22:57.909420 (Thread-2): SQL status: SUCCESS 1 in 2.90 seconds
2021-03-31 13:22:57.912700 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:22:57.912866 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:22:57.912945 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:22:58.079577 (Thread-1): SQL status: SUCCESS 1 in 2.99 seconds
2021-03-31 13:22:58.083204 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:22:58.083365 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:22:58.083442 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:22:58.143920 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116eff710>]}
2021-03-31 13:22:58.145271 (Thread-3): 21:22:58 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 8.88s]
2021-03-31 13:22:58.145408 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:22:58.293521 (Thread-2): SQL status: SUCCESS 1 in 0.38 seconds
2021-03-31 13:22:58.298529 (Thread-2): finished collecting timing info
2021-03-31 13:22:58.298752 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 13:22:58.601486 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-03-31 13:22:58.603987 (Thread-1): finished collecting timing info
2021-03-31 13:22:58.604204 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 13:22:59.364018 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117079780>]}
2021-03-31 13:22:59.365777 (Thread-2): 21:22:59 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 10.10s]
2021-03-31 13:22:59.366050 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:22:59.366533 (Thread-5): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:22:59.368787 (Thread-5): 21:22:59 | 4 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 13:22:59.369297 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:22:59.369510 (Thread-5): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 13:22:59.379128 (Thread-5): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:22:59.379970 (Thread-5): finished collecting timing info
2021-03-31 13:22:59.386352 (Thread-5): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:22:59.387620 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:22:59.387749 (Thread-5): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 13:22:59.387855 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:22:59.697335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165c22b0>]}
2021-03-31 13:22:59.698736 (Thread-1): 21:22:59 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 10.44s]
2021-03-31 13:22:59.698891 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 13:22:59.699192 (Thread-3): Began running node model.demo_dbt.example_team_details
2021-03-31 13:22:59.700297 (Thread-3): 21:22:59 | 5 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 13:22:59.700610 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:22:59.700814 (Thread-3): Compiling model.demo_dbt.example_team_details
2021-03-31 13:22:59.711916 (Thread-3): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:22:59.713234 (Thread-3): finished collecting timing info
2021-03-31 13:22:59.719402 (Thread-3): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:22:59.721342 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:22:59.721505 (Thread-3): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 13:22:59.721696 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 13:23:03.692601 (Thread-5): SQL status: SUCCESS 1 in 4.30 seconds
2021-03-31 13:23:03.692820 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:23:03.692942 (Thread-5): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 13:23:05.778161 (Thread-5): SQL status: SUCCESS 1 in 2.09 seconds
2021-03-31 13:23:05.783053 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:23:05.783279 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:23:05.783383 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:23:07.373128 (Thread-3): SQL status: SUCCESS 1 in 7.65 seconds
2021-03-31 13:23:07.373377 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:23:07.373526 (Thread-3): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 13:23:09.683160 (Thread-3): SQL status: SUCCESS 1 in 2.31 seconds
2021-03-31 13:23:09.688206 (Thread-3): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:23:09.688526 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:23:09.688685 (Thread-3): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:23:10.474318 (Thread-3): SQL status: SUCCESS 1 in 0.79 seconds
2021-03-31 13:23:10.476191 (Thread-3): finished collecting timing info
2021-03-31 13:23:10.476407 (Thread-3): On model.demo_dbt.example_team_details: Close
2021-03-31 13:23:10.905097 (Thread-5): SQL status: SUCCESS 1 in 5.12 seconds
2021-03-31 13:23:10.907796 (Thread-5): finished collecting timing info
2021-03-31 13:23:10.908033 (Thread-5): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 13:23:12.828281 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11502f3c8>]}
2021-03-31 13:23:12.829282 (Thread-3): 21:23:12 | 5 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 13.13s]
2021-03-31 13:23:12.829416 (Thread-3): Finished running node model.demo_dbt.example_team_details
2021-03-31 13:23:12.942802 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbec2f9-3c3a-4b98-9c36-06d03dabbd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116da6160>]}
2021-03-31 13:23:12.943760 (Thread-5): 21:23:12 | 4 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 13.57s]
2021-03-31 13:23:12.943882 (Thread-5): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:23:13.001927 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:23:13.002146 (MainThread): Using snowflake connection "master".
2021-03-31 13:23:13.002228 (MainThread): On master: BEGIN
2021-03-31 13:23:13.002302 (MainThread): Opening a new connection, currently in state closed
2021-03-31 13:23:19.221175 (MainThread): SQL status: SUCCESS 1 in 6.22 seconds
2021-03-31 13:23:19.221332 (MainThread): On master: COMMIT
2021-03-31 13:23:19.221462 (MainThread): Using snowflake connection "master".
2021-03-31 13:23:19.221535 (MainThread): On master: COMMIT
2021-03-31 13:23:20.031664 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-03-31 13:23:20.031964 (MainThread): On master: Close
2021-03-31 13:23:24.784130 (MainThread): 21:23:24 | 
2021-03-31 13:23:24.784363 (MainThread): 21:23:24 | Finished running 1 view model, 4 table models in 63.58s.
2021-03-31 13:23:24.784510 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:23:24.784619 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 13:23:24.784725 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 13:23:24.784823 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 13:23:24.784920 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 13:23:24.863496 (MainThread): 
2021-03-31 13:23:24.863669 (MainThread): Completed successfully
2021-03-31 13:23:24.863791 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 13:23:24.864000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d7b630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fd79e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11710f2b0>]}
2021-03-31 13:23:24.864258 (MainThread): Flushing usage events
2021-03-31 13:30:47.436682 (MainThread): Running with dbt=0.19.0
2021-03-31 13:30:47.980151 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:30:47.981163 (MainThread): Tracking: tracking
2021-03-31 13:30:47.981489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f29e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee1780>]}
2021-03-31 13:30:48.022402 (MainThread): Partial parsing not enabled
2021-03-31 13:30:48.023344 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:30:48.024485 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:30:48.026052 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:30:48.028525 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:30:48.058918 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:30:48.060994 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:30:48.062521 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:30:48.066533 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:30:48.077065 (MainThread): Parsing macros/core.sql
2021-03-31 13:30:48.081031 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:30:48.090136 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:30:48.091937 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:30:48.110113 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:30:48.146002 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:30:48.171698 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:30:48.173786 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:30:48.180362 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:30:48.195386 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:30:48.202600 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:30:48.209723 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:30:48.214787 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:30:48.216049 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:30:48.217379 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:30:48.218990 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:30:48.229188 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:30:48.231185 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:30:48.233484 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:30:48.279096 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:30:48.281107 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:30:48.282664 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:30:48.284395 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:30:48.288978 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:30:48.290478 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:30:48.291981 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:30:48.294543 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:30:48.301525 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:30:48.302814 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:30:48.304869 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:30:48.307587 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:30:48.308856 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:30:48.311389 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:30:48.321759 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:30:48.324075 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:30:48.325726 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:30:48.327598 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:30:48.329365 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:30:48.330500 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:30:48.334086 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:30:48.339967 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:30:48.340925 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:30:48.343950 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:30:48.346106 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:30:48.347855 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:30:48.349932 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:30:48.376698 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:30:48.378086 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:30:48.379527 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:30:48.380851 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:30:48.386737 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:30:48.389772 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:30:48.393763 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:30:48.395863 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:30:48.397875 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:30:48.400367 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:30:48.403906 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:30:48.406516 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:30:48.408619 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:30:48.411331 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:30:48.413346 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:30:48.417215 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:30:48.419822 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:30:48.421773 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:30:48.423992 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:30:48.428053 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:30:48.434896 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:30:48.436708 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:30:48.440616 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:30:48.445352 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:30:48.449132 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:30:48.451146 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:30:48.455101 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:30:48.462957 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:30:48.472087 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:30:48.473774 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:30:48.477660 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:30:48.479540 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:30:48.481425 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:30:48.488479 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:30:48.493699 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:30:48.498042 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:30:48.506535 (MainThread): Partial parsing not enabled
2021-03-31 13:30:48.554990 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:30:48.630804 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:30:48.651399 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:30:48.669572 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:30:48.685420 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:30:49.042200 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c79f358>]}
2021-03-31 13:30:49.127258 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:30:49.128801 (MainThread): 
2021-03-31 13:30:49.129417 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:30:49.139769 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 13:30:49.159784 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 13:30:49.159974 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 13:30:49.160156 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 13:30:53.452412 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.29 seconds
2021-03-31 13:30:53.455541 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 13:30:54.802401 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:30:54.802833 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:30:54.811406 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:30:54.813872 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:30:54.814006 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:30:54.814115 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:30:54.814221 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 13:30:54.814322 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:31:01.802515 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 6.99 seconds
2021-03-31 13:31:01.807958 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:31:06.701478 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 11.89 seconds
2021-03-31 13:31:06.705718 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:31:08.603836 (MainThread): Using snowflake connection "master".
2021-03-31 13:31:08.603985 (MainThread): On master: BEGIN
2021-03-31 13:31:08.604081 (MainThread): Opening a new connection, currently in state init
2021-03-31 13:31:13.674908 (MainThread): SQL status: SUCCESS 1 in 5.07 seconds
2021-03-31 13:31:13.675159 (MainThread): On master: COMMIT
2021-03-31 13:31:13.675375 (MainThread): Using snowflake connection "master".
2021-03-31 13:31:13.675637 (MainThread): On master: COMMIT
2021-03-31 13:31:14.068622 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-03-31 13:31:14.068907 (MainThread): On master: Close
2021-03-31 13:31:14.779791 (MainThread): 21:31:14 | Concurrency: 5 threads (target='dev')
2021-03-31 13:31:14.779955 (MainThread): 21:31:14 | 
2021-03-31 13:31:14.781076 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 13:31:14.781210 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:31:14.781347 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:31:14.782460 (Thread-1): 21:31:14 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 13:31:14.783335 (Thread-2): 21:31:14 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 13:31:14.784205 (Thread-3): 21:31:14 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 13:31:14.784507 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:31:14.785084 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:31:14.785292 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:31:14.785412 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 13:31:14.785522 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 13:31:14.785624 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:31:14.812761 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:31:14.813184 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:31:14.821128 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:31:14.821873 (Thread-1): finished collecting timing info
2021-03-31 13:31:14.822193 (Thread-3): finished collecting timing info
2021-03-31 13:31:14.822401 (Thread-2): finished collecting timing info
2021-03-31 13:31:14.881120 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:31:14.883403 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:31:14.883638 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:31:14.884686 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:31:14.884800 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 13:31:14.885396 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:31:14.885924 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:31:14.886045 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:31:14.886143 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 13:31:14.886251 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 13:31:14.886848 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:31:14.887016 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:31:17.502342 (Thread-3): SQL status: SUCCESS 1 in 2.62 seconds
2021-03-31 13:31:17.502565 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:31:17.502690 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 13:31:17.531736 (Thread-2): SQL status: SUCCESS 1 in 2.64 seconds
2021-03-31 13:31:17.531991 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:31:17.532147 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 13:31:17.702329 (Thread-1): SQL status: SUCCESS 1 in 2.82 seconds
2021-03-31 13:31:17.702575 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:31:17.702725 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 13:31:18.751574 (Thread-2): SQL status: SUCCESS 1 in 1.22 seconds
2021-03-31 13:31:18.755246 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:31:18.755451 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:31:18.755542 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:31:19.158180 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-03-31 13:31:19.161491 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:31:19.161648 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:31:19.161733 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:31:19.552539 (Thread-3): SQL status: SUCCESS 1 in 2.05 seconds
2021-03-31 13:31:19.557119 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:31:19.557347 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:31:19.557455 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:31:19.602673 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 13:31:19.618669 (Thread-1): finished collecting timing info
2021-03-31 13:31:19.618972 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 13:31:20.202150 (Thread-3): SQL status: SUCCESS 1 in 0.64 seconds
2021-03-31 13:31:20.206337 (Thread-3): finished collecting timing info
2021-03-31 13:31:20.206644 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 13:31:20.302990 (Thread-2): SQL status: SUCCESS 1 in 1.55 seconds
2021-03-31 13:31:20.305910 (Thread-2): finished collecting timing info
2021-03-31 13:31:20.306262 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 13:31:20.615585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb05320>]}
2021-03-31 13:31:20.616778 (Thread-1): 21:31:20 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 5.83s]
2021-03-31 13:31:20.617704 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 13:31:20.618766 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 13:31:20.620101 (Thread-5): 21:31:20 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 13:31:20.620522 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:31:20.620844 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 13:31:20.632677 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:31:20.633178 (Thread-5): finished collecting timing info
2021-03-31 13:31:20.638461 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:31:20.639794 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:31:20.639920 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 13:31:20.640016 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:31:21.185190 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f1240>]}
2021-03-31 13:31:21.186201 (Thread-3): 21:31:21 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 6.40s]
2021-03-31 13:31:21.186380 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:31:21.309548 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f1160>]}
2021-03-31 13:31:21.310599 (Thread-2): 21:31:21 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 6.52s]
2021-03-31 13:31:21.310736 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:31:21.311052 (Thread-1): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:31:21.312039 (Thread-1): 21:31:21 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 13:31:21.312348 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:31:21.312463 (Thread-1): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 13:31:21.319830 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:31:21.320195 (Thread-1): finished collecting timing info
2021-03-31 13:31:21.325295 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:31:21.326089 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:31:21.326184 (Thread-1): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 13:31:21.326262 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:31:25.054419 (Thread-5): SQL status: SUCCESS 1 in 4.41 seconds
2021-03-31 13:31:25.054578 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:31:25.054659 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 13:31:26.727189 (Thread-1): SQL status: SUCCESS 1 in 5.40 seconds
2021-03-31 13:31:26.727357 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:31:26.727447 (Thread-1): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 13:31:28.908781 (Thread-1): SQL status: SUCCESS 1 in 2.18 seconds
2021-03-31 13:31:28.911887 (Thread-1): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:31:28.912073 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:31:28.912157 (Thread-1): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:31:29.577797 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-03-31 13:31:29.579669 (Thread-1): finished collecting timing info
2021-03-31 13:31:29.579883 (Thread-1): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 13:31:30.161981 (Thread-5): SQL status: SUCCESS 1 in 5.11 seconds
2021-03-31 13:31:30.166429 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:31:30.166647 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:31:30.166751 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:31:30.505261 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beb3860>]}
2021-03-31 13:31:30.507093 (Thread-1): 21:31:30 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 9.19s]
2021-03-31 13:31:30.507366 (Thread-1): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:31:30.514276 (Thread-5): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 13:31:30.517092 (Thread-5): finished collecting timing info
2021-03-31 13:31:30.517426 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 13:31:31.576468 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a6c363-f643-4adc-8d45-e00d0fc8367e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa7ac8>]}
2021-03-31 13:31:31.577498 (Thread-5): 21:31:31 | 4 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 10.96s]
2021-03-31 13:31:31.577628 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 13:31:31.663589 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:31:31.663811 (MainThread): Using snowflake connection "master".
2021-03-31 13:31:31.663890 (MainThread): On master: BEGIN
2021-03-31 13:31:31.663965 (MainThread): Opening a new connection, currently in state closed
2021-03-31 13:31:35.517911 (MainThread): SQL status: SUCCESS 1 in 3.85 seconds
2021-03-31 13:31:35.518069 (MainThread): On master: COMMIT
2021-03-31 13:31:35.518200 (MainThread): Using snowflake connection "master".
2021-03-31 13:31:35.518276 (MainThread): On master: COMMIT
2021-03-31 13:31:36.282261 (MainThread): SQL status: SUCCESS 1 in 0.76 seconds
2021-03-31 13:31:36.282461 (MainThread): On master: Close
2021-03-31 13:31:37.653637 (MainThread): 21:31:37 | 
2021-03-31 13:31:37.653837 (MainThread): 21:31:37 | Finished running 4 table models, 1 view model in 48.52s.
2021-03-31 13:31:37.654272 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:31:37.654391 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 13:31:37.654479 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 13:31:37.654548 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 13:31:37.654626 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 13:31:37.722421 (MainThread): 
2021-03-31 13:31:37.722575 (MainThread): Completed successfully
2021-03-31 13:31:37.722682 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 13:31:37.722833 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e60d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e601320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb086d8>]}
2021-03-31 13:31:37.723009 (MainThread): Flushing usage events
2021-03-31 13:31:46.454145 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-03-31 13:31:46.454402 (MainThread): Error sending message, disabling tracking
2021-03-31 13:33:40.491985 (MainThread): Running with dbt=0.19.0
2021-03-31 13:33:40.978119 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:33:40.979005 (MainThread): Tracking: tracking
2021-03-31 13:33:40.979318 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108602400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108602438>]}
2021-03-31 13:33:41.014474 (MainThread): Partial parsing not enabled
2021-03-31 13:33:41.015385 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:33:41.016572 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:33:41.017900 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:33:41.020094 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:33:41.052947 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:33:41.055569 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:33:41.057088 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:33:41.061120 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:33:41.071516 (MainThread): Parsing macros/core.sql
2021-03-31 13:33:41.075466 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:33:41.084457 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:33:41.086278 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:33:41.104868 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:33:41.137999 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:33:41.159951 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:33:41.161884 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:33:41.168647 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:33:41.183299 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:33:41.190364 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:33:41.196778 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:33:41.202068 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:33:41.203170 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:33:41.204247 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:33:41.206044 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:33:41.215173 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:33:41.217145 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:33:41.218897 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:33:41.262969 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:33:41.264949 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:33:41.266520 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:33:41.268276 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:33:41.272542 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:33:41.273819 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:33:41.275289 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:33:41.277910 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:33:41.284697 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:33:41.286009 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:33:41.287875 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:33:41.290479 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:33:41.291726 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:33:41.294275 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:33:41.304261 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:33:41.306367 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:33:41.307986 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:33:41.309867 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:33:41.311637 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:33:41.312770 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:33:41.316362 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:33:41.321951 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:33:41.322837 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:33:41.325827 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:33:41.327903 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:33:41.329623 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:33:41.331734 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:33:41.358552 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:33:41.359929 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:33:41.361342 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:33:41.362741 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:33:41.368696 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:33:41.370752 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:33:41.373722 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:33:41.375523 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:33:41.377469 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:33:41.379509 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:33:41.382273 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:33:41.384252 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:33:41.385942 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:33:41.388244 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:33:41.389904 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:33:41.393229 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:33:41.395663 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:33:41.397479 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:33:41.399613 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:33:41.403894 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:33:41.410657 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:33:41.412446 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:33:41.416102 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:33:41.420860 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:33:41.424534 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:33:41.426380 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:33:41.430177 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:33:41.437732 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:33:41.446410 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:33:41.448074 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:33:41.451811 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:33:41.453863 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:33:41.455712 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:33:41.462414 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:33:41.467354 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:33:41.471624 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:33:41.479885 (MainThread): Partial parsing not enabled
2021-03-31 13:33:41.523302 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:33:41.584104 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:33:41.602455 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:33:41.617899 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:33:41.630515 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:33:41.940128 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e40f0>]}
2021-03-31 13:33:42.006912 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:33:42.007914 (MainThread): 
2021-03-31 13:33:42.008227 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:33:42.014113 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 13:33:42.026587 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 13:33:42.026699 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 13:33:42.026773 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 13:33:45.919109 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.89 seconds
2021-03-31 13:33:45.923917 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 13:33:47.117519 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:33:47.117902 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:33:47.124878 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:33:47.127110 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:33:47.127233 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:33:47.127348 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:33:47.127489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 13:33:47.127594 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:33:50.665382 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 3.54 seconds
2021-03-31 13:33:50.670278 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:33:50.785750 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 3.66 seconds
2021-03-31 13:33:50.789086 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:33:52.187763 (MainThread): Using snowflake connection "master".
2021-03-31 13:33:52.187943 (MainThread): On master: BEGIN
2021-03-31 13:33:52.188065 (MainThread): Opening a new connection, currently in state init
2021-03-31 13:33:55.755027 (MainThread): SQL status: SUCCESS 1 in 3.57 seconds
2021-03-31 13:33:55.755312 (MainThread): On master: COMMIT
2021-03-31 13:33:55.755532 (MainThread): Using snowflake connection "master".
2021-03-31 13:33:55.755654 (MainThread): On master: COMMIT
2021-03-31 13:33:56.667023 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-03-31 13:33:56.667183 (MainThread): On master: Close
2021-03-31 13:33:57.874999 (MainThread): 21:33:57 | Concurrency: 5 threads (target='dev')
2021-03-31 13:33:57.875231 (MainThread): 21:33:57 | 
2021-03-31 13:33:57.876698 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 13:33:57.876958 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:33:57.878379 (Thread-1): 21:33:57 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 13:33:57.878535 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:33:57.879704 (Thread-2): 21:33:57 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 13:33:57.880051 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:33:57.881596 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:33:57.881982 (Thread-3): 21:33:57 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 13:33:57.882137 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 13:33:57.882266 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 13:33:57.882554 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:33:57.913746 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:33:57.916186 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:33:57.916312 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:33:57.925326 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:33:57.925734 (Thread-1): finished collecting timing info
2021-03-31 13:33:57.931995 (Thread-2): finished collecting timing info
2021-03-31 13:33:57.949587 (Thread-3): finished collecting timing info
2021-03-31 13:33:58.002586 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:33:58.004376 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:33:58.006955 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:33:58.007834 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:33:58.007927 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 13:33:58.008010 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:33:58.009536 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:33:58.010122 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:33:58.010344 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 13:33:58.010969 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 13:33:58.011087 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:33:58.011179 (Thread-2): Opening a new connection, currently in state init
2021-03-31 13:34:00.637217 (Thread-1): SQL status: SUCCESS 1 in 2.63 seconds
2021-03-31 13:34:00.637468 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:00.637606 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 13:34:00.710666 (Thread-2): SQL status: SUCCESS 1 in 2.70 seconds
2021-03-31 13:34:00.710839 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:00.710938 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 13:34:00.916501 (Thread-3): SQL status: SUCCESS 1 in 2.91 seconds
2021-03-31 13:34:00.916728 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:00.916840 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 13:34:01.837358 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2021-03-31 13:34:01.844162 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:34:01.844480 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:01.844686 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:34:01.953808 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-03-31 13:34:01.958492 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:34:01.958751 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:01.958877 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:34:02.204602 (Thread-2): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 13:34:02.210422 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:34:02.210709 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:02.210833 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:34:02.504053 (Thread-3): SQL status: SUCCESS 1 in 0.66 seconds
2021-03-31 13:34:02.520688 (Thread-3): finished collecting timing info
2021-03-31 13:34:02.521018 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 13:34:02.673552 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-03-31 13:34:02.682901 (Thread-1): finished collecting timing info
2021-03-31 13:34:02.683410 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 13:34:02.917161 (Thread-2): SQL status: SUCCESS 1 in 0.71 seconds
2021-03-31 13:34:02.920682 (Thread-2): finished collecting timing info
2021-03-31 13:34:02.921102 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 13:34:03.590327 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108813128>]}
2021-03-31 13:34:03.593233 (Thread-3): 21:34:03 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 5.71s]
2021-03-31 13:34:03.593546 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:34:03.681871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873bd68>]}
2021-03-31 13:34:03.683073 (Thread-1): 21:34:03 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 5.80s]
2021-03-31 13:34:03.683225 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 13:34:03.683607 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 13:34:03.684677 (Thread-5): 21:34:03 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 13:34:03.685024 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:03.685232 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 13:34:03.697308 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:34:03.697814 (Thread-5): finished collecting timing info
2021-03-31 13:34:03.703044 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:34:03.704256 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:03.704364 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 13:34:03.704460 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:34:03.870094 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086274a8>]}
2021-03-31 13:34:03.871286 (Thread-2): 21:34:03 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 5.99s]
2021-03-31 13:34:03.871437 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:34:03.871831 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:34:03.873529 (Thread-3): 21:34:03 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 13:34:03.874216 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:03.874422 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 13:34:03.884582 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:34:03.885044 (Thread-3): finished collecting timing info
2021-03-31 13:34:03.891749 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:34:03.892762 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:03.892891 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 13:34:03.892996 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 13:34:06.383739 (Thread-5): SQL status: SUCCESS 1 in 2.68 seconds
2021-03-31 13:34:06.383905 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:06.384000 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 13:34:06.653684 (Thread-3): SQL status: SUCCESS 1 in 2.76 seconds
2021-03-31 13:34:06.653851 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:06.653945 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 13:34:07.733829 (Thread-5): SQL status: SUCCESS 1 in 1.35 seconds
2021-03-31 13:34:07.737943 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:34:07.738138 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:07.738254 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:34:08.053786 (Thread-3): SQL status: SUCCESS 1 in 1.40 seconds
2021-03-31 13:34:08.058253 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:34:08.058503 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:08.058613 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:34:08.303772 (Thread-5): SQL status: SUCCESS 1 in 0.57 seconds
2021-03-31 13:34:08.306963 (Thread-5): finished collecting timing info
2021-03-31 13:34:08.307290 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 13:34:09.081365 (Thread-3): SQL status: SUCCESS 1 in 1.02 seconds
2021-03-31 13:34:09.083705 (Thread-3): finished collecting timing info
2021-03-31 13:34:09.083978 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 13:34:09.640790 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873b4e0>]}
2021-03-31 13:34:09.642318 (Thread-5): 21:34:09 | 4 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 5.96s]
2021-03-31 13:34:09.642513 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 13:34:10.056044 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8ec9b75-ff3a-4aac-bae3-d67ddae16281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4c5f8>]}
2021-03-31 13:34:10.058103 (Thread-3): 21:34:10 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 6.18s]
2021-03-31 13:34:10.058326 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:34:10.094220 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:34:10.094576 (MainThread): Using snowflake connection "master".
2021-03-31 13:34:10.094773 (MainThread): On master: BEGIN
2021-03-31 13:34:10.094899 (MainThread): Opening a new connection, currently in state closed
2021-03-31 13:34:17.334029 (MainThread): SQL status: SUCCESS 1 in 7.24 seconds
2021-03-31 13:34:17.334195 (MainThread): On master: COMMIT
2021-03-31 13:34:17.334327 (MainThread): Using snowflake connection "master".
2021-03-31 13:34:17.334400 (MainThread): On master: COMMIT
2021-03-31 13:34:18.104452 (MainThread): SQL status: SUCCESS 1 in 0.77 seconds
2021-03-31 13:34:18.104728 (MainThread): On master: Close
2021-03-31 13:34:19.027329 (MainThread): 21:34:19 | 
2021-03-31 13:34:19.027526 (MainThread): 21:34:19 | Finished running 1 view model, 4 table models in 37.02s.
2021-03-31 13:34:19.027654 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:34:19.027812 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 13:34:19.027975 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 13:34:19.028103 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 13:34:19.028254 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 13:34:19.028357 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 13:34:19.123709 (MainThread): 
2021-03-31 13:34:19.123959 (MainThread): Completed successfully
2021-03-31 13:34:19.124250 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 13:34:19.124670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c37ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3b908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108813128>]}
2021-03-31 13:34:19.125026 (MainThread): Flushing usage events
2021-03-31 13:34:30.794634 (MainThread): Running with dbt=0.19.0
2021-03-31 13:34:31.401151 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 13:34:31.402185 (MainThread): Tracking: tracking
2021-03-31 13:34:31.402577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c15f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7d748>]}
2021-03-31 13:34:31.446709 (MainThread): Partial parsing not enabled
2021-03-31 13:34:31.447648 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:34:31.448762 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:34:31.450364 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:34:31.452914 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:34:31.489924 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:34:31.492792 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:34:31.494884 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:34:31.499832 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:34:31.512824 (MainThread): Parsing macros/core.sql
2021-03-31 13:34:31.517613 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:34:31.529227 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:34:31.531496 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:34:31.554298 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:34:31.599881 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:34:31.630429 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:34:31.633076 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:34:31.641650 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:34:31.660715 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:34:31.669567 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:34:31.677529 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:34:31.682778 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:34:31.683779 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:34:31.684864 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:34:31.686558 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:34:31.696314 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:34:31.698622 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:34:31.700475 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:34:31.746679 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:34:31.748676 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:34:31.750261 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:34:31.752024 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:34:31.757007 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:34:31.758676 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:34:31.760545 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:34:31.763819 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:34:31.771108 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:34:31.772574 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:34:31.774906 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:34:31.777841 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:34:31.779181 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:34:31.781799 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:34:31.792662 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:34:31.795004 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:34:31.796672 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:34:31.798592 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:34:31.800400 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:34:31.801584 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:34:31.805338 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:34:31.811543 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:34:31.812497 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:34:31.815535 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:34:31.817962 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:34:31.819795 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:34:31.822036 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:34:31.861817 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:34:31.863729 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:34:31.865698 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:34:31.867520 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:34:31.875558 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:34:31.878440 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:34:31.882489 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:34:31.885023 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:34:31.887224 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:34:31.890573 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:34:31.894534 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:34:31.897133 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:34:31.899325 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:34:31.902144 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:34:31.904264 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:34:31.909146 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:34:31.912301 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:34:31.914717 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:34:31.917277 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:34:31.921511 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:34:31.928750 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:34:31.930775 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:34:31.934692 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:34:31.939714 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:34:31.944228 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:34:31.946351 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:34:31.950621 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:34:31.959738 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:34:31.968898 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:34:31.970611 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:34:31.974854 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:34:31.976876 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:34:31.978869 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:34:31.985897 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:34:31.991832 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:34:31.996549 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:34:32.004987 (MainThread): Partial parsing not enabled
2021-03-31 13:34:32.052294 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:32.127376 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:32.147413 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:32.165352 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:32.179650 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:32.525019 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaace10>]}
2021-03-31 13:34:32.602160 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:34:32.603280 (MainThread): 
2021-03-31 13:34:32.603708 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:34:32.611763 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 13:34:32.629253 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 13:34:32.629406 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 13:34:32.629508 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 13:34:37.884000 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.25 seconds
2021-03-31 13:34:37.889074 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 13:34:39.444702 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:34:39.445169 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:34:39.453843 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:34:39.456417 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:34:39.456569 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:34:39.456682 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:34:39.456892 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:34:39.456790 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 13:34:43.425611 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 3.97 seconds
2021-03-31 13:34:43.429866 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:34:45.304098 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 5.85 seconds
2021-03-31 13:34:45.308718 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:34:46.058272 (MainThread): Using snowflake connection "master".
2021-03-31 13:34:46.058475 (MainThread): On master: BEGIN
2021-03-31 13:34:46.058606 (MainThread): Opening a new connection, currently in state init
2021-03-31 13:34:48.883554 (MainThread): SQL status: SUCCESS 1 in 2.82 seconds
2021-03-31 13:34:48.883712 (MainThread): On master: COMMIT
2021-03-31 13:34:48.883843 (MainThread): Using snowflake connection "master".
2021-03-31 13:34:48.883918 (MainThread): On master: COMMIT
2021-03-31 13:34:49.430639 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2021-03-31 13:34:49.430838 (MainThread): On master: Close
2021-03-31 13:34:50.518722 (MainThread): 21:34:50 | Concurrency: 5 threads (target='dev')
2021-03-31 13:34:50.518923 (MainThread): 21:34:50 | 
2021-03-31 13:34:50.520129 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 13:34:50.520286 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:34:50.520456 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:34:50.521715 (Thread-1): 21:34:50 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 13:34:50.522871 (Thread-2): 21:34:50 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 13:34:50.523992 (Thread-3): 21:34:50 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 13:34:50.524486 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:50.524762 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:50.525392 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:50.525556 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 13:34:50.525702 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 13:34:50.525881 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:34:50.560797 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:34:50.561569 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:34:50.566259 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:34:50.566908 (Thread-2): finished collecting timing info
2021-03-31 13:34:50.573493 (Thread-1): finished collecting timing info
2021-03-31 13:34:50.596180 (Thread-3): finished collecting timing info
2021-03-31 13:34:50.653677 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 13:34:50.667713 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 13:34:50.669241 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 13:34:50.670364 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:50.670478 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 13:34:50.670578 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:34:50.671877 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:50.671994 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 13:34:50.672736 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:34:50.674179 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:50.675235 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 13:34:50.675976 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:34:53.659192 (Thread-1): SQL status: SUCCESS 1 in 2.98 seconds
2021-03-31 13:34:53.659345 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:53.659457 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 13:34:53.720453 (Thread-3): SQL status: SUCCESS 1 in 3.05 seconds
2021-03-31 13:34:53.720595 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:53.720671 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 13:34:53.772468 (Thread-2): SQL status: SUCCESS 1 in 3.10 seconds
2021-03-31 13:34:53.772653 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:53.772766 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 13:34:54.431134 (Thread-3): SQL status: SUCCESS 1 in 0.71 seconds
2021-03-31 13:34:54.436630 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:34:54.436827 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:34:54.436931 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 13:34:54.954850 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-03-31 13:34:54.960442 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:34:54.960685 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:34:54.960796 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 13:34:54.974498 (Thread-3): SQL status: SUCCESS 1 in 0.54 seconds
2021-03-31 13:34:54.987368 (Thread-3): finished collecting timing info
2021-03-31 13:34:54.987658 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 13:34:55.005389 (Thread-2): SQL status: SUCCESS 1 in 1.23 seconds
2021-03-31 13:34:55.010294 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:34:55.010477 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:34:55.010581 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 13:34:55.421079 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-03-31 13:34:55.428453 (Thread-1): finished collecting timing info
2021-03-31 13:34:55.428767 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 13:34:55.454320 (Thread-2): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 13:34:55.457064 (Thread-2): finished collecting timing info
2021-03-31 13:34:55.457406 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 13:34:55.815685 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5ae10>]}
2021-03-31 13:34:55.816685 (Thread-3): 21:34:55 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 5.29s]
2021-03-31 13:34:55.817384 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 13:34:56.838462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9ec88>]}
2021-03-31 13:34:56.839178 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c3f60>]}
2021-03-31 13:34:56.840557 (Thread-1): 21:34:56 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 6.31s]
2021-03-31 13:34:56.841785 (Thread-2): 21:34:56 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 6.31s]
2021-03-31 13:34:56.841985 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 13:34:56.842158 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 13:34:56.843052 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 13:34:56.843267 (Thread-4): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:34:56.844780 (Thread-5): 21:34:56 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 13:34:56.845898 (Thread-4): 21:34:56 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 13:34:56.846257 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:56.846636 (Thread-4): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:56.846776 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 13:34:56.846921 (Thread-4): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 13:34:56.859648 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:34:56.869020 (Thread-4): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:34:56.869665 (Thread-5): finished collecting timing info
2021-03-31 13:34:56.876003 (Thread-4): finished collecting timing info
2021-03-31 13:34:56.876378 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 13:34:56.882446 (Thread-4): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 13:34:56.883552 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:56.883683 (Thread-4): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 13:34:56.883793 (Thread-4): Opening a new connection, currently in state init
2021-03-31 13:34:56.885489 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:56.885615 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 13:34:56.886327 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:34:59.615230 (Thread-4): SQL status: SUCCESS 1 in 2.73 seconds
2021-03-31 13:34:59.615377 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:34:59.615460 (Thread-4): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 13:34:59.704558 (Thread-5): SQL status: SUCCESS 1 in 2.82 seconds
2021-03-31 13:34:59.704770 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:34:59.704846 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 13:35:01.555792 (Thread-5): SQL status: SUCCESS 1 in 1.85 seconds
2021-03-31 13:35:01.556267 (Thread-4): SQL status: SUCCESS 1 in 1.94 seconds
2021-03-31 13:35:01.560849 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:35:01.565073 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:35:01.565341 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:35:01.565524 (Thread-4): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:35:01.565665 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 13:35:01.565804 (Thread-4): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 13:35:02.254366 (Thread-5): SQL status: SUCCESS 1 in 0.69 seconds
2021-03-31 13:35:02.257076 (Thread-5): finished collecting timing info
2021-03-31 13:35:02.257308 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 13:35:03.358183 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5af28>]}
2021-03-31 13:35:03.359882 (Thread-5): 21:35:03 | 4 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 6.51s]
2021-03-31 13:35:03.360092 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 13:35:04.818202 (Thread-4): SQL status: SUCCESS 1 in 3.25 seconds
2021-03-31 13:35:04.821067 (Thread-4): finished collecting timing info
2021-03-31 13:35:04.821406 (Thread-4): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 13:35:06.657600 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c708d0b-0dc1-4fa6-a2e6-8c4685b30f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a167d68>]}
2021-03-31 13:35:06.658593 (Thread-4): 21:35:06 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 9.81s]
2021-03-31 13:35:06.658720 (Thread-4): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 13:35:06.705340 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:35:06.705669 (MainThread): Using snowflake connection "master".
2021-03-31 13:35:06.705790 (MainThread): On master: BEGIN
2021-03-31 13:35:06.705882 (MainThread): Opening a new connection, currently in state closed
2021-03-31 13:35:14.082550 (MainThread): SQL status: SUCCESS 1 in 7.38 seconds
2021-03-31 13:35:14.082709 (MainThread): On master: COMMIT
2021-03-31 13:35:14.082841 (MainThread): Using snowflake connection "master".
2021-03-31 13:35:14.082916 (MainThread): On master: COMMIT
2021-03-31 13:35:15.028953 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-03-31 13:35:15.029235 (MainThread): On master: Close
2021-03-31 13:35:16.806057 (MainThread): 21:35:16 | 
2021-03-31 13:35:16.806277 (MainThread): 21:35:16 | Finished running 1 view model, 4 table models in 44.20s.
2021-03-31 13:35:16.806405 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:35:16.806475 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 13:35:16.806544 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 13:35:16.806861 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 13:35:16.806986 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 13:35:16.807098 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 13:35:16.876741 (MainThread): 
2021-03-31 13:35:16.876891 (MainThread): Completed successfully
2021-03-31 13:35:16.876999 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 13:35:16.877174 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa79b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a81cd68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc6eb8>]}
2021-03-31 13:35:16.877384 (MainThread): Flushing usage events
2021-03-31 13:36:50.987891 (MainThread): Running with dbt=0.19.0
2021-03-31 13:36:51.485582 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 13:36:51.486490 (MainThread): Tracking: tracking
2021-03-31 13:36:51.486846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb39e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164a65c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164a65f8>]}
2021-03-31 13:36:51.519445 (MainThread): Partial parsing not enabled
2021-03-31 13:36:51.520209 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:36:51.521119 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:36:51.522418 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:36:51.524520 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:36:51.553984 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:36:51.556106 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:36:51.557749 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:36:51.561786 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:36:51.572090 (MainThread): Parsing macros/core.sql
2021-03-31 13:36:51.576094 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:36:51.585088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:36:51.586888 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:36:51.605329 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:36:51.641067 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:36:51.663824 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:36:51.666025 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:36:51.672788 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:36:51.688859 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:36:51.697371 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:36:51.704976 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:36:51.710900 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:36:51.712016 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:36:51.713149 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:36:51.714824 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:36:51.724240 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:36:51.726492 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:36:51.728319 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:36:51.773884 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:36:51.776051 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:36:51.777695 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:36:51.779430 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:36:51.783607 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:36:51.784859 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:36:51.786346 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:36:51.789007 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:36:51.796531 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:36:51.797862 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:36:51.799751 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:36:51.802349 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:36:51.803608 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:36:51.806507 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:36:51.816970 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:36:51.819255 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:36:51.820911 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:36:51.823151 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:36:51.825055 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:36:51.826195 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:36:51.829883 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:36:51.835671 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:36:51.836577 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:36:51.839611 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:36:51.841704 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:36:51.843532 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:36:51.845650 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:36:51.874032 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:36:51.875620 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:36:51.877327 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:36:51.878931 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:36:51.884472 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:36:51.886622 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:36:51.889547 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:36:51.891513 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:36:51.893420 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:36:51.895666 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:36:51.899205 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:36:51.901704 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:36:51.903784 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:36:51.906536 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:36:51.909596 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:36:51.914629 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:36:51.918297 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:36:51.920644 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:36:51.923364 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:36:51.928729 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:36:51.936686 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:36:51.938748 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:36:51.943792 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:36:51.950228 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:36:51.954768 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:36:51.957009 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:36:51.962147 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:36:51.971872 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:36:51.983751 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:36:51.985763 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:36:51.990336 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:36:51.993473 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:36:51.996198 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:36:52.004380 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:36:52.011272 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:36:52.016684 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:36:52.026477 (MainThread): Partial parsing not enabled
2021-03-31 13:36:52.077755 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:36:52.142408 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:36:52.162326 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:36:52.180454 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:36:52.196581 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:36:52.568351 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0efc80-a69b-4905-9626-a36518cab062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cf7cf8>]}
2021-03-31 13:36:52.636854 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:36:52.637767 (MainThread): 
2021-03-31 13:36:52.638073 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:36:52.651145 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:36:52.651492 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:36:52.670510 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:36:52.670839 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:36:52.670942 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:36:52.671040 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:36:52.671131 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 13:36:52.671211 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:37:00.724743 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 4 in 8.05 seconds
2021-03-31 13:37:00.734421 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:37:04.957096 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 12.29 seconds
2021-03-31 13:37:04.964716 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 13:37:09.474487 (MainThread): 21:37:09 | Concurrency: 5 threads (target='dev')
2021-03-31 13:37:09.474722 (MainThread): 21:37:09 | 
2021-03-31 13:37:09.476239 (Thread-1): Began running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:37:09.476478 (Thread-2): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:37:09.476671 (Thread-1): 21:37:09 | 1 of 5 START test is_la_team_example_team_details_City............... [RUN]
2021-03-31 13:37:09.476795 (Thread-3): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:37:09.477005 (Thread-4): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:37:09.477141 (Thread-5): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:37:09.477268 (Thread-2): 21:37:09 | 2 of 5 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 13:37:09.477742 (Thread-3): 21:37:09 | 3 of 5 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 13:37:09.478154 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:37:09.478317 (Thread-4): 21:37:09 | 4 of 5 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 13:37:09.478465 (Thread-5): 21:37:09 | 5 of 5 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 13:37:09.478758 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:37:09.479144 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:37:09.479333 (Thread-1): Compiling test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:37:09.479639 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:37:09.479937 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:37:09.480096 (Thread-2): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:37:09.480261 (Thread-3): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:37:09.497520 (Thread-4): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:37:09.503834 (Thread-1): Writing injected SQL for node "test.demo_dbt.is_la_team_example_team_details_City"
2021-03-31 13:37:09.504018 (Thread-5): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:37:09.513789 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 13:37:09.523104 (Thread-3): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 13:37:09.533262 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 13:37:09.542495 (Thread-5): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 13:37:09.543378 (Thread-1): finished collecting timing info
2021-03-31 13:37:09.544244 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:37:09.544593 (Thread-2): finished collecting timing info
2021-03-31 13:37:09.544889 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: BEGIN
2021-03-31 13:37:09.544987 (Thread-3): finished collecting timing info
2021-03-31 13:37:09.545711 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:37:09.545878 (Thread-4): finished collecting timing info
2021-03-31 13:37:09.546103 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:37:09.546197 (Thread-5): finished collecting timing info
2021-03-31 13:37:09.546787 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:37:09.546906 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 13:37:09.547487 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:37:09.549316 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:37:09.549464 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 13:37:09.549753 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:37:09.550201 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 13:37:09.550566 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 13:37:09.550685 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:37:09.551311 (Thread-4): Opening a new connection, currently in state init
2021-03-31 13:37:09.551990 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:37:17.607019 (Thread-1): SQL status: SUCCESS 1 in 8.06 seconds
2021-03-31 13:37:17.607277 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:37:17.607432 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.is_la_team_example_team_details_City"} */


with validation as (

    select
        City as city

    from DEMO_DB.staging.example_team_details

),

validation_errors as (

    select
        city

    from validation
    where city = "Los Angeles"

)

select count(*)
from validation_errors
2021-03-31 13:37:17.669274 (Thread-5): SQL status: SUCCESS 1 in 8.12 seconds
2021-03-31 13:37:17.669526 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:37:17.669679 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:37:18.909111 (Thread-1): Snowflake query id: 019b4651-0430-ba2b-0000-002da6832741
2021-03-31 13:37:18.909244 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 17
invalid identifier '"Los Angeles"'
2021-03-31 13:37:18.909342 (Thread-1): finished collecting timing info
2021-03-31 13:37:18.909581 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: ROLLBACK
2021-03-31 13:37:19.509286 (Thread-4): SQL status: SUCCESS 1 in 9.96 seconds
2021-03-31 13:37:19.509551 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:37:19.509711 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:37:20.080293 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: Close
2021-03-31 13:37:20.660477 (Thread-4): SQL status: SUCCESS 1 in 1.15 seconds
2021-03-31 13:37:20.660963 (Thread-4): finished collecting timing info
2021-03-31 13:37:20.661741 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:37:21.558501 (Thread-5): SQL status: SUCCESS 1 in 3.89 seconds
2021-03-31 13:37:21.558934 (Thread-5): finished collecting timing info
2021-03-31 13:37:21.559290 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:37:21.707084 (Thread-2): SQL status: SUCCESS 1 in 12.16 seconds
2021-03-31 13:37:21.707359 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:37:21.707515 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 13:37:21.807066 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 13:37:22.457752 (Thread-1): Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
  000904 (42000): SQL compilation error: error line 16 at position 17
  invalid identifier '"Los Angeles"'
  compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 16 at position 17
invalid identifier '"Los Angeles"'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Library/Python/3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
  000904 (42000): SQL compilation error: error line 16 at position 17
  invalid identifier '"Los Angeles"'
  compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
2021-03-31 13:37:22.466705 (Thread-1): 21:37:22 | 1 of 5 ERROR is_la_team_example_team_details_City.................... [ERROR in 12.99s]
2021-03-31 13:37:22.466838 (Thread-1): Finished running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:37:22.556286 (Thread-3): SQL status: SUCCESS 1 in 13.01 seconds
2021-03-31 13:37:22.556490 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:37:22.556569 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 13:37:22.962462 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 13:37:22.963217 (Thread-2): SQL status: SUCCESS 1 in 1.26 seconds
2021-03-31 13:37:22.963900 (Thread-2): finished collecting timing info
2021-03-31 13:37:22.964264 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:37:23.888749 (Thread-3): SQL status: SUCCESS 1 in 1.33 seconds
2021-03-31 13:37:23.889268 (Thread-3): finished collecting timing info
2021-03-31 13:37:23.889707 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:37:24.220609 (Thread-4): 21:37:24 | 4 of 5 PASS unique_my_first_dbt_model_id............................. [PASS in 14.74s]
2021-03-31 13:37:24.220767 (Thread-4): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:37:24.271678 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 13:37:25.208394 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 13:37:25.211499 (Thread-5): 21:37:25 | 5 of 5 PASS unique_my_second_dbt_model_id............................ [PASS in 15.73s]
2021-03-31 13:37:25.211913 (Thread-5): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:37:26.189067 (Thread-2): 21:37:26 | 2 of 5 PASS not_null_my_first_dbt_model_id........................... [PASS in 16.71s]
2021-03-31 13:37:26.189255 (Thread-2): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:37:27.263842 (Thread-3): 21:37:27 | 3 of 5 PASS not_null_my_second_dbt_model_id.......................... [PASS in 17.78s]
2021-03-31 13:37:27.264074 (Thread-3): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:37:27.350812 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:37:27.351189 (MainThread): 21:37:27 | 
2021-03-31 13:37:27.351340 (MainThread): 21:37:27 | Finished running 5 tests in 34.71s.
2021-03-31 13:37:27.351454 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:37:27.351543 (MainThread): Connection 'test.demo_dbt.is_la_team_example_team_details_City' was properly closed.
2021-03-31 13:37:27.351626 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 13:37:27.351707 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 13:37:27.351786 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 13:37:27.351865 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 13:37:27.426844 (MainThread): 
2021-03-31 13:37:27.426991 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 13:37:27.427088 (MainThread): 
2021-03-31 13:37:27.427203 (MainThread): Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
2021-03-31 13:37:27.427297 (MainThread):   000904 (42000): SQL compilation error: error line 16 at position 17
2021-03-31 13:37:27.427376 (MainThread):   invalid identifier '"Los Angeles"'
2021-03-31 13:37:27.427451 (MainThread):   compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
2021-03-31 13:37:27.427539 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-03-31 13:37:27.427680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116589e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cee390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170f5320>]}
2021-03-31 13:37:27.427844 (MainThread): Flushing usage events
2021-03-31 13:45:38.446934 (MainThread): Running with dbt=0.19.0
2021-03-31 13:45:38.984703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 13:45:38.985785 (MainThread): Tracking: tracking
2021-03-31 13:45:38.986063 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73c9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f242630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f242550>]}
2021-03-31 13:45:39.025511 (MainThread): Partial parsing not enabled
2021-03-31 13:45:39.026303 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:45:39.027291 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:45:39.028607 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:45:39.031128 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:45:39.068850 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:45:39.070981 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:45:39.072512 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:45:39.076671 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:45:39.087178 (MainThread): Parsing macros/core.sql
2021-03-31 13:45:39.091185 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:45:39.100447 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:45:39.102278 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:45:39.120766 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:45:39.155850 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:45:39.179253 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:45:39.181530 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:45:39.188358 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:45:39.204632 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:45:39.212557 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:45:39.219501 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:45:39.224662 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:45:39.226675 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:45:39.228389 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:45:39.230340 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:45:39.240792 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:45:39.243734 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:45:39.247781 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:45:39.311326 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:45:39.314194 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:45:39.316459 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:45:39.319531 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:45:39.325414 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:45:39.327829 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:45:39.330171 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:45:39.333747 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:45:39.343133 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:45:39.345119 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:45:39.347766 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:45:39.351793 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:45:39.353482 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:45:39.356788 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:45:39.369424 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:45:39.371994 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:45:39.373861 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:45:39.376152 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:45:39.378551 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:45:39.379993 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:45:39.384317 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:45:39.390383 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:45:39.391300 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:45:39.394933 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:45:39.397145 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:45:39.398946 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:45:39.401117 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:45:39.428546 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:45:39.430024 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:45:39.431513 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:45:39.432988 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:45:39.438213 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:45:39.440307 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:45:39.443477 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:45:39.445586 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:45:39.447490 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:45:39.449645 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:45:39.452557 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:45:39.454642 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:45:39.456432 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:45:39.458874 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:45:39.461887 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:45:39.465920 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:45:39.468559 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:45:39.470491 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:45:39.472750 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:45:39.477946 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:45:39.485336 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:45:39.487269 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:45:39.491294 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:45:39.496522 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:45:39.500418 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:45:39.502392 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:45:39.506334 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:45:39.515113 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:45:39.524363 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:45:39.526108 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:45:39.530730 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:45:39.532704 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:45:39.534661 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:45:39.541713 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:45:39.547245 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:45:39.551827 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:45:39.560962 (MainThread): Partial parsing not enabled
2021-03-31 13:45:39.611470 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:45:39.676946 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:45:39.696914 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:45:39.713511 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:45:39.727295 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:45:40.173634 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0fa2e9e-54cd-4bc1-89a5-f987388fa321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f914668>]}
2021-03-31 13:45:40.269963 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:45:40.271056 (MainThread): 
2021-03-31 13:45:40.271402 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:45:40.287701 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:45:40.293680 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:45:40.306751 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:45:40.307144 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:45:40.307229 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:45:40.307337 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:45:40.307438 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:45:40.307528 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 13:45:46.237400 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 5.93 seconds
2021-03-31 13:45:46.245551 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:45:48.502320 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 8.19 seconds
2021-03-31 13:45:48.508877 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 13:45:50.949110 (MainThread): 21:45:50 | Concurrency: 5 threads (target='dev')
2021-03-31 13:45:50.949370 (MainThread): 21:45:50 | 
2021-03-31 13:45:50.950611 (Thread-1): Began running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:45:50.950768 (Thread-2): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:45:50.950957 (Thread-1): 21:45:50 | 1 of 5 START test is_la_team_example_team_details_City............... [RUN]
2021-03-31 13:45:50.951065 (Thread-3): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:45:50.951215 (Thread-4): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:45:50.951378 (Thread-5): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:45:50.951529 (Thread-2): 21:45:50 | 2 of 5 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 13:45:50.952138 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:45:50.952285 (Thread-3): 21:45:50 | 3 of 5 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 13:45:50.952467 (Thread-4): 21:45:50 | 4 of 5 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 13:45:50.952632 (Thread-5): 21:45:50 | 5 of 5 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 13:45:50.952962 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:45:50.953108 (Thread-1): Compiling test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:45:50.953418 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:45:50.953758 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:45:50.954098 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:45:50.954267 (Thread-2): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:45:50.976676 (Thread-3): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:45:50.978990 (Thread-1): Writing injected SQL for node "test.demo_dbt.is_la_team_example_team_details_City"
2021-03-31 13:45:50.979198 (Thread-4): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:45:50.979363 (Thread-5): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:45:50.989203 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 13:45:50.999882 (Thread-3): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 13:45:51.016897 (Thread-5): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 13:45:51.019820 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 13:45:51.020151 (Thread-1): finished collecting timing info
2021-03-31 13:45:51.021658 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:45:51.021783 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: BEGIN
2021-03-31 13:45:51.021891 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:45:51.022346 (Thread-3): finished collecting timing info
2021-03-31 13:45:51.023200 (Thread-5): finished collecting timing info
2021-03-31 13:45:51.024016 (Thread-2): finished collecting timing info
2021-03-31 13:45:51.024629 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:45:51.025523 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:45:51.025674 (Thread-4): finished collecting timing info
2021-03-31 13:45:51.026679 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:45:51.027111 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 13:45:51.027244 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 13:45:51.027897 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:45:51.028050 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 13:45:51.028237 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:45:51.028477 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:45:51.028634 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 13:45:51.028792 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:45:51.030962 (Thread-4): Opening a new connection, currently in state init
2021-03-31 13:45:54.237320 (Thread-3): SQL status: SUCCESS 1 in 3.21 seconds
2021-03-31 13:45:54.238102 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:45:54.238503 (Thread-5): SQL status: SUCCESS 1 in 3.21 seconds
2021-03-31 13:45:54.238617 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 13:45:54.238755 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:45:54.239198 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:45:54.586742 (Thread-1): SQL status: SUCCESS 1 in 3.56 seconds
2021-03-31 13:45:54.586902 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:45:54.586993 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.is_la_team_example_team_details_City"} */


with validation as (

    select
        City as city,
        team

    from DEMO_DB.staging.example_team_details

),

validation_errors as (

    select
        city

    from validation
    where city = " Los Angeles"
        and team not in ('Lakers', 'Clippers')

)

select count(*)
from validation_errors
2021-03-31 13:45:54.642934 (Thread-4): SQL status: SUCCESS 1 in 3.61 seconds
2021-03-31 13:45:54.643249 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:45:54.643402 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:45:55.086992 (Thread-5): SQL status: SUCCESS 1 in 0.85 seconds
2021-03-31 13:45:55.087438 (Thread-5): finished collecting timing info
2021-03-31 13:45:55.087744 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:45:55.092773 (Thread-3): SQL status: SUCCESS 1 in 0.85 seconds
2021-03-31 13:45:55.093580 (Thread-3): finished collecting timing info
2021-03-31 13:45:55.094105 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:45:55.486991 (Thread-1): Snowflake query id: 019b4659-04a7-8af6-0000-002da68348a9
2021-03-31 13:45:55.487183 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 17
invalid identifier '" Los Angeles"'
2021-03-31 13:45:55.487330 (Thread-1): finished collecting timing info
2021-03-31 13:45:55.487684 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: ROLLBACK
2021-03-31 13:45:55.562751 (Thread-4): SQL status: SUCCESS 1 in 0.92 seconds
2021-03-31 13:45:55.563179 (Thread-4): finished collecting timing info
2021-03-31 13:45:55.563541 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:45:56.167591 (Thread-2): SQL status: SUCCESS 1 in 5.14 seconds
2021-03-31 13:45:56.167968 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:45:56.168169 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 13:45:56.510560 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 13:45:56.605804 (Thread-2): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 13:45:56.606311 (Thread-2): finished collecting timing info
2021-03-31 13:45:56.606641 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:45:56.636758 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 13:45:56.891577 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 13:45:57.013082 (Thread-4): 21:45:57 | 4 of 5 PASS unique_my_first_dbt_model_id............................. [PASS in 6.06s]
2021-03-31 13:45:57.013251 (Thread-4): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:45:57.095509 (Thread-3): 21:45:57 | 3 of 5 PASS not_null_my_second_dbt_model_id.......................... [PASS in 6.14s]
2021-03-31 13:45:57.095751 (Thread-3): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:45:57.267744 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 13:45:57.436757 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: Close
2021-03-31 13:45:57.470486 (Thread-2): 21:45:57 | 2 of 5 PASS not_null_my_first_dbt_model_id........................... [PASS in 6.52s]
2021-03-31 13:45:57.470683 (Thread-2): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:45:58.816843 (Thread-5): 21:45:58 | 5 of 5 PASS unique_my_second_dbt_model_id............................ [PASS in 7.86s]
2021-03-31 13:45:58.817956 (Thread-5): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:45:58.817167 (Thread-1): Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
  000904 (42000): SQL compilation error: error line 17 at position 17
  invalid identifier '" Los Angeles"'
  compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Library/Python/3.7/site-packages/snowflake/connector/cursor.py", line 605, in execute
    errvalue)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Library/Python/3.7/site-packages/snowflake/connector/errors.py", line 90, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 17 at position 17
invalid identifier '" Los Angeles"'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.7/site-packages/dbt/task/test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Library/Python/3.7/site-packages/dbt/task/test.py", line 65, in execute_schema_test
    fetch=True,
  File "/Library/Python/3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 317, in add_query
    abridge_sql_log=abridge_sql_log
  File "/Library/Python/3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.7/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.7/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
  000904 (42000): SQL compilation error: error line 17 at position 17
  invalid identifier '" Los Angeles"'
  compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
2021-03-31 13:45:58.822924 (Thread-1): 21:45:58 | 1 of 5 ERROR is_la_team_example_team_details_City.................... [ERROR in 7.87s]
2021-03-31 13:45:58.823049 (Thread-1): Finished running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:45:58.889050 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:45:58.889404 (MainThread): 21:45:58 | 
2021-03-31 13:45:58.889544 (MainThread): 21:45:58 | Finished running 5 tests in 18.62s.
2021-03-31 13:45:58.889657 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:45:58.889745 (MainThread): Connection 'test.demo_dbt.is_la_team_example_team_details_City' was properly closed.
2021-03-31 13:45:58.889828 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 13:45:58.889909 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 13:45:58.889987 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 13:45:58.890068 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 13:45:58.965548 (MainThread): 
2021-03-31 13:45:58.965728 (MainThread): Completed with 1 error and 0 warnings:
2021-03-31 13:45:58.965841 (MainThread): 
2021-03-31 13:45:58.965950 (MainThread): Database Error in test is_la_team_example_team_details_City (models/staging/example/example_team_details.yml)
2021-03-31 13:45:58.966079 (MainThread):   000904 (42000): SQL compilation error: error line 17 at position 17
2021-03-31 13:45:58.966241 (MainThread):   invalid identifier '" Los Angeles"'
2021-03-31 13:45:58.966345 (MainThread):   compiled SQL at target/compiled/demo_dbt/models/staging/example/example_team_details.yml/schema_test/is_la_team_example_team_details_City.sql
2021-03-31 13:45:58.966470 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-03-31 13:45:58.966621 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce138d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f798cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f927ba8>]}
2021-03-31 13:45:58.966847 (MainThread): Flushing usage events
2021-03-31 13:46:10.709506 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2021-03-31 13:46:10.709772 (MainThread): Error sending message, disabling tracking
2021-03-31 13:46:18.522856 (MainThread): Running with dbt=0.19.0
2021-03-31 13:46:19.064002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-03-31 13:46:19.065132 (MainThread): Tracking: tracking
2021-03-31 13:46:19.065583 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7da58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08f048>]}
2021-03-31 13:46:19.101128 (MainThread): Partial parsing not enabled
2021-03-31 13:46:19.101987 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 13:46:19.102941 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 13:46:19.104512 (MainThread): Parsing macros/catalog.sql
2021-03-31 13:46:19.106831 (MainThread): Parsing macros/adapters.sql
2021-03-31 13:46:19.137668 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 13:46:19.139965 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 13:46:19.141496 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 13:46:19.145679 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 13:46:19.156655 (MainThread): Parsing macros/core.sql
2021-03-31 13:46:19.160763 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 13:46:19.169982 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 13:46:19.171994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 13:46:19.190908 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 13:46:19.224643 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 13:46:19.247005 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 13:46:19.248957 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 13:46:19.255394 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 13:46:19.269943 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 13:46:19.277427 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 13:46:19.284739 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 13:46:19.290173 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 13:46:19.291174 (MainThread): Parsing macros/etc/query.sql
2021-03-31 13:46:19.292531 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 13:46:19.294757 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 13:46:19.304549 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 13:46:19.306623 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 13:46:19.308426 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 13:46:19.354891 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 13:46:19.356898 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 13:46:19.358478 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 13:46:19.360385 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 13:46:19.365214 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 13:46:19.366869 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 13:46:19.368538 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 13:46:19.371298 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 13:46:19.378587 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 13:46:19.379979 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 13:46:19.382251 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 13:46:19.385070 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 13:46:19.386370 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 13:46:19.388943 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 13:46:19.399494 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 13:46:19.401824 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 13:46:19.403514 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 13:46:19.405452 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 13:46:19.407259 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 13:46:19.408429 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 13:46:19.412526 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 13:46:19.418891 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 13:46:19.419898 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 13:46:19.422983 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 13:46:19.425095 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 13:46:19.427195 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 13:46:19.429510 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 13:46:19.456816 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 13:46:19.458232 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 13:46:19.459808 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 13:46:19.461158 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 13:46:19.466316 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 13:46:19.468371 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 13:46:19.471277 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 13:46:19.473087 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 13:46:19.474818 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 13:46:19.476912 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 13:46:19.479801 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 13:46:19.481867 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 13:46:19.483616 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 13:46:19.485930 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 13:46:19.487660 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 13:46:19.491073 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 13:46:19.493552 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 13:46:19.495505 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 13:46:19.497749 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 13:46:19.501994 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 13:46:19.509048 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 13:46:19.511081 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 13:46:19.514939 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 13:46:19.519902 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 13:46:19.523756 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 13:46:19.525826 (MainThread): Parsing macros/sql/star.sql
2021-03-31 13:46:19.529734 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 13:46:19.537596 (MainThread): Parsing macros/sql/union.sql
2021-03-31 13:46:19.546944 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 13:46:19.548575 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 13:46:19.552453 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 13:46:19.554346 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 13:46:19.556259 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 13:46:19.563184 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 13:46:19.568234 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 13:46:19.572723 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 13:46:19.580766 (MainThread): Partial parsing not enabled
2021-03-31 13:46:19.625125 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 13:46:19.683955 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 13:46:19.702790 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 13:46:19.719835 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 13:46:19.732237 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 13:46:20.057763 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca63eb8b-dc89-4d63-bd8a-26b95b0ab6b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16dfd0>]}
2021-03-31 13:46:20.126725 (MainThread): Found 5 models, 5 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 13:46:20.127612 (MainThread): 
2021-03-31 13:46:20.127923 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:46:20.139664 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:46:20.145344 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:46:20.158916 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 13:46:20.159043 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 13:46:20.159123 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 13:46:20.161003 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 13:46:20.161099 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 13:46:20.161191 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 13:46:25.341141 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 5.18 seconds
2021-03-31 13:46:25.347922 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 13:46:25.490309 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 5.33 seconds
2021-03-31 13:46:25.494688 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 13:46:28.409194 (MainThread): 21:46:28 | Concurrency: 5 threads (target='dev')
2021-03-31 13:46:28.409398 (MainThread): 21:46:28 | 
2021-03-31 13:46:28.410661 (Thread-1): Began running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:46:28.410870 (Thread-1): 21:46:28 | 1 of 5 START test is_la_team_example_team_details_City............... [RUN]
2021-03-31 13:46:28.411048 (Thread-2): Began running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:46:28.411246 (Thread-3): Began running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:46:28.411439 (Thread-2): 21:46:28 | 2 of 5 START test not_null_my_first_dbt_model_id..................... [RUN]
2021-03-31 13:46:28.411579 (Thread-4): Began running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:46:28.411871 (Thread-1): Acquiring new snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:46:28.412015 (Thread-5): Began running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:46:28.412152 (Thread-3): 21:46:28 | 3 of 5 START test not_null_my_second_dbt_model_id.................... [RUN]
2021-03-31 13:46:28.412443 (Thread-2): Acquiring new snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:46:28.412594 (Thread-4): 21:46:28 | 4 of 5 START test unique_my_first_dbt_model_id....................... [RUN]
2021-03-31 13:46:28.412740 (Thread-1): Compiling test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:46:28.412872 (Thread-5): 21:46:28 | 5 of 5 START test unique_my_second_dbt_model_id...................... [RUN]
2021-03-31 13:46:28.413254 (Thread-3): Acquiring new snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:46:28.413385 (Thread-2): Compiling test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:46:28.413711 (Thread-4): Acquiring new snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:46:28.437236 (Thread-1): Writing injected SQL for node "test.demo_dbt.is_la_team_example_team_details_City"
2021-03-31 13:46:28.437664 (Thread-5): Acquiring new snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:46:28.437846 (Thread-3): Compiling test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:46:28.448220 (Thread-2): Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id"
2021-03-31 13:46:28.448439 (Thread-4): Compiling test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:46:28.448723 (Thread-5): Compiling test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:46:28.458447 (Thread-3): Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id"
2021-03-31 13:46:28.458721 (Thread-1): finished collecting timing info
2021-03-31 13:46:28.474154 (Thread-5): Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id"
2021-03-31 13:46:28.479528 (Thread-4): Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id"
2021-03-31 13:46:28.480654 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:46:28.481157 (Thread-2): finished collecting timing info
2021-03-31 13:46:28.481560 (Thread-3): finished collecting timing info
2021-03-31 13:46:28.481906 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: BEGIN
2021-03-31 13:46:28.482027 (Thread-5): finished collecting timing info
2021-03-31 13:46:28.482754 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:46:28.483269 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:46:28.483385 (Thread-4): finished collecting timing info
2021-03-31 13:46:28.483669 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 13:46:28.484311 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:46:28.484436 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: BEGIN
2021-03-31 13:46:28.484553 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: BEGIN
2021-03-31 13:46:28.485182 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:46:28.485950 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: BEGIN
2021-03-31 13:46:28.486137 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 13:46:28.486904 (Thread-3): Opening a new connection, currently in state init
2021-03-31 13:46:28.487190 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: BEGIN
2021-03-31 13:46:28.487693 (Thread-5): Opening a new connection, currently in state init
2021-03-31 13:46:28.489245 (Thread-4): Opening a new connection, currently in state init
2021-03-31 13:46:33.754710 (Thread-5): SQL status: SUCCESS 1 in 5.27 seconds
2021-03-31 13:46:33.754857 (Thread-5): Using snowflake connection "test.demo_dbt.unique_my_second_dbt_model_id".
2021-03-31 13:46:33.754935 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_second_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:46:33.793667 (Thread-4): SQL status: SUCCESS 1 in 5.30 seconds
2021-03-31 13:46:33.793807 (Thread-4): Using snowflake connection "test.demo_dbt.unique_my_first_dbt_model_id".
2021-03-31 13:46:33.793883 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from (

    select
        id

    from DEMO_DB.staging.my_first_dbt_model
    where id is not null
    group by id
    having count(*) > 1

) validation_errors
2021-03-31 13:46:33.868428 (Thread-2): SQL status: SUCCESS 1 in 5.38 seconds
2021-03-31 13:46:33.868561 (Thread-2): Using snowflake connection "test.demo_dbt.not_null_my_first_dbt_model_id".
2021-03-31 13:46:33.868640 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_first_dbt_model
where id is null
2021-03-31 13:46:34.094845 (Thread-1): SQL status: SUCCESS 1 in 5.61 seconds
2021-03-31 13:46:34.095090 (Thread-1): Using snowflake connection "test.demo_dbt.is_la_team_example_team_details_City".
2021-03-31 13:46:34.095237 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.is_la_team_example_team_details_City"} */


with validation as (

    select
        City as city,
        team

    from DEMO_DB.staging.example_team_details

),

validation_errors as (

    select
        city

    from validation
    where city = ' Los Angeles'
        and team not in ('Lakers', 'Clippers')

)

select count(*)
from validation_errors
2021-03-31 13:46:35.612760 (Thread-5): SQL status: SUCCESS 1 in 1.86 seconds
2021-03-31 13:46:35.613665 (Thread-5): finished collecting timing info
2021-03-31 13:46:35.614067 (Thread-4): SQL status: SUCCESS 1 in 1.82 seconds
2021-03-31 13:46:35.614198 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:46:35.614410 (Thread-4): finished collecting timing info
2021-03-31 13:46:35.614812 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:46:35.913884 (Thread-2): SQL status: SUCCESS 1 in 2.05 seconds
2021-03-31 13:46:35.914179 (Thread-2): finished collecting timing info
2021-03-31 13:46:35.914414 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: ROLLBACK
2021-03-31 13:46:35.916021 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-03-31 13:46:35.916490 (Thread-1): finished collecting timing info
2021-03-31 13:46:35.916914 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: ROLLBACK
2021-03-31 13:46:36.507854 (Thread-3): SQL status: SUCCESS 1 in 8.02 seconds
2021-03-31 13:46:36.508057 (Thread-3): Using snowflake connection "test.demo_dbt.not_null_my_second_dbt_model_id".
2021-03-31 13:46:36.508174 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id"} */

    
    



select count(*) as validation_errors
from DEMO_DB.staging.my_second_dbt_model
where id is null
2021-03-31 13:46:36.795719 (Thread-4): On test.demo_dbt.unique_my_first_dbt_model_id: Close
2021-03-31 13:46:36.796208 (Thread-5): On test.demo_dbt.unique_my_second_dbt_model_id: Close
2021-03-31 13:46:36.811040 (Thread-2): On test.demo_dbt.not_null_my_first_dbt_model_id: Close
2021-03-31 13:46:36.813106 (Thread-1): On test.demo_dbt.is_la_team_example_team_details_City: Close
2021-03-31 13:46:37.294113 (Thread-3): SQL status: SUCCESS 1 in 0.79 seconds
2021-03-31 13:46:37.294568 (Thread-3): finished collecting timing info
2021-03-31 13:46:37.294822 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: ROLLBACK
2021-03-31 13:46:38.359250 (Thread-3): On test.demo_dbt.not_null_my_second_dbt_model_id: Close
2021-03-31 13:46:39.845916 (Thread-3): 21:46:39 | 3 of 5 PASS not_null_my_second_dbt_model_id.......................... [PASS in 11.43s]
2021-03-31 13:46:39.846194 (Thread-3): Finished running node test.demo_dbt.not_null_my_second_dbt_model_id
2021-03-31 13:46:41.265340 (Thread-4): 21:46:41 | 4 of 5 PASS unique_my_first_dbt_model_id............................. [PASS in 12.85s]
2021-03-31 13:46:41.265542 (Thread-4): Finished running node test.demo_dbt.unique_my_first_dbt_model_id
2021-03-31 13:46:42.465303 (Thread-2): 21:46:42 | 2 of 5 PASS not_null_my_first_dbt_model_id........................... [PASS in 14.05s]
2021-03-31 13:46:42.465749 (Thread-1): 21:46:42 | 1 of 5 PASS is_la_team_example_team_details_City..................... [PASS in 14.05s]
2021-03-31 13:46:42.466136 (Thread-2): Finished running node test.demo_dbt.not_null_my_first_dbt_model_id
2021-03-31 13:46:42.466460 (Thread-1): Finished running node test.demo_dbt.is_la_team_example_team_details_City
2021-03-31 13:46:43.698402 (Thread-5): 21:46:43 | 5 of 5 PASS unique_my_second_dbt_model_id............................ [PASS in 15.26s]
2021-03-31 13:46:43.698621 (Thread-5): Finished running node test.demo_dbt.unique_my_second_dbt_model_id
2021-03-31 13:46:43.760934 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 13:46:43.761361 (MainThread): 21:46:43 | 
2021-03-31 13:46:43.761582 (MainThread): 21:46:43 | Finished running 5 tests in 23.63s.
2021-03-31 13:46:43.761735 (MainThread): Connection 'master' was properly closed.
2021-03-31 13:46:43.761833 (MainThread): Connection 'test.demo_dbt.is_la_team_example_team_details_City' was properly closed.
2021-03-31 13:46:43.761938 (MainThread): Connection 'test.demo_dbt.not_null_my_first_dbt_model_id' was properly closed.
2021-03-31 13:46:43.762074 (MainThread): Connection 'test.demo_dbt.not_null_my_second_dbt_model_id' was properly closed.
2021-03-31 13:46:43.762208 (MainThread): Connection 'test.demo_dbt.unique_my_first_dbt_model_id' was properly closed.
2021-03-31 13:46:43.762341 (MainThread): Connection 'test.demo_dbt.unique_my_second_dbt_model_id' was properly closed.
2021-03-31 13:46:43.849040 (MainThread): 
2021-03-31 13:46:43.849218 (MainThread): Completed successfully
2021-03-31 13:46:43.849337 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 13:46:43.849521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16df28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee0e160>]}
2021-03-31 13:46:43.849716 (MainThread): Flushing usage events
2021-03-31 14:01:40.959810 (MainThread): Running with dbt=0.19.0
2021-03-31 14:01:41.658033 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['example_team_details'], partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 14:01:41.659061 (MainThread): Tracking: tracking
2021-03-31 14:01:41.659483 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945b6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945b0f0>]}
2021-03-31 14:01:41.697026 (MainThread): Partial parsing not enabled
2021-03-31 14:01:41.698282 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 14:01:41.699604 (MainThread): Parsing macros/test_not_null.sql
2021-03-31 14:01:41.703443 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 14:01:41.705037 (MainThread): Parsing macros/catalog.sql
2021-03-31 14:01:41.707407 (MainThread): Parsing macros/adapters.sql
2021-03-31 14:01:41.737063 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 14:01:41.739296 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 14:01:41.744255 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 14:01:41.754538 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 14:01:41.769564 (MainThread): Parsing macros/core.sql
2021-03-31 14:01:41.774064 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 14:01:41.783294 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 14:01:41.785377 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 14:01:41.804347 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 14:01:41.838307 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 14:01:41.860110 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 14:01:41.862233 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 14:01:41.868971 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 14:01:41.883745 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 14:01:41.890999 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 14:01:41.897631 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 14:01:41.903088 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 14:01:41.904227 (MainThread): Parsing macros/etc/query.sql
2021-03-31 14:01:41.905459 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 14:01:41.907252 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 14:01:41.916500 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 14:01:41.918918 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 14:01:41.921175 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 14:01:41.966017 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 14:01:41.968660 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 14:01:41.970621 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 14:01:41.972565 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 14:01:41.977386 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 14:01:41.979071 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 14:01:41.980692 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 14:01:41.983537 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 14:01:41.991461 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 14:01:41.995454 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 14:01:42.002809 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 14:01:42.010550 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 14:01:42.012823 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 14:01:42.016878 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 14:01:42.031250 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 14:01:42.034621 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 14:01:42.037170 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 14:01:42.039942 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 14:01:42.042561 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 14:01:42.044331 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 14:01:42.049392 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 14:01:42.057308 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 14:01:42.058722 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 14:01:42.062819 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 14:01:42.065729 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 14:01:42.068909 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 14:01:42.072237 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 14:01:42.103694 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 14:01:42.105272 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 14:01:42.106873 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 14:01:42.108336 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 14:01:42.113900 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 14:01:42.116377 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 14:01:42.119450 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 14:01:42.121460 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 14:01:42.123517 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 14:01:42.125873 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 14:01:42.129250 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 14:01:42.131784 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 14:01:42.133874 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 14:01:42.136427 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 14:01:42.138294 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 14:01:42.141842 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 14:01:42.144454 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 14:01:42.146466 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 14:01:42.148848 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 14:01:42.153471 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 14:01:42.160720 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 14:01:42.162704 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 14:01:42.166710 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 14:01:42.171831 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 14:01:42.175803 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 14:01:42.177866 (MainThread): Parsing macros/sql/star.sql
2021-03-31 14:01:42.181825 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 14:01:42.190038 (MainThread): Parsing macros/sql/union.sql
2021-03-31 14:01:42.199620 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 14:01:42.201405 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 14:01:42.205350 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 14:01:42.207353 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 14:01:42.209387 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 14:01:42.216321 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 14:01:42.221537 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 14:01:42.226062 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 14:01:42.234342 (MainThread): Partial parsing not enabled
2021-03-31 14:01:42.302481 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:01:42.371131 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:01:42.391040 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:01:42.410480 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:01:42.426192 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:01:42.893347 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9c8ff40-5ec0-42bd-b75b-0223cc48214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972e7b8>]}
2021-03-31 14:01:42.995768 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 14:01:42.996749 (MainThread): 
2021-03-31 14:01:42.997186 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:01:42.998889 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 14:01:43.018181 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 14:01:43.018671 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 14:01:43.018876 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 14:02:01.707070 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 18.69 seconds
2021-03-31 14:02:01.710160 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 14:02:13.143357 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:02:13.143807 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:02:13.153887 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:02:13.156859 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:02:13.157045 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 14:02:13.157164 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 14:02:13.157280 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 14:02:13.157388 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 14:02:23.882623 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 10.73 seconds
2021-03-31 14:02:23.887241 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 14:02:29.558175 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 16.40 seconds
2021-03-31 14:02:29.565399 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 14:02:39.008111 (MainThread): Using snowflake connection "master".
2021-03-31 14:02:39.008245 (MainThread): On master: BEGIN
2021-03-31 14:02:39.008363 (MainThread): Opening a new connection, currently in state init
2021-03-31 14:02:48.932219 (MainThread): SQL status: SUCCESS 1 in 9.92 seconds
2021-03-31 14:02:48.932382 (MainThread): On master: COMMIT
2021-03-31 14:02:48.932515 (MainThread): Using snowflake connection "master".
2021-03-31 14:02:48.932603 (MainThread): On master: COMMIT
2021-03-31 14:02:49.805861 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-03-31 14:02:49.806217 (MainThread): On master: Close
2021-03-31 14:02:51.817095 (MainThread): 22:02:51 | Concurrency: 5 threads (target='dev')
2021-03-31 14:02:51.817724 (MainThread): 22:02:51 | 
2021-03-31 14:02:51.821969 (Thread-1): Began running node model.demo_dbt.example_team_details
2021-03-31 14:02:51.826040 (Thread-1): 22:02:51 | 1 of 1 START table model staging.example_team_details................ [RUN]
2021-03-31 14:02:51.826970 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:02:51.827375 (Thread-1): Compiling model.demo_dbt.example_team_details
2021-03-31 14:02:51.880074 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:02:51.880999 (Thread-1): finished collecting timing info
2021-03-31 14:02:51.929198 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:02:51.931235 (Thread-1): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:02:51.931417 (Thread-1): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 14:02:51.931536 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 14:02:56.498768 (Thread-1): SQL status: SUCCESS 1 in 4.57 seconds
2021-03-31 14:02:56.498962 (Thread-1): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:02:56.499066 (Thread-1): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state,
        iff(teams.team = 'Lakers', true, false) as is_champion

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 14:03:06.964058 (Thread-1): SQL status: SUCCESS 1 in 10.46 seconds
2021-03-31 14:03:06.968131 (Thread-1): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:03:06.968317 (Thread-1): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:03:06.968426 (Thread-1): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:03:09.849583 (Thread-1): SQL status: SUCCESS 1 in 2.88 seconds
2021-03-31 14:03:09.861536 (Thread-1): finished collecting timing info
2021-03-31 14:03:09.861792 (Thread-1): On model.demo_dbt.example_team_details: Close
2021-03-31 14:03:11.180091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9c8ff40-5ec0-42bd-b75b-0223cc48214b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f7470>]}
2021-03-31 14:03:11.181405 (Thread-1): 22:03:11 | 1 of 1 OK created table model staging.example_team_details........... [SUCCESS 1 in 19.35s]
2021-03-31 14:03:11.181573 (Thread-1): Finished running node model.demo_dbt.example_team_details
2021-03-31 14:03:11.253635 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:03:11.254135 (MainThread): Using snowflake connection "master".
2021-03-31 14:03:11.254298 (MainThread): On master: BEGIN
2021-03-31 14:03:11.254497 (MainThread): Opening a new connection, currently in state closed
2021-03-31 14:03:24.193679 (MainThread): SQL status: SUCCESS 1 in 12.94 seconds
2021-03-31 14:03:24.193979 (MainThread): On master: COMMIT
2021-03-31 14:03:24.194258 (MainThread): Using snowflake connection "master".
2021-03-31 14:03:24.194498 (MainThread): On master: COMMIT
2021-03-31 14:03:25.042989 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-03-31 14:03:25.043227 (MainThread): On master: Close
2021-03-31 14:03:26.894728 (MainThread): 22:03:26 | 
2021-03-31 14:03:26.894946 (MainThread): 22:03:26 | Finished running 1 table model in 103.90s.
2021-03-31 14:03:26.895080 (MainThread): Connection 'master' was properly closed.
2021-03-31 14:03:26.895215 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 14:03:26.895441 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 14:03:26.996009 (MainThread): 
2021-03-31 14:03:26.996190 (MainThread): Completed successfully
2021-03-31 14:03:26.996323 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-03-31 14:03:26.996509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b39898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a81d0>]}
2021-03-31 14:03:26.996792 (MainThread): Flushing usage events
2021-03-31 14:05:21.290867 (MainThread): Running with dbt=0.19.0
2021-03-31 14:05:21.793935 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{"current_champion": "76ers"}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 14:05:21.794887 (MainThread): Tracking: tracking
2021-03-31 14:05:21.795304 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110505710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105055f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105112b0>]}
2021-03-31 14:05:21.829795 (MainThread): Partial parsing not enabled
2021-03-31 14:05:21.830634 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 14:05:21.831588 (MainThread): Parsing macros/test_not_null.sql
2021-03-31 14:05:21.834157 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 14:05:21.835549 (MainThread): Parsing macros/catalog.sql
2021-03-31 14:05:21.837632 (MainThread): Parsing macros/adapters.sql
2021-03-31 14:05:21.886032 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 14:05:21.892551 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 14:05:21.898643 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 14:05:21.911557 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 14:05:21.942655 (MainThread): Parsing macros/core.sql
2021-03-31 14:05:21.955240 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 14:05:21.984999 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 14:05:21.991446 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 14:05:22.048535 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 14:05:22.148494 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 14:05:22.204845 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 14:05:22.208396 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 14:05:22.218097 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 14:05:22.254860 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 14:05:22.265582 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 14:05:22.277364 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 14:05:22.284462 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 14:05:22.285786 (MainThread): Parsing macros/etc/query.sql
2021-03-31 14:05:22.287228 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 14:05:22.291519 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 14:05:22.306110 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 14:05:22.309248 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 14:05:22.312470 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 14:05:22.383159 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 14:05:22.385886 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 14:05:22.389320 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 14:05:22.393939 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 14:05:22.399897 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 14:05:22.401685 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 14:05:22.403922 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 14:05:22.409484 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 14:05:22.419585 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 14:05:22.421879 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 14:05:22.425064 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 14:05:22.429206 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 14:05:22.431072 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 14:05:22.434453 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 14:05:22.450789 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 14:05:22.455118 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 14:05:22.458567 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 14:05:22.461772 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 14:05:22.464377 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 14:05:22.466006 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 14:05:22.471514 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 14:05:22.480199 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 14:05:22.481435 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 14:05:22.485379 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 14:05:22.489764 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 14:05:22.492932 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 14:05:22.496676 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 14:05:22.535119 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 14:05:22.536901 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 14:05:22.540789 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 14:05:22.543337 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 14:05:22.551695 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 14:05:22.555092 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 14:05:22.559942 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 14:05:22.562818 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 14:05:22.565110 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 14:05:22.567804 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 14:05:22.572653 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 14:05:22.576222 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 14:05:22.579203 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 14:05:22.582530 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 14:05:22.584907 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 14:05:22.591409 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 14:05:22.595288 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 14:05:22.598168 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 14:05:22.601225 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 14:05:22.607544 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 14:05:22.617182 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 14:05:22.619580 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 14:05:22.627576 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 14:05:22.634208 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 14:05:22.639893 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 14:05:22.642731 (MainThread): Parsing macros/sql/star.sql
2021-03-31 14:05:22.648073 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 14:05:22.661681 (MainThread): Parsing macros/sql/union.sql
2021-03-31 14:05:22.675273 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 14:05:22.678014 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 14:05:22.683455 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 14:05:22.685932 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 14:05:22.689121 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 14:05:22.698643 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 14:05:22.707502 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 14:05:22.714534 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 14:05:22.728393 (MainThread): Partial parsing not enabled
2021-03-31 14:05:22.796652 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:05:22.872361 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:05:22.893926 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:05:22.912157 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:05:22.929566 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:05:23.402240 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e25c0>]}
2021-03-31 14:05:23.495882 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 14:05:23.496922 (MainThread): 
2021-03-31 14:05:23.497270 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:05:23.504242 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 14:05:23.523302 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 14:05:23.523565 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 14:05:23.523733 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 14:05:29.004845 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 5.48 seconds
2021-03-31 14:05:29.008047 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 14:05:30.342738 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:05:30.343204 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:05:30.352027 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:05:30.354593 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:05:30.354735 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 14:05:30.354856 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 14:05:30.354972 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 14:05:30.355130 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 14:05:38.258615 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 7.90 seconds
2021-03-31 14:05:38.262934 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 14:05:38.811501 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 8.46 seconds
2021-03-31 14:05:38.816843 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 14:05:39.757164 (MainThread): Using snowflake connection "master".
2021-03-31 14:05:39.757298 (MainThread): On master: BEGIN
2021-03-31 14:05:39.757384 (MainThread): Opening a new connection, currently in state init
2021-03-31 14:05:47.026885 (MainThread): SQL status: SUCCESS 1 in 7.27 seconds
2021-03-31 14:05:47.027114 (MainThread): On master: COMMIT
2021-03-31 14:05:47.027317 (MainThread): Using snowflake connection "master".
2021-03-31 14:05:47.027440 (MainThread): On master: COMMIT
2021-03-31 14:05:48.476630 (MainThread): SQL status: SUCCESS 1 in 1.45 seconds
2021-03-31 14:05:48.476913 (MainThread): On master: Close
2021-03-31 14:05:51.195854 (MainThread): 22:05:51 | Concurrency: 5 threads (target='dev')
2021-03-31 14:05:51.196068 (MainThread): 22:05:51 | 
2021-03-31 14:05:51.197477 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 14:05:51.197719 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:05:51.199000 (Thread-1): 22:05:51 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 14:05:51.199138 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:05:51.200308 (Thread-2): 22:05:51 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 14:05:51.200725 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:05:51.202153 (Thread-3): 22:05:51 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 14:05:51.202473 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:05:51.202618 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 14:05:51.202927 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:05:51.203097 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 14:05:51.209171 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:05:51.221701 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:05:51.233827 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:05:51.242560 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:05:51.243381 (Thread-3): finished collecting timing info
2021-03-31 14:05:51.243678 (Thread-1): finished collecting timing info
2021-03-31 14:05:51.243913 (Thread-2): finished collecting timing info
2021-03-31 14:05:51.301313 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:05:51.311177 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:05:51.313863 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:05:51.314851 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:05:51.314951 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 14:05:51.315043 (Thread-2): Opening a new connection, currently in state closed
2021-03-31 14:05:51.316254 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:05:51.316363 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 14:05:51.316455 (Thread-3): Opening a new connection, currently in state init
2021-03-31 14:05:51.318746 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:05:51.319536 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 14:05:51.319646 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 14:06:03.361292 (Thread-3): SQL status: SUCCESS 1 in 12.04 seconds
2021-03-31 14:06:03.361501 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:06:03.361612 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 14:06:04.696729 (Thread-3): SQL status: SUCCESS 1 in 1.34 seconds
2021-03-31 14:06:04.701317 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:06:04.701601 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:06:04.701723 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:06:05.618955 (Thread-3): SQL status: SUCCESS 1 in 0.92 seconds
2021-03-31 14:06:05.632670 (Thread-3): finished collecting timing info
2021-03-31 14:06:05.633036 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 14:06:05.767295 (Thread-1): SQL status: SUCCESS 1 in 14.45 seconds
2021-03-31 14:06:05.767504 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:06:05.767621 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 14:06:07.952129 (Thread-1): SQL status: SUCCESS 1 in 2.18 seconds
2021-03-31 14:06:07.963381 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:06:07.964139 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:06:07.964412 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:06:09.505055 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-03-31 14:06:09.511944 (Thread-1): finished collecting timing info
2021-03-31 14:06:09.512255 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 14:06:11.250434 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c62d68>]}
2021-03-31 14:06:11.251730 (Thread-3): 22:06:11 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 20.05s]
2021-03-31 14:06:11.251892 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:06:11.323745 (Thread-2): SQL status: SUCCESS 1 in 20.01 seconds
2021-03-31 14:06:11.323978 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:06:11.324389 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 14:06:11.646158 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058e588>]}
2021-03-31 14:06:11.647430 (Thread-1): 22:06:11 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 20.45s]
2021-03-31 14:06:11.647587 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 14:06:11.647969 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 14:06:11.649092 (Thread-5): 22:06:11 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 14:06:11.649412 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:06:11.649553 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 14:06:11.663221 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:06:11.663728 (Thread-5): finished collecting timing info
2021-03-31 14:06:11.669319 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:06:11.670818 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:06:11.670942 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 14:06:11.671049 (Thread-5): Opening a new connection, currently in state init
2021-03-31 14:06:13.544922 (Thread-2): SQL status: SUCCESS 1 in 2.22 seconds
2021-03-31 14:06:13.549178 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:06:13.549384 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:06:13.549489 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:06:15.044570 (Thread-2): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 14:06:15.047002 (Thread-2): finished collecting timing info
2021-03-31 14:06:15.047287 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 14:06:20.264891 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110707b8>]}
2021-03-31 14:06:20.266328 (Thread-2): 22:06:20 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 29.06s]
2021-03-31 14:06:20.266501 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:06:20.266832 (Thread-3): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:06:20.267965 (Thread-3): 22:06:20 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 14:06:20.268274 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:06:20.268407 (Thread-3): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 14:06:20.279783 (Thread-3): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:06:20.281073 (Thread-3): finished collecting timing info
2021-03-31 14:06:20.287555 (Thread-3): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:06:20.288458 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:06:20.288584 (Thread-3): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 14:06:20.288738 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 14:06:20.545602 (Thread-5): SQL status: SUCCESS 1 in 8.87 seconds
2021-03-31 14:06:20.545782 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:06:20.545885 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state,
        iff(teams.team = '76ers', true, false) as is_champion

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 14:06:21.972001 (Thread-5): SQL status: SUCCESS 1 in 1.43 seconds
2021-03-31 14:06:21.976426 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:06:21.976648 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:06:21.976755 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:06:22.317532 (Thread-5): SQL status: SUCCESS 1 in 0.34 seconds
2021-03-31 14:06:22.320142 (Thread-5): finished collecting timing info
2021-03-31 14:06:22.320523 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 14:06:22.544509 (Thread-3): SQL status: SUCCESS 1 in 2.26 seconds
2021-03-31 14:06:22.544728 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:06:22.544855 (Thread-3): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 14:06:23.894207 (Thread-3): SQL status: SUCCESS 1 in 1.35 seconds
2021-03-31 14:06:23.898395 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:06:23.898591 (Thread-3): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:06:23.898694 (Thread-3): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:06:26.748535 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111682b0>]}
2021-03-31 14:06:26.750829 (Thread-5): 22:06:26 | 4 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 15.10s]
2021-03-31 14:06:26.751113 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 14:06:27.099448 (Thread-3): SQL status: SUCCESS 1 in 3.20 seconds
2021-03-31 14:06:27.102235 (Thread-3): finished collecting timing info
2021-03-31 14:06:27.103469 (Thread-3): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 14:06:29.498068 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2dadb6-12f2-46e9-b3a4-8274870b8a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115d2e8>]}
2021-03-31 14:06:29.499563 (Thread-3): 22:06:29 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 9.23s]
2021-03-31 14:06:29.499745 (Thread-3): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:06:29.504755 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:06:29.505161 (MainThread): Using snowflake connection "master".
2021-03-31 14:06:29.505319 (MainThread): On master: BEGIN
2021-03-31 14:06:29.505440 (MainThread): Opening a new connection, currently in state closed
2021-03-31 14:06:36.274255 (MainThread): SQL status: SUCCESS 1 in 6.77 seconds
2021-03-31 14:06:36.274420 (MainThread): On master: COMMIT
2021-03-31 14:06:36.274551 (MainThread): Using snowflake connection "master".
2021-03-31 14:06:36.274625 (MainThread): On master: COMMIT
2021-03-31 14:06:40.855290 (MainThread): SQL status: SUCCESS 1 in 4.58 seconds
2021-03-31 14:06:40.855451 (MainThread): On master: Close
2021-03-31 14:06:42.405650 (MainThread): 22:06:42 | 
2021-03-31 14:06:42.405805 (MainThread): 22:06:42 | Finished running 1 view model, 4 table models in 78.91s.
2021-03-31 14:06:42.405906 (MainThread): Connection 'master' was properly closed.
2021-03-31 14:06:42.405977 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 14:06:42.406042 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 14:06:42.406105 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 14:06:42.406166 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 14:06:42.476541 (MainThread): 
2021-03-31 14:06:42.476686 (MainThread): Completed successfully
2021-03-31 14:06:42.476790 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 14:06:42.476941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c11358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f2f60>]}
2021-03-31 14:06:42.477144 (MainThread): Flushing usage events
2021-03-31 14:29:45.295618 (MainThread): Running with dbt=0.19.0
2021-03-31 14:29:46.132977 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 14:29:46.134224 (MainThread): Tracking: tracking
2021-03-31 14:29:46.134608 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e29978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ec518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ec550>]}
2021-03-31 14:29:46.176954 (MainThread): Partial parsing not enabled
2021-03-31 14:29:46.178290 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 14:29:46.179973 (MainThread): Parsing macros/test_not_null.sql
2021-03-31 14:29:46.184052 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 14:29:46.185844 (MainThread): Parsing macros/catalog.sql
2021-03-31 14:29:46.188450 (MainThread): Parsing macros/adapters.sql
2021-03-31 14:29:46.224876 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 14:29:46.227688 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 14:29:46.229763 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 14:29:46.235094 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 14:29:46.247734 (MainThread): Parsing macros/core.sql
2021-03-31 14:29:46.252947 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 14:29:46.264665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 14:29:46.267154 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 14:29:46.290053 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 14:29:46.326509 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 14:29:46.351212 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 14:29:46.353728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 14:29:46.362377 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 14:29:46.380591 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 14:29:46.389656 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 14:29:46.402873 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 14:29:46.411673 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 14:29:46.413421 (MainThread): Parsing macros/etc/query.sql
2021-03-31 14:29:46.415800 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 14:29:46.418878 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 14:29:46.433407 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 14:29:46.437181 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 14:29:46.440348 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 14:29:46.502790 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 14:29:46.505914 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 14:29:46.508140 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 14:29:46.510656 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 14:29:46.519439 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 14:29:46.521760 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 14:29:46.524453 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 14:29:46.529244 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 14:29:46.539556 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 14:29:46.541715 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 14:29:46.545152 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 14:29:46.550253 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 14:29:46.552285 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 14:29:46.556348 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 14:29:46.571438 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 14:29:46.574608 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 14:29:46.577202 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 14:29:46.581114 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 14:29:46.584363 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 14:29:46.586280 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 14:29:46.591462 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 14:29:46.599668 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 14:29:46.601103 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 14:29:46.605430 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 14:29:46.608549 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 14:29:46.611682 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 14:29:46.615497 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 14:29:46.653899 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 14:29:46.655869 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 14:29:46.657972 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 14:29:46.659879 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 14:29:46.668343 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 14:29:46.671541 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 14:29:46.675819 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 14:29:46.679496 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 14:29:46.682516 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 14:29:46.685864 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 14:29:46.690012 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 14:29:46.693069 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 14:29:46.695698 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 14:29:46.699449 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 14:29:46.702043 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 14:29:46.706765 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 14:29:46.710295 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 14:29:46.714164 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 14:29:46.718280 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 14:29:46.724369 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 14:29:46.734482 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 14:29:46.737489 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 14:29:46.742787 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 14:29:46.751079 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 14:29:46.756632 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 14:29:46.759488 (MainThread): Parsing macros/sql/star.sql
2021-03-31 14:29:46.766079 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 14:29:46.776886 (MainThread): Parsing macros/sql/union.sql
2021-03-31 14:29:46.789958 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 14:29:46.792212 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 14:29:46.798377 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 14:29:46.801371 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 14:29:46.804255 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 14:29:46.815018 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 14:29:46.822442 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 14:29:46.829298 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 14:29:46.840481 (MainThread): Partial parsing not enabled
2021-03-31 14:29:46.907696 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:29:46.982377 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:29:47.002984 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:29:47.022152 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:29:47.038417 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:29:47.059806 (MainThread): Acquiring new snowflake connection "operation.demo_dbt.demo_dbt-on-run-start-0".
2021-03-31 14:29:47.071603 (MainThread): Acquiring new snowflake connection "operation.demo_dbt.demo_dbt-on-run-end-0".
2021-03-31 14:29:47.424732 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113efe080>]}
2021-03-31 14:29:47.501681 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 318 macros, 2 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 14:29:47.502714 (MainThread): 
2021-03-31 14:29:47.503035 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:29:47.508760 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 14:29:47.523748 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 14:29:47.523898 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 14:29:47.523995 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 14:29:50.834987 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 3.31 seconds
2021-03-31 14:29:50.839475 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 14:29:51.332298 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:29:51.339056 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:29:51.341196 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:29:51.344408 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:29:51.344799 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 14:29:51.345059 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 14:29:51.345282 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 14:29:51.345523 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 14:29:53.670005 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 2.32 seconds
2021-03-31 14:29:53.675318 (ThreadPoolExecutor-1_1): On list_DEMO_DB_PUBLIC: Close
2021-03-31 14:29:53.731513 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.39 seconds
2021-03-31 14:29:53.736856 (ThreadPoolExecutor-1_0): On list_DEMO_DB_staging: Close
2021-03-31 14:29:54.232492 (MainThread): Using snowflake connection "master".
2021-03-31 14:29:54.232681 (MainThread): On master: BEGIN
2021-03-31 14:29:54.232808 (MainThread): Opening a new connection, currently in state init
2021-03-31 14:29:56.934344 (MainThread): SQL status: SUCCESS 1 in 2.70 seconds
2021-03-31 14:29:56.934728 (MainThread): On master: COMMIT
2021-03-31 14:29:56.935201 (MainThread): Using snowflake connection "master".
2021-03-31 14:29:56.935487 (MainThread): On master: COMMIT
2021-03-31 14:29:57.284330 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 14:29:57.284608 (MainThread): 22:29:57 | 
2021-03-31 14:29:57.284823 (MainThread): 22:29:57 | Running 1 on-run-start hook
2021-03-31 14:29:57.285015 (MainThread): Compiling operation.demo_dbt.demo_dbt-on-run-start-0
2021-03-31 14:29:57.302157 (MainThread): Writing injected SQL for node "operation.demo_dbt.demo_dbt-on-run-start-0"
2021-03-31 14:29:57.303999 (MainThread): 22:29:57 | 1 of 1 START hook: demo_dbt.on-run-start.0........................... [RUN]
2021-03-31 14:29:57.304454 (MainThread): Using snowflake connection "master".
2021-03-31 14:29:57.304569 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "master"} */
insert into DEMO_DB.PUBLIC.dbt_audits (audit_type) values ('run_start');
2021-03-31 14:29:58.023980 (MainThread): SQL status: SUCCESS 1 in 0.72 seconds
2021-03-31 14:29:58.024178 (MainThread): Using snowflake connection "master".
2021-03-31 14:29:58.024275 (MainThread): On master: commit;
2021-03-31 14:29:58.456551 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-03-31 14:29:58.461013 (MainThread): 22:29:58 | 1 of 1 OK hook: demo_dbt.on-run-start.0.............................. [SUCCESS 1 in 1.16s]
2021-03-31 14:29:58.461210 (MainThread): 22:29:58 | 
2021-03-31 14:29:58.461361 (MainThread): On master: Close
2021-03-31 14:29:59.010324 (MainThread): 22:29:59 | Concurrency: 5 threads (target='dev')
2021-03-31 14:29:59.010549 (MainThread): 22:29:59 | 
2021-03-31 14:29:59.013568 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 14:29:59.013831 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:29:59.013985 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:29:59.015379 (Thread-1): 22:29:59 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 14:29:59.016613 (Thread-2): 22:29:59 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 14:29:59.018241 (Thread-3): 22:29:59 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 14:29:59.018680 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:29:59.018997 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:29:59.019380 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:29:59.019517 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 14:29:59.019678 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 14:29:59.019832 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:29:59.040054 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:29:59.053427 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:29:59.056482 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:29:59.057308 (Thread-3): finished collecting timing info
2021-03-31 14:29:59.057587 (Thread-2): finished collecting timing info
2021-03-31 14:29:59.057844 (Thread-1): finished collecting timing info
2021-03-31 14:29:59.123850 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:29:59.146950 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:29:59.150942 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:29:59.152119 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:29:59.152343 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 14:29:59.153096 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:29:59.153216 (Thread-3): Opening a new connection, currently in state init
2021-03-31 14:29:59.154000 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:29:59.154131 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 14:29:59.154968 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 14:29:59.155687 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 14:29:59.155981 (Thread-2): Opening a new connection, currently in state init
2021-03-31 14:30:01.106986 (Thread-3): SQL status: SUCCESS 1 in 1.95 seconds
2021-03-31 14:30:01.107205 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:30:01.107332 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 14:30:01.657352 (Thread-3): SQL status: SUCCESS 1 in 0.55 seconds
2021-03-31 14:30:01.662698 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:30:01.662923 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:30:01.663026 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:30:01.907802 (Thread-3): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 14:30:01.919510 (Thread-3): finished collecting timing info
2021-03-31 14:30:01.919760 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 14:30:02.424058 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bca940>]}
2021-03-31 14:30:02.436855 (Thread-3): 22:30:02 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 3.40s]
2021-03-31 14:30:02.448201 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:30:03.406935 (Thread-2): SQL status: SUCCESS 1 in 4.25 seconds
2021-03-31 14:30:03.407183 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:30:03.407324 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 14:30:03.459227 (Thread-1): SQL status: SUCCESS 1 in 4.30 seconds
2021-03-31 14:30:03.459401 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:30:03.459498 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 14:30:04.470340 (Thread-2): SQL status: SUCCESS 1 in 1.06 seconds
2021-03-31 14:30:04.474875 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:30:04.475054 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:30:04.475153 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:30:04.726941 (Thread-2): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 14:30:04.734560 (Thread-2): finished collecting timing info
2021-03-31 14:30:04.735451 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 14:30:05.259969 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b78978>]}
2021-03-31 14:30:05.261510 (Thread-2): 22:30:05 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 6.24s]
2021-03-31 14:30:05.261674 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:30:05.262064 (Thread-5): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:30:05.263269 (Thread-5): 22:30:05 | 4 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 14:30:05.263636 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:30:05.263776 (Thread-5): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 14:30:05.273107 (Thread-5): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:30:05.274637 (Thread-5): finished collecting timing info
2021-03-31 14:30:05.280202 (Thread-5): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:30:05.282560 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:30:05.282741 (Thread-5): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 14:30:05.282848 (Thread-5): Opening a new connection, currently in state init
2021-03-31 14:30:05.671305 (Thread-1): SQL status: SUCCESS 1 in 2.21 seconds
2021-03-31 14:30:05.676458 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:30:05.676670 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:30:05.676766 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:30:05.925909 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 14:30:05.929262 (Thread-1): finished collecting timing info
2021-03-31 14:30:05.929573 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 14:30:07.089983 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e79ac8>]}
2021-03-31 14:30:07.091222 (Thread-1): 22:30:07 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 8.07s]
2021-03-31 14:30:07.091371 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 14:30:07.091689 (Thread-3): Began running node model.demo_dbt.example_team_details
2021-03-31 14:30:07.092698 (Thread-3): 22:30:07 | 5 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 14:30:07.092989 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:30:07.093101 (Thread-3): Compiling model.demo_dbt.example_team_details
2021-03-31 14:30:07.103517 (Thread-3): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:30:07.105414 (Thread-3): finished collecting timing info
2021-03-31 14:30:07.110810 (Thread-3): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:30:07.112508 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:30:07.112613 (Thread-3): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 14:30:07.112704 (Thread-3): Opening a new connection, currently in state closed
2021-03-31 14:30:07.120089 (Thread-5): SQL status: SUCCESS 1 in 1.84 seconds
2021-03-31 14:30:07.120320 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:30:07.120456 (Thread-5): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 14:30:08.606441 (Thread-5): SQL status: SUCCESS 1 in 1.49 seconds
2021-03-31 14:30:08.610951 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:30:08.611160 (Thread-5): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:30:08.611283 (Thread-5): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:30:08.756942 (Thread-3): SQL status: SUCCESS 1 in 1.64 seconds
2021-03-31 14:30:08.757184 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:30:08.757330 (Thread-3): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state,
        iff(teams.team = 'Lakers', true, false) as is_champion

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 14:30:08.862527 (Thread-5): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 14:30:08.865608 (Thread-5): finished collecting timing info
2021-03-31 14:30:08.865920 (Thread-5): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 14:30:09.372567 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e18198>]}
2021-03-31 14:30:09.374094 (Thread-5): 22:30:09 | 4 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 4.11s]
2021-03-31 14:30:09.374280 (Thread-5): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:30:10.313836 (Thread-3): SQL status: SUCCESS 1 in 1.56 seconds
2021-03-31 14:30:10.318548 (Thread-3): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:30:10.318730 (Thread-3): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:30:10.318832 (Thread-3): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:30:10.557337 (Thread-3): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 14:30:10.560452 (Thread-3): finished collecting timing info
2021-03-31 14:30:10.560762 (Thread-3): On model.demo_dbt.example_team_details: Close
2021-03-31 14:30:11.065644 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72d65fb0-d76a-4e8e-93d9-f2794f9a27a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea7438>]}
2021-03-31 14:30:11.067141 (Thread-3): 22:30:11 | 5 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 3.97s]
2021-03-31 14:30:11.067320 (Thread-3): Finished running node model.demo_dbt.example_team_details
2021-03-31 14:30:11.164359 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:30:11.164903 (MainThread): Using snowflake connection "master".
2021-03-31 14:30:11.165052 (MainThread): On master: BEGIN
2021-03-31 14:30:11.165191 (MainThread): Opening a new connection, currently in state closed
2021-03-31 14:30:12.959817 (MainThread): SQL status: SUCCESS 1 in 1.79 seconds
2021-03-31 14:30:12.960090 (MainThread): On master: COMMIT
2021-03-31 14:30:12.960332 (MainThread): Using snowflake connection "master".
2021-03-31 14:30:12.960470 (MainThread): On master: COMMIT
2021-03-31 14:30:13.307636 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-03-31 14:30:13.307902 (MainThread): 22:30:13 | 
2021-03-31 14:30:13.308111 (MainThread): 22:30:13 | Running 1 on-run-end hook
2021-03-31 14:30:13.308297 (MainThread): Compiling operation.demo_dbt.demo_dbt-on-run-end-0
2021-03-31 14:30:13.314442 (MainThread): Writing injected SQL for node "operation.demo_dbt.demo_dbt-on-run-end-0"
2021-03-31 14:30:13.315226 (MainThread): 22:30:13 | 1 of 1 START hook: demo_dbt.on-run-end.0............................. [RUN]
2021-03-31 14:30:13.315642 (MainThread): Using snowflake connection "master".
2021-03-31 14:30:13.315752 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "master"} */
insert into DEMO_DB.PUBLIC.dbt_audits (audit_type) values ('run_end');
2021-03-31 14:30:13.978843 (MainThread): SQL status: SUCCESS 1 in 0.66 seconds
2021-03-31 14:30:13.979059 (MainThread): Using snowflake connection "master".
2021-03-31 14:30:13.979155 (MainThread): On master: commit;
2021-03-31 14:30:14.457520 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-03-31 14:30:14.462437 (MainThread): 22:30:14 | 1 of 1 OK hook: demo_dbt.on-run-end.0................................ [SUCCESS 1 in 1.15s]
2021-03-31 14:30:14.462643 (MainThread): 22:30:14 | 
2021-03-31 14:30:14.462831 (MainThread): On master: Close
2021-03-31 14:30:15.017053 (MainThread): 22:30:15 | 
2021-03-31 14:30:15.017279 (MainThread): 22:30:15 | Finished running 1 view model, 4 table models, 2 hooks in 27.51s.
2021-03-31 14:30:15.017433 (MainThread): Connection 'master' was properly closed.
2021-03-31 14:30:15.017540 (MainThread): Connection 'model.demo_dbt.example_teams' was properly closed.
2021-03-31 14:30:15.017643 (MainThread): Connection 'list_DEMO_DB_PUBLIC' was properly closed.
2021-03-31 14:30:15.017738 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 14:30:15.017832 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 14:30:15.017926 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 14:30:15.107739 (MainThread): 
2021-03-31 14:30:15.107909 (MainThread): Completed successfully
2021-03-31 14:30:15.108031 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 14:30:15.108247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11588a748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b8f588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b2fba8>]}
2021-03-31 14:30:15.108524 (MainThread): Flushing usage events
2021-03-31 14:35:21.239075 (MainThread): Running with dbt=0.19.0
2021-03-31 14:35:21.757712 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/chi.zhang/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 14:35:21.758444 (MainThread): Tracking: tracking
2021-03-31 14:35:21.758791 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139bde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149830f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114983198>]}
2021-03-31 14:35:21.799248 (MainThread): Partial parsing not enabled
2021-03-31 14:35:21.800193 (MainThread): Parsing macros/test_is_la_team.sql
2021-03-31 14:35:21.801489 (MainThread): Parsing macros/test_not_null.sql
2021-03-31 14:35:21.804281 (MainThread): Parsing macros/audits_operations.sql
2021-03-31 14:35:21.804986 (MainThread): Parsing macros/generate_schema_name.sql
2021-03-31 14:35:21.806504 (MainThread): Parsing macros/catalog.sql
2021-03-31 14:35:21.809078 (MainThread): Parsing macros/adapters.sql
2021-03-31 14:35:21.840414 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 14:35:21.842669 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 14:35:21.844218 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 14:35:21.848536 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 14:35:21.859343 (MainThread): Parsing macros/core.sql
2021-03-31 14:35:21.863366 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 14:35:21.872748 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 14:35:21.874610 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 14:35:21.893641 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 14:35:21.927807 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 14:35:21.950129 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 14:35:21.952114 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 14:35:21.958576 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 14:35:21.973492 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 14:35:21.981080 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 14:35:21.988650 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 14:35:21.994197 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 14:35:21.995220 (MainThread): Parsing macros/etc/query.sql
2021-03-31 14:35:21.996318 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 14:35:21.998049 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 14:35:22.007242 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 14:35:22.009329 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 14:35:22.011276 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 14:35:22.056301 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 14:35:22.058388 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 14:35:22.060006 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 14:35:22.061740 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 14:35:22.066007 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-03-31 14:35:22.067373 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-03-31 14:35:22.068883 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-03-31 14:35:22.071684 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-03-31 14:35:22.078534 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-03-31 14:35:22.079814 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-03-31 14:35:22.081547 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-03-31 14:35:22.084293 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-03-31 14:35:22.085572 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-03-31 14:35:22.088148 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-03-31 14:35:22.098487 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-03-31 14:35:22.100700 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-03-31 14:35:22.102368 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-03-31 14:35:22.104290 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-03-31 14:35:22.106088 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-03-31 14:35:22.107252 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-03-31 14:35:22.110913 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-03-31 14:35:22.116783 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-03-31 14:35:22.117740 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-03-31 14:35:22.120758 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-03-31 14:35:22.122845 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-03-31 14:35:22.124563 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-03-31 14:35:22.126692 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-03-31 14:35:22.154281 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-03-31 14:35:22.155727 (MainThread): Parsing macros/logger/pretty_time.sql
2021-03-31 14:35:22.157202 (MainThread): Parsing macros/logger/log_info.sql
2021-03-31 14:35:22.158544 (MainThread): Parsing macros/datetime/date_spine.sql
2021-03-31 14:35:22.163740 (MainThread): Parsing macros/web/get_url_host.sql
2021-03-31 14:35:22.166142 (MainThread): Parsing macros/web/get_url_path.sql
2021-03-31 14:35:22.169159 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-03-31 14:35:22.170994 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-03-31 14:35:22.172708 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-03-31 14:35:22.175229 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-03-31 14:35:22.178243 (MainThread): Parsing macros/schema_tests/recency.sql
2021-03-31 14:35:22.180722 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-03-31 14:35:22.183078 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-03-31 14:35:22.185460 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-03-31 14:35:22.187332 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-03-31 14:35:22.191421 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-03-31 14:35:22.194027 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-03-31 14:35:22.196093 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-03-31 14:35:22.198584 (MainThread): Parsing macros/schema_tests/equality.sql
2021-03-31 14:35:22.203023 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-03-31 14:35:22.210099 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-03-31 14:35:22.212034 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-03-31 14:35:22.216511 (MainThread): Parsing macros/sql/generate_series.sql
2021-03-31 14:35:22.221405 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-03-31 14:35:22.225302 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-03-31 14:35:22.227362 (MainThread): Parsing macros/sql/star.sql
2021-03-31 14:35:22.231323 (MainThread): Parsing macros/sql/unpivot.sql
2021-03-31 14:35:22.239005 (MainThread): Parsing macros/sql/union.sql
2021-03-31 14:35:22.248150 (MainThread): Parsing macros/sql/groupby.sql
2021-03-31 14:35:22.249682 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-03-31 14:35:22.253442 (MainThread): Parsing macros/sql/safe_add.sql
2021-03-31 14:35:22.255292 (MainThread): Parsing macros/sql/nullcheck.sql
2021-03-31 14:35:22.257125 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-03-31 14:35:22.263871 (MainThread): Parsing macros/sql/get_column_values.sql
2021-03-31 14:35:22.268844 (MainThread): Parsing macros/sql/pivot.sql
2021-03-31 14:35:22.273251 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-03-31 14:35:22.281291 (MainThread): Partial parsing not enabled
2021-03-31 14:35:22.326619 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:35:22.390527 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:35:22.408549 (MainThread): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:35:22.424179 (MainThread): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:35:22.438681 (MainThread): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:35:22.457364 (MainThread): Acquiring new snowflake connection "operation.demo_dbt.demo_dbt-on-run-start-0".
2021-03-31 14:35:22.465639 (MainThread): Acquiring new snowflake connection "operation.demo_dbt.demo_dbt-on-run-end-0".
2021-03-31 14:35:22.802971 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167860b8>]}
2021-03-31 14:35:22.877537 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 319 macros, 2 operations, 1 seed file, 1 source, 0 exposures
2021-03-31 14:35:22.878665 (MainThread): 
2021-03-31 14:35:22.878925 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:35:22.885811 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DEMO_DB".
2021-03-31 14:35:22.899477 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DEMO_DB".
2021-03-31 14:35:22.899600 (ThreadPoolExecutor-0_0): On list_DEMO_DB: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB"} */

    show terse schemas in database DEMO_DB
    limit 10000
2021-03-31 14:35:22.899677 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 14:35:27.168298 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 4.27 seconds
2021-03-31 14:35:27.173049 (ThreadPoolExecutor-0_0): On list_DEMO_DB: Close
2021-03-31 14:35:27.684474 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:35:27.684941 (ThreadPoolExecutor-1_1): Acquiring new snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:35:27.693827 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DEMO_DB_PUBLIC".
2021-03-31 14:35:27.696526 (ThreadPoolExecutor-1_1): Using snowflake connection "list_DEMO_DB_staging".
2021-03-31 14:35:27.696662 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_PUBLIC"} */

    show terse objects in DEMO_DB.PUBLIC
2021-03-31 14:35:27.696815 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DEMO_DB_staging"} */

    show terse objects in DEMO_DB.staging
2021-03-31 14:35:27.696958 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-31 14:35:27.697072 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2021-03-31 14:35:29.831781 (ThreadPoolExecutor-1_1): SQL status: SUCCESS 5 in 2.13 seconds
2021-03-31 14:35:29.838410 (ThreadPoolExecutor-1_1): On list_DEMO_DB_staging: Close
2021-03-31 14:35:29.848489 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.15 seconds
2021-03-31 14:35:29.854185 (ThreadPoolExecutor-1_0): On list_DEMO_DB_PUBLIC: Close
2021-03-31 14:35:30.857702 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:30.857861 (MainThread): On master: BEGIN
2021-03-31 14:35:30.857970 (MainThread): Opening a new connection, currently in state init
2021-03-31 14:35:35.889923 (MainThread): SQL status: SUCCESS 1 in 5.03 seconds
2021-03-31 14:35:35.890131 (MainThread): On master: COMMIT
2021-03-31 14:35:35.890312 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:35.890410 (MainThread): On master: COMMIT
2021-03-31 14:35:37.359762 (MainThread): SQL status: SUCCESS 1 in 1.47 seconds
2021-03-31 14:35:37.359996 (MainThread): 22:35:37 | 
2021-03-31 14:35:37.360165 (MainThread): 22:35:37 | Running 1 on-run-start hook
2021-03-31 14:35:37.360320 (MainThread): Compiling operation.demo_dbt.demo_dbt-on-run-start-0
2021-03-31 14:35:37.378880 (MainThread): Writing injected SQL for node "operation.demo_dbt.demo_dbt-on-run-start-0"
2021-03-31 14:35:37.381429 (MainThread): 22:35:37 | 1 of 1 START hook: demo_dbt.on-run-start.0........................... [RUN]
2021-03-31 14:35:37.381935 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:37.382066 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "master"} */
insert into DEMO_DB.PUBLIC.dbt_audits (audit_type) values ('run_start');
2021-03-31 14:35:39.410507 (MainThread): SQL status: SUCCESS 1 in 2.03 seconds
2021-03-31 14:35:39.410801 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:39.410955 (MainThread): On master: commit;
2021-03-31 14:35:39.826071 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-03-31 14:35:39.830625 (MainThread): 22:35:39 | 1 of 1 OK hook: demo_dbt.on-run-start.0.............................. [SUCCESS 1 in 2.45s]
2021-03-31 14:35:39.830812 (MainThread): 22:35:39 | 
2021-03-31 14:35:39.830962 (MainThread): On master: Close
2021-03-31 14:35:40.312995 (MainThread): 22:35:40 | Concurrency: 5 threads (target='dev')
2021-03-31 14:35:40.313246 (MainThread): 22:35:40 | 
2021-03-31 14:35:40.314754 (Thread-1): Began running node model.demo_dbt.example_teams
2021-03-31 14:35:40.314939 (Thread-2): Began running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:35:40.315114 (Thread-3): Began running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:35:40.316360 (Thread-1): 22:35:40 | 1 of 5 START table model staging.example_teams....................... [RUN]
2021-03-31 14:35:40.317435 (Thread-2): 22:35:40 | 2 of 5 START table model staging.my_first_dbt_model.................. [RUN]
2021-03-31 14:35:40.319080 (Thread-3): 22:35:40 | 3 of 5 START view model staging.snowflake_sample_data_store_sales.... [RUN]
2021-03-31 14:35:40.319497 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:35:40.319859 (Thread-2): Acquiring new snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:35:40.320208 (Thread-3): Acquiring new snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:35:40.320362 (Thread-1): Compiling model.demo_dbt.example_teams
2021-03-31 14:35:40.320501 (Thread-2): Compiling model.demo_dbt.my_first_dbt_model
2021-03-31 14:35:40.320629 (Thread-3): Compiling model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:35:40.344676 (Thread-1): Writing injected SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:35:40.349695 (Thread-2): Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:35:40.358760 (Thread-3): Writing injected SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:35:40.359555 (Thread-2): finished collecting timing info
2021-03-31 14:35:40.359908 (Thread-1): finished collecting timing info
2021-03-31 14:35:40.365364 (Thread-3): finished collecting timing info
2021-03-31 14:35:40.425380 (Thread-2): Writing runtime SQL for node "model.demo_dbt.my_first_dbt_model"
2021-03-31 14:35:40.447901 (Thread-1): Writing runtime SQL for node "model.demo_dbt.example_teams"
2021-03-31 14:35:40.450007 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:35:40.450436 (Thread-1): On model.demo_dbt.example_teams: BEGIN
2021-03-31 14:35:40.460912 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 14:35:40.473204 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:35:40.473601 (Thread-2): On model.demo_dbt.my_first_dbt_model: BEGIN
2021-03-31 14:35:40.479333 (Thread-2): Opening a new connection, currently in state init
2021-03-31 14:35:40.489645 (Thread-3): Writing runtime SQL for node "model.demo_dbt.snowflake_sample_data_store_sales"
2021-03-31 14:35:40.492160 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:35:40.492305 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: BEGIN
2021-03-31 14:35:40.492416 (Thread-3): Opening a new connection, currently in state init
2021-03-31 14:35:42.640131 (Thread-3): SQL status: SUCCESS 1 in 2.15 seconds
2021-03-31 14:35:42.640366 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:35:42.640496 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.snowflake_sample_data_store_sales"} */

  create or replace  view DEMO_DB.staging.snowflake_sample_data_store_sales  as (
    WITH source_store_sales as (
    SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES
), 

final AS (
    SELECT * FROM source_store_sales
)

SELECT * FROM final
  );
2021-03-31 14:35:42.641694 (Thread-1): SQL status: SUCCESS 1 in 2.18 seconds
2021-03-31 14:35:42.641853 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:35:42.641975 (Thread-1): On model.demo_dbt.example_teams: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_teams"} */


      create or replace transient table DEMO_DB.staging.example_teams  as
      (with teams as (

    select
        'Lakers' as team

    union all

    select
        'Clippers' as team

    union all

    select
        '76ers' as team

    union all

    select
        'Heat' as team

)

select * from teams
      );
2021-03-31 14:35:42.697572 (Thread-2): SQL status: SUCCESS 1 in 2.22 seconds
2021-03-31 14:35:42.697752 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:35:42.697857 (Thread-2): On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



-- 

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-03-31 14:35:43.155649 (Thread-3): SQL status: SUCCESS 1 in 0.52 seconds
2021-03-31 14:35:43.161064 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:35:43.161253 (Thread-3): Using snowflake connection "model.demo_dbt.snowflake_sample_data_store_sales".
2021-03-31 14:35:43.161361 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: COMMIT
2021-03-31 14:35:43.869827 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-03-31 14:35:43.873969 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:35:43.874154 (Thread-1): Using snowflake connection "model.demo_dbt.example_teams".
2021-03-31 14:35:43.874254 (Thread-1): On model.demo_dbt.example_teams: COMMIT
2021-03-31 14:35:43.966829 (Thread-2): SQL status: SUCCESS 1 in 1.27 seconds
2021-03-31 14:35:43.971874 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:35:43.972087 (Thread-2): Using snowflake connection "model.demo_dbt.my_first_dbt_model".
2021-03-31 14:35:43.972195 (Thread-2): On model.demo_dbt.my_first_dbt_model: COMMIT
2021-03-31 14:35:44.123206 (Thread-3): SQL status: SUCCESS 1 in 0.96 seconds
2021-03-31 14:35:44.135557 (Thread-3): finished collecting timing info
2021-03-31 14:35:44.136660 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-03-31 14:35:44.136804 (Thread-3): On model.demo_dbt.snowflake_sample_data_store_sales: Close
2021-03-31 14:35:44.143119 (Thread-1): finished collecting timing info
2021-03-31 14:35:44.145249 (Thread-1): On model.demo_dbt.example_teams: Close
2021-03-31 14:35:44.262454 (Thread-2): SQL status: SUCCESS 1 in 0.29 seconds
2021-03-31 14:35:44.265381 (Thread-2): finished collecting timing info
2021-03-31 14:35:44.265714 (Thread-2): On model.demo_dbt.my_first_dbt_model: Close
2021-03-31 14:35:44.634520 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11665d518>]}
2021-03-31 14:35:44.636091 (Thread-1): 22:35:44 | 1 of 5 OK created table model staging.example_teams.................. [SUCCESS 1 in 4.31s]
2021-03-31 14:35:44.636282 (Thread-1): Finished running node model.demo_dbt.example_teams
2021-03-31 14:35:44.636675 (Thread-5): Began running node model.demo_dbt.example_team_details
2021-03-31 14:35:44.637956 (Thread-5): 22:35:44 | 4 of 5 START table model staging.example_team_details................ [RUN]
2021-03-31 14:35:44.638277 (Thread-5): Acquiring new snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:35:44.638411 (Thread-5): Compiling model.demo_dbt.example_team_details
2021-03-31 14:35:44.650403 (Thread-5): Writing injected SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:35:44.650896 (Thread-5): finished collecting timing info
2021-03-31 14:35:44.656346 (Thread-5): Writing runtime SQL for node "model.demo_dbt.example_team_details"
2021-03-31 14:35:44.657706 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:35:44.657820 (Thread-5): On model.demo_dbt.example_team_details: BEGIN
2021-03-31 14:35:44.657923 (Thread-5): Opening a new connection, currently in state init
2021-03-31 14:35:44.761835 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11666d518>]}
2021-03-31 14:35:44.763518 (Thread-2): 22:35:44 | 2 of 5 OK created table model staging.my_first_dbt_model............. [SUCCESS 1 in 4.44s]
2021-03-31 14:35:44.763716 (Thread-2): Finished running node model.demo_dbt.my_first_dbt_model
2021-03-31 14:35:44.764086 (Thread-1): Began running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:35:44.765366 (Thread-1): 22:35:44 | 5 of 5 START table model staging.my_second_dbt_model................. [RUN]
2021-03-31 14:35:44.765855 (Thread-1): Acquiring new snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:35:44.766025 (Thread-1): Compiling model.demo_dbt.my_second_dbt_model
2021-03-31 14:35:44.775297 (Thread-1): Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:35:44.775773 (Thread-1): finished collecting timing info
2021-03-31 14:35:44.781165 (Thread-1): Writing runtime SQL for node "model.demo_dbt.my_second_dbt_model"
2021-03-31 14:35:44.782052 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:35:44.782175 (Thread-1): On model.demo_dbt.my_second_dbt_model: BEGIN
2021-03-31 14:35:44.782282 (Thread-1): Opening a new connection, currently in state closed
2021-03-31 14:35:45.108614 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167668d0>]}
2021-03-31 14:35:45.109908 (Thread-3): 22:35:45 | 3 of 5 OK created view model staging.snowflake_sample_data_store_sales [SUCCESS 1 in 4.79s]
2021-03-31 14:35:45.110065 (Thread-3): Finished running node model.demo_dbt.snowflake_sample_data_store_sales
2021-03-31 14:35:46.602083 (Thread-5): SQL status: SUCCESS 1 in 1.94 seconds
2021-03-31 14:35:46.607484 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:35:46.607608 (Thread-5): On model.demo_dbt.example_team_details: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.example_team_details"} */


      create or replace transient table DEMO_DB.staging.example_team_details  as
      (with teams as (

    select * from DEMO_DB.staging.example_teams

),

team_locations as (

    select * from DEMO_DB.PUBLIC.team_location
),

final as (

    select
        teams.team,
        team_locations.city,
        team_locations.state,
        iff(teams.team = 'Lakers', true, false) as is_champion

    from teams

    left join team_locations
        on team_locations.name = teams.team

)

select * from final
      );
2021-03-31 14:35:47.584685 (Thread-1): SQL status: SUCCESS 1 in 2.80 seconds
2021-03-31 14:35:47.584945 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:35:47.585098 (Thread-1): On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */


      create or replace transient table DEMO_DB.staging.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from DEMO_DB.staging.my_first_dbt_model
where id = 1
      );
2021-03-31 14:35:47.796148 (Thread-5): SQL status: SUCCESS 1 in 1.18 seconds
2021-03-31 14:35:47.800748 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:35:47.800936 (Thread-5): Using snowflake connection "model.demo_dbt.example_team_details".
2021-03-31 14:35:47.801040 (Thread-5): On model.demo_dbt.example_team_details: COMMIT
2021-03-31 14:35:48.049057 (Thread-5): SQL status: SUCCESS 1 in 0.25 seconds
2021-03-31 14:35:48.051598 (Thread-5): finished collecting timing info
2021-03-31 14:35:48.051881 (Thread-5): On model.demo_dbt.example_team_details: Close
2021-03-31 14:35:48.544142 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a5e5f8>]}
2021-03-31 14:35:48.545665 (Thread-5): 22:35:48 | 4 of 5 OK created table model staging.example_team_details........... [SUCCESS 1 in 3.91s]
2021-03-31 14:35:48.545852 (Thread-5): Finished running node model.demo_dbt.example_team_details
2021-03-31 14:35:48.589510 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-03-31 14:35:48.594068 (Thread-1): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:35:48.594248 (Thread-1): Using snowflake connection "model.demo_dbt.my_second_dbt_model".
2021-03-31 14:35:48.594350 (Thread-1): On model.demo_dbt.my_second_dbt_model: COMMIT
2021-03-31 14:35:48.835251 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-03-31 14:35:48.838020 (Thread-1): finished collecting timing info
2021-03-31 14:35:48.838394 (Thread-1): On model.demo_dbt.my_second_dbt_model: Close
2021-03-31 14:35:49.376193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0e5189-9b51-4276-bc3c-0446176def76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116682898>]}
2021-03-31 14:35:49.377597 (Thread-1): 22:35:49 | 5 of 5 OK created table model staging.my_second_dbt_model............ [SUCCESS 1 in 4.61s]
2021-03-31 14:35:49.377765 (Thread-1): Finished running node model.demo_dbt.my_second_dbt_model
2021-03-31 14:35:49.450240 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 14:35:49.450568 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:49.450697 (MainThread): On master: BEGIN
2021-03-31 14:35:49.450816 (MainThread): Opening a new connection, currently in state closed
2021-03-31 14:35:51.105692 (MainThread): SQL status: SUCCESS 1 in 1.65 seconds
2021-03-31 14:35:51.105975 (MainThread): On master: COMMIT
2021-03-31 14:35:51.106312 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:51.106477 (MainThread): On master: COMMIT
2021-03-31 14:35:51.422320 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-03-31 14:35:51.422510 (MainThread): 22:35:51 | 
2021-03-31 14:35:51.422654 (MainThread): 22:35:51 | Running 1 on-run-end hook
2021-03-31 14:35:51.422785 (MainThread): Compiling operation.demo_dbt.demo_dbt-on-run-end-0
2021-03-31 14:35:51.428440 (MainThread): Writing injected SQL for node "operation.demo_dbt.demo_dbt-on-run-end-0"
2021-03-31 14:35:51.429468 (MainThread): 22:35:51 | 1 of 1 START hook: demo_dbt.on-run-end.0............................. [RUN]
2021-03-31 14:35:51.429916 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:51.430077 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "snowflake", "target_name": "dev", "connection_name": "master"} */
insert into DEMO_DB.PUBLIC.dbt_audits (audit_type) values ('run_end');
2021-03-31 14:35:52.241675 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-03-31 14:35:52.241911 (MainThread): Using snowflake connection "master".
2021-03-31 14:35:52.242031 (MainThread): On master: commit;
2021-03-31 14:35:52.678580 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-03-31 14:35:52.683034 (MainThread): 22:35:52 | 1 of 1 OK hook: demo_dbt.on-run-end.0................................ [SUCCESS 1 in 1.25s]
2021-03-31 14:35:52.683225 (MainThread): 22:35:52 | 
2021-03-31 14:35:52.683385 (MainThread): On master: Close
2021-03-31 14:35:53.181018 (MainThread): 22:35:53 | 
2021-03-31 14:35:53.181254 (MainThread): 22:35:53 | Finished running 4 table models, 1 view model, 2 hooks in 30.30s.
2021-03-31 14:35:53.181412 (MainThread): Connection 'master' was properly closed.
2021-03-31 14:35:53.181526 (MainThread): Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
2021-03-31 14:35:53.181633 (MainThread): Connection 'list_DEMO_DB_staging' was properly closed.
2021-03-31 14:35:53.181735 (MainThread): Connection 'model.demo_dbt.my_first_dbt_model' was properly closed.
2021-03-31 14:35:53.181842 (MainThread): Connection 'model.demo_dbt.snowflake_sample_data_store_sales' was properly closed.
2021-03-31 14:35:53.181944 (MainThread): Connection 'model.demo_dbt.example_team_details' was properly closed.
2021-03-31 14:35:53.268804 (MainThread): 
2021-03-31 14:35:53.268950 (MainThread): Completed successfully
2021-03-31 14:35:53.269053 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-31 14:35:53.269205 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118441048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116682cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a70cf8>]}
2021-03-31 14:35:53.269372 (MainThread): Flushing usage events
